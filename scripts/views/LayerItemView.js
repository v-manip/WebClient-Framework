(function(){"use strict";var a=this;a.define(["backbone","communicator","hbs!tmpl/BulletLayer","underscore"],function(a,b){var c=a.Marionette.ItemView.extend({tagName:"li",events:{drop:"drop",change:"onChange","click .fa-adjust":"onOpenSlider","slide .ui-slider":"onOpacityAdjust"},initialize:function(){this.$slider=$("<div>").slider({range:"max",max:100,min:0}),this.$slider.width(100)},onShow:function(){$(".sortable").sortable({revert:!0,delay:90,containment:".layercontrol .panel-body",axis:"y",forceHelperSize:!0,forcePlaceHolderSize:!0,placeholder:"sortable-placeholder",handle:".fa-sort",start:function(){$(".ui-slider").detach(),$(".fa-adjust").toggleClass("active"),$(".fa-adjust").popover("hide")},stop:function(a,b){b.item.trigger("drop",b.item.index())}}),$(".fa-adjust").popover({trigger:"manual"})},onChange:function(a){var c=!1;this.model.get("view").isBaseLayer&&(c=!0);var d={name:this.model.get("name"),isBaseLayer:c,visible:a.target.checked};b.mediator.trigger("map:layer:change",d)},drop:function(a,c){b.mediator.trigger("productCollection:updateSort",{model:this.model,position:c})},onOpenSlider:function(){this.$(".fa-adjust").toggleClass("active").hasClass("active")?(this.$(".fa-adjust").popover("show"),this.$(".popover-content").empty().append(this.$slider),this.$(".ui-slider").slider("option","value",100*this.model.get("opacity"))):(this.$slider.detach(),this.$(".fa-adjust").popover("hide"))},onOpacityAdjust:function(a,c){this.model.set("opacity",c.value/100),b.mediator.trigger("productCollection:updateOpacity",{model:this.model,value:c.value/100})}});return{LayerItemView:c}})}).call(this);