function m(a){throw a}function ea(){return function(){}}function fa(a){return function(b){this[a]=b}}function v(a){return function(){return this[a]}}function ha(){}function ia(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ja(a){return a!==p}function la(a){return"array"==ia(a)}function ma(a){var b=ia(a);return"array"==b||"object"==b&&"number"==typeof a.length}function na(a){return"string"==typeof a}function x(a){return"number"==typeof a}function oa(a){return"function"==ia(a)}function pa(a){var b=typeof a;return"object"==b&&a!=t||"function"==b}function qa(a){return a[ra]||(a[ra]=++sa)}function ta(a){return a.call.apply(a.bind,arguments)}function ua(a,b){if(a||m(Error()),2<arguments.length){var c=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(d,c),a.apply(b,d)}}return function(){return a.apply(b,arguments)}}function va(){return va=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:ua,va.apply(t,arguments)}function wa(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=Array.prototype.slice.call(arguments);return c.unshift.apply(c,b),a.apply(this,c)}}function B(a,b){var c=a.split("."),d=ga;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ja(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function C(a,b){function c(){}c.prototype=b.prototype,a.z=b.prototype,a.prototype=new c,a.prototype.constructor=a}function ya(a,b,c){this.Ta=this.Sa=this.Ra=0,3==arguments.length?(this.Ra=Number(a),this.Sa=Number(b),this.Ta=Number(c)):a instanceof ya?(this.Ra=Number(a.x()),this.Sa=Number(a.y()),this.Ta=Number(a.d())):(this.Ra=Number(a[0]),this.Sa=Number(a[1]),this.Ta=Number(a[2]))}function Da(a){var b=a.length();return new ya(a.Ra/b,a.Sa/b,a.Ta/b)}function Ba(a,b){return new ya(a.Ra*b,a.Sa*b,a.Ta*b)}function Ca(a,b){return new ya(a.Ra-b.x(),a.Sa-b.y(),a.Ta-b.d())}function Aa(a,b){return new ya(a.Ra+b.x(),a.Sa+b.y(),a.Ta+b.d())}function Fa(a){return new ya(-a.Ra,-a.Sa,-a.Ta)}function Ga(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);c in a||(d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c])}}function Ma(){}function Na(a,b){for(var c in a)b.call(p,a[c],c,a)}function Oa(a){var b,c=[],d=0;for(b in a)c[d++]=a[b];return c}function Ra(a){for(var b,c,d=1;d<arguments.length;d++){c=arguments[d];for(b in c)a[b]=c[b];for(var e=0;e<Pa.length;e++)b=Pa[e],Object.prototype.hasOwnProperty.call(c,b)&&(a[b]=c[b])}}function Sa(a){return Ta.test(a)?(-1!=a.indexOf("&")&&(a=a.replace(Ua,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Va,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(Wa,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Xa,"&quot;")),a):a}function fb(){return ga.navigator?ga.navigator.userAgent:t}function gb(){return ga.navigator}function rb(){var a=ga.document;return a?a.documentMode:p}function Cb(a){var b;if(!(b=Bb[a])){b=0;for(var c=String(vb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&e>f;f++){var g=c[f]||"",h=d[f]||"",i=RegExp("(\\d*)(\\D*)","g"),j=RegExp("(\\d*)(\\D*)","g");do{var k=i.exec(g)||["","",""],l=j.exec(h)||["","",""];if(0==k[0].length&&0==l[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==l[1].length?0:parseInt(l[1],10))?-1:(0==k[1].length?0:parseInt(k[1],10))>(0==l[1].length?0:parseInt(l[1],10))?1:0)||((0==k[2].length)<(0==l[2].length)?-1:(0==k[2].length)>(0==l[2].length)?1:0)||(k[2]<l[2]?-1:k[2]>l[2]?1:0)}while(0==b)}b=Bb[a]=b>=0}return b}function Nb(a,b){var c=Ib(a,b);c>=0&&Hb.splice.call(a,c,1)}function Ob(a,b,c){return 2>=arguments.length?Hb.slice.call(a,b):Hb.slice.call(a,b,c)}function Pb(){0!=Qb&&(this.Lk=Error().stack,qa(this))}function Rb(a,b){this.type=a,this.currentTarget=this.target=b}function Sb(a){return Sb[" "](a),a}function Tb(a,b){a&&this.wa(a,b)}function L(a,b,c,d,e){if(la(b)){for(var f=0;f<b.length;f++)L(a,b[f],c,d,e);return t}return a=Yb(a,b,c,u,d,e),b=a.key,Ub[b]=a,b}function Yb(a,b,c,d,e,f){b||m(Error("Invalid event type")),e=!!e;var g=Vb;b in g||(g[b]={ja:0,Ia:0}),g=g[b],e in g||(g[e]={ja:0,Ia:0},g.ja++);var h,g=g[e],i=qa(a);if(g.Ia++,g[i]){h=g[i];for(var j=0;j<h.length;j++)if(g=h[j],g.Yb==c&&g.gf==f){if(g.mc)break;return d||(h[j].Zd=u),h[j]}}else h=g[i]=[],g.ja++;var k=Zb,l=Fb?function(a){return k.call(l.src,l.Yb,a)}:function(a){return a=k.call(l.src,l.Yb,a),a?void 0:a},j=l,g=new Ma;return g.wa(c,j,a,b,e,f),g.Zd=d,j.src=a,j.Yb=g,h.push(g),Wb[i]||(Wb[i]=[]),Wb[i].push(g),a.addEventListener?(a==ga||!a.customEvent_)&&a.addEventListener(b,j,e):a.attachEvent(b in Xb?Xb[b]:Xb[b]="on"+b,j),g}function $b(a,b,c,d,e){if(la(b))for(var f=0;f<b.length;f++)$b(a,b[f],c,d,e);else a=Yb(a,b,c,q,d,e),Ub[a.key]=a}function ac(a,b,c,d,e){if(la(b))for(var f=0;f<b.length;f++)ac(a,b[f],c,d,e);else if(d=!!d,f=Vb,a=b in f&&(f=f[b],d in f&&(f=f[d],a=qa(a),f[a]))?f[a]:t,a)for(f=0;f<a.length;f++)if(a[f].Yb==c&&a[f].capture==d&&a[f].gf==e){bc(a[f].key);break}}function bc(a){var b=Ub[a];if(!b||b.mc)return u;var c=b.src,d=b.type,e=b.$g,f=b.capture;return c.removeEventListener?(c==ga||!c.customEvent_)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Xb?Xb[d]:Xb[d]="on"+d,e),c=qa(c),Wb[c]&&(e=Wb[c],Nb(e,b),0==e.length&&delete Wb[c]),b.mc=q,(b=Vb[d][f][c])&&(b.Rg=q,cc(d,f,c,b)),delete Ub[a],q}function cc(a,b,c,d){if(!d.le&&d.Rg){for(var e=0,f=0;e<d.length;e++)d[e].mc?d[e].$g.src=t:(e!=f&&(d[f]=d[e]),f++);d.length=f,d.Rg=u,0==f&&(delete Vb[a][b][c],Vb[a][b].ja--,0==Vb[a][b].ja&&(delete Vb[a][b],Vb[a].ja--),0==Vb[a].ja&&delete Vb[a])}}function dc(a,b){var c=qa(a),d=Wb[c];if(d){var e=ja(b),f=ja(p);return e&&f?(d=Vb[b],!!d&&!!d[p]&&c in d[p]):e||f?Mb(d,function(a){return e&&a.type==b||f&&a.capture==p}):q}return u}function ec(a,b,c,d,e){var f=1;if(b=qa(b),a[b]){var g=--a.Ia,h=a[b];h.le?h.le++:h.le=1;try{for(var i=h.length,j=0;i>j;j++){var k=h[j];k&&!k.mc&&(f&=fc(k,e)!==u)}}finally{a.Ia=Math.max(g,a.Ia),h.le--,cc(c,d,b,h)}}return Boolean(f)}function fc(a,b){return a.Zd&&bc(a.key),a.handleEvent(b)}function Zb(a,b){if(a.mc)return q;var c=a.type,d=Vb;if(!(c in d))return q;var e,f,d=d[c];if(!Fb){var g;if(!(g=b))a:{g=["window","event"];for(var h=ga;e=g.shift();){if(h[e]==t){g=t;break a}h=h[e]}g=h}if(e=g,g=q in d,h=u in d,g){if(0>e.keyCode||e.returnValue!=p)return q;a:{var i=u;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(j){i=q}(i||e.returnValue==p)&&(e.returnValue=q)}}i=new Tb,i.wa(e,this),e=q;try{if(g){for(var k=[],l=i.currentTarget;l;l=l.parentNode)k.push(l);f=d[q],f.Ia=f.ja;for(var m=k.length-1;!i.lc&&m>=0&&f.Ia;m--)i.currentTarget=k[m],e&=ec(f,k[m],c,q,i);if(h)for(f=d[u],f.Ia=f.ja,m=0;!i.lc&&m<k.length&&f.Ia;m++)i.currentTarget=k[m],e&=ec(f,k[m],c,u,i)}else e=fc(a,i)}finally{k&&(k.length=0)}return e}return c=new Tb(b,this),e=fc(a,c)}function hc(a){return a+"_"+gc++}function ic(){Pb.call(this),this.Pk={},this.Jk=this}function O(){ic.call(this),this.g="base",this.ta=window["X.counter"].Jj(),this.j=u}function jc(a,b){this.Qa=new ya(a),this.ra=new ya(b)}function kc(a,b){this.ra=a,this.Cd=b}function lc(a,b){this.Eb=a,this.ue=b;var c=a[0].Qa,d=a[2].Qa,d=Da(Ca(a[1].Qa,c).ic(Ca(d,c)));this.Pa=new kc(d,d.Xb(c))}function mc(a,b,c,d,e,f){for(var g=0,h=[],i=0;i<a.Eb.length;i++){var j=b.ra.Xb(a.Eb[i].Qa)-b.Cd,j=-1e-5>j?2:j>1e-5?1:0,g=g|j;h.push(j)}switch(g){case 0:(0<b.ra.Xb(a.Pa.ra)?c:d).push(a);break;case 1:e.push(a);break;case 2:f.push(a);break;case 3:for(c=[],d=[],i=0;i<a.Eb.length;i++){var k=(i+1)%a.Eb.length,j=h[i],l=h[k],g=a.Eb[i],k=a.Eb[k];2!=j&&c.push(g),1!=j&&d.push(2!=j?g.l():g),3==(j|l)&&(j=(b.Cd-b.ra.Xb(g.Qa))/b.ra.Xb(Ca(k.Qa,g.Qa)),j=new jc(g.Qa.ke(k.Qa,j),g.ra.ke(k.ra,j)),c.push(j),d.push(j.l()))}3<=c.length&&e.push(new lc(c,a.ue)),3<=d.length&&f.push(new lc(d,a.ue))}}function nc(a){this.ua=this.va=this.Pa=t,this.V=[],a&&oc(this,a)}function oc(a,b){if(b.length){a.Pa||(a.Pa=b[0].Pa.l());for(var c=[],d=[],e=0;e<b.length;e++)mc(b[e],a.Pa,a.V,a.V,c,d);c.length&&(a.va||(a.va=new nc),oc(a.va,c)),d.length&&(a.ua||(a.ua=new nc),oc(a.ua,d))}}function pc(a){var b=a.V.slice();return a.va&&(b=b.concat(pc(a.va))),a.ua&&(b=b.concat(pc(a.ua))),b}function qc(a,b){a.V=rc(b,a.V),a.va&&qc(a.va,b),a.ua&&qc(a.ua,b)}function rc(a,b){if(!a.Pa)return b.slice();for(var c=[],d=[],e=0;e<b.length;e++)mc(b[e],a.Pa,c,d,c,d);return a.va&&(c=rc(a.va,c)),d=a.ua?rc(a.ua,d):[],c.concat(d)}function sc(){this.V=[]}function tc(a){var b=new sc;return b.te(a),b}function uc(){O.call(this),this.g="indexer",this.Se=[],this.Ek=[],this.Fa={}}function vc(a){O.call(this),this.g="file",this.Sd=a,this.j=q}function wc(){this.mb=this.r=t}function xc(a){if("function"==typeof a.sd)return a.sd();if(na(a))return a.split("");if(ma(a)){for(var b=[],c=a.length,d=0;c>d;d++)b.push(a[d]);return b}return Oa(a)}function yc(a){this.$={},this.Q=[];var b=arguments.length;if(b>1){b%2&&m(Error("Uneven number of arguments"));for(var c=0;b>c;c+=2)this.set(arguments[c],arguments[c+1])}else a&&this.Ue(a)}function Ac(a){for(var b=0;b<a.Q.length;b++){var c=a.Q[b];if(Bc(a.$,c)&&a.$[c]==u)return q}return u}function zc(a){if(a.ja!=a.Q.length){for(var b=0,c=0;b<a.Q.length;){var d=a.Q[b];Bc(a.$,d)&&(a.Q[c++]=d),b++}a.Q.length=c}if(a.ja!=a.Q.length){for(var e={},c=b=0;b<a.Q.length;)d=a.Q[b],Bc(e,d)||(a.Q[c++]=d,e[d]=1),b++;a.Q.length=c}}function Bc(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function Cc(){O.call(this),this.g="colortable",this.Fa=new yc,Ga(this,new wc)}function Dc(a,b,c){this.x=ja(a)?a:0,this.y=ja(b)?b:0,this.d=ja(c)?c:0}function U(a,b,c){this.x=a,this.y=b,this.d=c}function Ec(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.d-b.d;return Math.sqrt(c*c+d*d+e*e)}function Fc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.d-b.d;return c*c+d*d+e*e}function Gc(a,b){return new U(a.x+b.x,a.y+b.y,a.d+b.d)}function Hc(a,b){return new U(a.y*b.d-a.d*b.y,a.d*b.x-a.x*b.d,a.x*b.y-a.y*b.x)}function Ic(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}function Kc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}function Lc(){return new Float32Array(3)}function Mc(a,b,c){var d=Lc();return d[0]=a,d[1]=b,d[2]=c,d}function Nc(a,b){var c=a[0],d=a[1],e=a[2],c=1/Math.sqrt(c*c+d*d+e*e);b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c}function Oc(){return new Float32Array(4)}function Pc(a,b,c,d){var e=Oc();return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e}function Qc(){return new Float32Array(16)}function Rc(){var a=Qc();return a[0]=a[5]=a[10]=a[15]=1,a}function Sc(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a[4]=f,a[5]=g,a[6]=h,a[7]=i,a[8]=j,a[9]=k,a[10]=l,a[11]=m,a[12]=n,a[13]=o,a[14]=p,a[15]=q,a}function Uc(a,b,c){b*=4,a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3]}function Vc(a,b,c){b*=4,c[0]=a[b],c[1]=a[b+1],c[2]=a[b+2],c[3]=a[b+3]}function V(a,b,c,d,e,f){a[b]=c,a[b+4]=d,a[b+8]=e,a[b+12]=f}function Wc(a,b,c){a[b]=c[0],a[b+4]=c[1],a[b+8]=c[2],a[b+12]=c[3]}function Xc(a,b,c){c[0]=a[b],c[1]=a[b+4],c[2]=a[b+8],c[3]=a[b+12]}function Yc(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14];a=a[15];var s=b[0],t=b[1],u=b[2],v=b[3],w=b[4],x=b[5],y=b[6],z=b[7],A=b[8],B=b[9],C=b[10],D=b[11],E=b[12],F=b[13],G=b[14];return b=b[15],c[0]=d*s+h*t+l*u+p*v,c[1]=e*s+i*t+m*u+q*v,c[2]=f*s+j*t+n*u+r*v,c[3]=g*s+k*t+o*u+a*v,c[4]=d*w+h*x+l*y+p*z,c[5]=e*w+i*x+m*y+q*z,c[6]=f*w+j*x+n*y+r*z,c[7]=g*w+k*x+o*y+a*z,c[8]=d*A+h*B+l*C+p*D,c[9]=e*A+i*B+m*C+q*D,c[10]=f*A+j*B+n*C+r*D,c[11]=g*A+k*B+o*C+a*D,c[12]=d*E+h*F+l*G+p*b,c[13]=e*E+i*F+m*G+q*b,c[14]=f*E+j*F+n*G+r*b,c[15]=g*E+k*F+o*G+a*b,c}function Zc(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=a[9],m=a[10],n=a[11],o=a[12],p=a[13],r=a[14],s=a[15],t=c*h-d*g,v=c*i-e*g,w=c*j-f*g,x=d*i-e*h,y=d*j-f*h,z=e*j-f*i,A=k*p-l*o,B=k*r-m*o,C=k*s-n*o,D=l*r-m*p,E=l*s-n*p,F=m*s-n*r,G=t*F-v*E+w*D+x*C-y*B+z*A;return 0==G?u:(G=1/G,b[0]=(h*F-i*E+j*D)*G,b[1]=(-d*F+e*E-f*D)*G,b[2]=(p*z-r*y+s*x)*G,b[3]=(-l*z+m*y-n*x)*G,b[4]=(-g*F+i*C-j*B)*G,b[5]=(c*F-e*C+f*B)*G,b[6]=(-o*z+r*w-s*v)*G,b[7]=(k*z-m*w+n*v)*G,b[8]=(g*E-h*C+j*A)*G,b[9]=(-c*E+d*C-f*A)*G,b[10]=(o*y-p*w+s*t)*G,b[11]=(-k*y+l*w-n*t)*G,b[12]=(-g*D+h*B-i*A)*G,b[13]=(c*D-d*B+e*A)*G,b[14]=(-o*x+p*v-r*t)*G,b[15]=(k*x-l*v+m*t)*G,q)}function $c(a,b,c){var d=b[0],e=b[1];b=b[2],c[0]=d*a[0]+e*a[4]+b*a[8]+a[12],c[1]=d*a[1]+e*a[5]+b*a[9]+a[13],c[2]=d*a[2]+e*a[6]+b*a[10]+a[14]}function ad(a,b,c){var d=b[0],e=b[1],f=b[2];return b=b[3],c[0]=d*a[0]+e*a[4]+f*a[8]+b*a[12],c[1]=d*a[1]+e*a[5]+f*a[9]+b*a[13],c[2]=d*a[2]+e*a[6]+f*a[10]+b*a[14],c[3]=d*a[3]+e*a[7]+f*a[11]+b*a[15],c}function bd(a,b,c,d){var e=a[1]*b+a[5]*c+a[9]*d+a[13],f=a[2]*b+a[6]*c+a[10]*d+a[14],g=a[3]*b+a[7]*c+a[11]*d+a[15];return a[12]=a[0]*b+a[4]*c+a[8]*d+a[12],a[13]=e,a[14]=f,a[15]=g,a}function cd(){O.call(this),this.g="transform",this.N=D.f.td()}function dd(a,b,c){a.N[b+4*c]*=-1,a.p()}function ed(){O.call(this),this.g="texture",this.Tb=this.Jb=this.r=t,this.Me=this.Ne=0,this.Xf=u,Ga(this,new wc)}function W(a,b){O.call(this),this.g="triplets",this.eb=1/0,this.$a=-1/0,this.fb=1/0,this.ab=-1/0,this.gb=1/0,this.bb=-1/0,this.Hd=[0,0,0],this.Wf=q,this.R=0,this.Y=new Float32Array(a),b!=t&&(this.Y=b.Y.subarray(0,b.Y.length),this.R=this.Y.length,this.eb=b.eb,this.$a=b.$a,this.fb=b.fb,this.ab=b.ab,this.gb=b.gb,this.bb=b.bb,this.Hd=b.Hd.slice(),this.Wf=u)}function fd(){this.Da=gd,this.ca=new cd,this.u=[1,1,1],this.Fc=this.C=this.la=this.q=this.h=t,this.Ac=[],this.L=q,this.zc=this.ad=1,this.qc=t,this.Sc=u,this.qa=1,this.sa=0,this.$c=q}function hd(){this.cb=1/0,this.fa=this.ma=-1/0,this.ga=1/0,this.Ob=[0,0,0],this.Mb=[1,1,1]}function id(){O.call(this),this.g="scalars",this.Pc=this.F=t,this.jg=q,this.Be=0,Ga(this,new wc),Ga(this,new hd),this.Ob=[0,1,0],this.Mb=[1,0,0]}function Y(a){O.call(this),this.g="object",this.c=[],this.G=this.Aa=t,Ga(this,new fd),a!=t&&this.gc(a)}function ld(a,b){return!(a!=t&&b!=t&&a instanceof Y&&b instanceof Y||!m(Error("Fatal: Two valid X.objects are required for comparison."))),1==a.qa?-1:1==b.qa?1:a.sa!=t&&b.sa!=t&&a.sa>b.sa?-1:1}function md(){}function nd(a){for(var b=a.h.count,c=[],d=0,d=0;b>d;d+=3){var e=a.h.get(d),f=a.h.get(d+1),g=a.h.get(d+2),h=a.q.get(d),i=a.q.get(d+1),j=a.q.get(d+2),k=a.u;a.la&&0<a.la.length&&(k=a.la.get(d));var l=[];l.push(new jc(e,h)),l.push(new jc(f,i)),l.push(new jc(g,j)),c.push(new lc(l,k))}return tc(c)}function od(a,b){!(b!=t&&b instanceof sc||!m(Error("Invalid CSG object.")));var c=new uc,d=[];Lb(b.V,function(a){var b=[],e=a.ue,b=Lb(a.Eb,function(a){return a.color=e,c.add(a)});for(a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a)),a.Dh=Lb(c.unique(),function(a){return[a.Qa.x(),a.Qa.y(),a.Qa.d()]}),a.Ch=Lb(c.unique(),function(a){return[a.ra.x(),a.ra.y(),a.ra.d()]}),a.Bh=Lb(c.unique(),function(a){return a.color?[a.color[0],a.color[1],a.color[2]]:t}),a.h=new W(9*d.length),a.q=new W(9*d.length),a.la=new W(9*d.length),Lb(d,function(a){var b=a[0],c=a[1];a=a[2];var d=this.Dh,e=this.Ch,f=this.Bh;this.h.add(d[b][0],d[b][1],d[b][2]),this.h.add(d[c][0],d[c][1],d[c][2]),this.h.add(d[a][0],d[a][1],d[a][2]),this.q.add(e[b][0],e[b][1],e[b][2]),this.q.add(e[c][0],e[c][1],e[c][2]),this.q.add(e[a][0],e[a][1],e[a][2]),f[b]&&this.la.add(f[b][0],f[b][1],f[b][2]),f[c]&&this.la.add(f[c][0],f[c][1],f[c][2]),f[a]&&this.la.add(f[a][0],f[a][1],f[a][2])}.bind(a)),0==a.la.R&&(a.la=t),a.Da=gd}function pd(a){Rb.call(this,a),this.g="event"}function Ed(){pd.call(this,vd),this.Ge=this.Te=0}function Fd(){pd.call(this,qd),this.sa=new D.m(0,0,0)}function Gd(){pd.call(this,rd),this.sa=new D.m(0,0,0)}function Hd(){pd.call(this,sd),this.Za=this.nb=u}function Id(){pd.call(this,td),this.Z=u}function Jd(){pd.call(this,zd),this.Yd=this.Xd=0}function Kd(){pd.call(this,Ad)}function Ld(){pd.call(this,ud)}function jd(){pd.call(this,wd),this.B=this.K=t}function kd(){pd.call(this,xd),this.B=this.K=t}function Md(){pd.call(this,yd),this.od=0}function Nd(){pd.call(this,Bd),this.K=t}function Od(){pd.call(this,Dd),this.od=0}function Pd(){pd.call(this,Cd),this.K=t}function Qd(a,b,c){a==t&&m(Error("Invalid GL Buffer.")),b==t&&m(Error("Invalid number of items.")),c==t&&m(Error("Invalid item size.")),O.call(this),this.g="buffer",this.M=a,this.Kb=b,this.Lb=c}function Sd(a){var b;b=a.className,b=na(b)&&b.match(/\S+/g)||[];for(var c=Ob(arguments,1),d=b.length+c.length,e=b,f=0;f<c.length;f++)0<=Ib(e,c[f])||e.push(c[f]);return a.className=b.join(" "),b.length==d}function Td(a,b){this.width=a,this.height=b}function Vd(a,b){this.x=ja(a)?a:0,this.y=ja(b)?b:0}function Wd(a,b){return new Vd(a.x-b.x,a.y-b.y)}function Xd(a){return a?new Yd(Zd(a)):Rd||(Rd=new Yd)}function $d(a){return na(a)?document.getElementById(a):a}function be(){return ce(document,arguments)}function ce(a,b){var c=b[0],d=b[1];if(!Ud&&d&&(d.name||d.type)){if(c=["<",c],d.name&&c.push(' name="',Sa(d.name),'"'),d.type){c.push(' type="',Sa(d.type),'"');var e={};Ra(e,d),delete e.type,d=e}c.push(">"),c=c.join("")}var f=a.createElement(c);if(d&&(na(d)?f.className=d:la(d)?Sd.apply(t,[f].concat(d)):Na(d,function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in ae?f.setAttribute(ae[b],a):0==b.lastIndexOf("aria-",0)||0==b.lastIndexOf("data-",0)?f.setAttribute(b,a):f[b]=a})),2<b.length)for(d=function(b){b&&f.appendChild(na(b)?a.createTextNode(b):b)},c=2;c<b.length;c++){var g=b[c];if(!ma(g)||pa(g)&&0<g.nodeType)d(g);else{var h,e=Jb;a:{if((h=g)&&"number"==typeof h.length){if(pa(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(oa(h)){h="function"==typeof h.item;break a}}h=u}if(h)if(h=g.length,h>0){for(var i=Array(h),j=0;h>j;j++)i[j]=g[j];g=i}else g=[];e(g,d)}}return f}function de(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function ee(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}function fe(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(16&a.compareDocumentPosition(b));for(;b&&a!=b;)b=b.parentNode;return b==a}function Zd(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function Yd(a){this.da=a||ga.document||document}function ge(a){return"CSS1Compat"==a.da.compatMode}function he(a){var b=a.da;return a=mb||"CSS1Compat"!=b.compatMode?b.body:b.documentElement,b=b.parentWindow||b.defaultView,J&&Cb("10")&&b.pageYOffset!=a.scrollTop?new Vd(a.scrollLeft,a.scrollTop):new Vd(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}function ie(a,b,c,d){this.top=a,this.right=b,this.bottom=c,this.left=d}function je(a,b,c,d){this.left=a,this.top=b,this.width=c,this.height=d}function ke(a,b){var c=b.x<a.left?a.left-b.x:Math.max(b.x-(a.left+a.width),0),d=b.y<a.top?a.top-b.y:Math.max(b.y-(a.top+a.height),0);return c*c+d*d}function le(a,b){var c=Zd(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,t))?c[b]||c.getPropertyValue(b)||"":""}function me(a,b){return le(a,b)||(a.currentStyle?a.currentStyle[b]:t)||a.style&&a.style[b]}function ne(a){return a=a?Zd(a):document,!J||J&&Eb>=9||ge(Xd(a))?a.documentElement:a.body}function oe(a){var b=a.getBoundingClientRect();return J&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop),b}function pe(a){if(J&&!(J&&Eb>=8))return a.offsetParent;var b=Zd(a),c=me(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=me(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return t}function qe(a){for(var b=new ie(0,1/0,1/0,0),c=Xd(a),d=c.da.body,e=c.da.documentElement,f=mb||"CSS1Compat"!=c.da.compatMode?c.da.body:c.da.documentElement;a=pe(a);)if(!(J&&0==a.clientWidth||mb&&0==a.clientHeight&&a==d||a==d||a==e||"visible"==me(a,"overflow"))){var g,h=re(a);if(g=a,lb&&!Cb("1.9")){var i=parseFloat(le(g,"borderLeftWidth"));if(se(g))var j=g.offsetWidth-g.clientWidth-i-parseFloat(le(g,"borderRightWidth")),i=i+j;g=new Vd(i,parseFloat(le(g,"borderTopWidth")))}else g=new Vd(g.clientLeft,g.clientTop);h.x+=g.x,h.y+=g.y,b.top=Math.max(b.top,h.y),b.right=Math.min(b.right,h.x+a.clientWidth),b.bottom=Math.min(b.bottom,h.y+a.clientHeight),b.left=Math.max(b.left,h.x)}return d=f.scrollLeft,f=f.scrollTop,b.left=Math.max(b.left,d),b.top=Math.max(b.top,f),c=(c.da.parentWindow||c.da.defaultView||window).document,c="CSS1Compat"==c.compatMode?c.documentElement:c.body,c=new Td(c.clientWidth,c.clientHeight),b.right=Math.min(b.right,d+c.width),b.bottom=Math.min(b.bottom,f+c.height),0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:t}function re(a){var b,c=Zd(a),d=me(a,"position"),e=lb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Vd(0,0),g=ne(c);if(a==g)return f;if(a.getBoundingClientRect)b=oe(a),a=he(Xd(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{if(f.x+=b.offsetLeft,f.y+=b.offsetTop,b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0),mb&&"fixed"==me(b,"position")){f.x+=c.body.scrollLeft,f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);for((jb||mb&&"absolute"==d)&&(f.y-=c.body.offsetTop),b=a;(b=pe(b))&&b!=c.body&&b!=g;)f.x-=b.scrollLeft,jb&&"TR"==b.tagName||(f.y-=b.scrollTop)}return f}function te(a){var b=new Vd;if(1==a.nodeType){if(a.getBoundingClientRect){var c=oe(a);b.x=c.left,b.y=c.top}else{var c=he(Xd(a)),d=re(a);b.x=d.x-c.x,b.y=d.y-c.y}if(lb&&!Cb(12)){var e;J?e="-ms-transform":mb?e="-webkit-transform":jb?e="-o-transform":lb&&(e="-moz-transform");var f;e&&(f=me(a,e)),f||(f=me(a,"transform")),f?(a=f.match(ue),a=a?new Vd(parseFloat(a[1]),parseFloat(a[2])):new Vd(0,0)):a=new Vd(0,0),b=new Vd(b.x+a.x,b.y+a.y)}}else e=oa(a.ki),f=a,a.targetTouches?f=a.targetTouches[0]:e&&a.jb.targetTouches&&(f=a.jb.targetTouches[0]),b.x=f.clientX,b.y=f.clientY;return b}function ve(a,b){return"number"==typeof a&&(a=(b?Math.round(a):a)+"px"),a}function we(a){if("none"!=me(a,"display"))return xe(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;return b.visibility="hidden",b.position="absolute",b.display="inline",a=xe(a),b.display=c,b.position=e,b.visibility=d,a}function xe(a){var b=a.offsetWidth,c=a.offsetHeight,d=mb&&!b&&!c;return ja(b)&&!d||!a.getBoundingClientRect?new Td(b,c):(a=oe(a),new Td(a.right-a.left,a.bottom-a.top))}function ye(a,b){a.style.display=b?"":"none"}function se(a){return"rtl"==me(a,"direction")}function ze(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left,a.style.left=b;var e=a.style.pixelLeft;return a.style.left=c,a.runtimeStyle.left=d,e}function Ae(a,b){var c=a.currentStyle?a.currentStyle[b]:t;return c?ze(a,c):0}function Ce(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:t))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:t;return c in Be?Be[c]:ze(a,c)}function De(a,b){ic.call(this),this.D=a;var c=pa(this.D)&&1==this.D.nodeType?this.D:this.D?this.D.body:t;this.Di=!!c&&se(c),this.Rk=L(this.D,lb?"DOMMouseScroll":"mousewheel",this,b)}function Ee(a,b){return mb&&(bb||eb)&&0!=a%b?a:a/b}function Fe(a,b,c,d){b&&this.wa(b,p),this.type="mousewheel",this.detail=a,this.Mk=c,this.Jc=d}function Ge(a){O.call(this),this.g="interactor",this.Ja=a,this.He=this.dg=this.cg=this.eg=this.bg=this.fg=t,this.Qd=q,this.Ub=this.Nb=this.ob=u,this.pa=[0,0],this.Ce=new D.m(0,0,0),this.Qc=new D.m(0,0,0),this.Kg=0,this.mg=this.Md=t,this.lg=u,this.O={MOUSEWHEEL_ENABLED:q,MOUSECLICKS_ENABLED:q,KEYBOARD_ENABLED:q,HOVERING_ENABLED:q,CONTEXTMENU_ENABLED:u,TOUCH_ENABLED:q,TOUCH_BOUNCING_ENABLED:u}}function Je(a){if(clearTimeout(a.mg),a.Ud){var b=new Hd;b.nb=u,b.Za=a instanceof Ie,a.dispatchEvent(b)}a.Ud=u}function He(a){a.Md&&clearTimeout(a.Md),a.dispatchEvent(new Kd)}function Ke(a){Ge.call(this,a),this.g="interactor2D"}function Le(a){Y.call(this),this.g="slice",this.A=[0,0,0],this.tc=[0,0,1],this.Z=[0,1,0],this.Td=[1,0,0],this.v=this.H=10,this.Fc=[0,1,0,0,1,1,1,1,1,0,0,0],this.e=this.zb=t,this.ub=q,this.pc=[1,1,1],a!=t&&this.gc(a)}function Me(){O.call(this),this.g="parser",this.P=t,this.R=0,this.Hh=0<new Int8Array(new Int16Array([1]).buffer)[0],this.Od=q,this.Gk=-1/0,this.Fk=1/0}function Ne(a){for(var b=1/0,c=-1/0,d=a.length,e=0,e=0;d>e;e++)if(!isNaN(a[e]))var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}function Oe(a,b,c){b===p&&(b=0),c===p&&(c=a.length);for(var d="",e=0,e=b;c>e;++e)d+=String.fromCharCode(a[e]);return d}function Z(a,b,c){c!=t||(c=1);var d=1,e=Uint8Array;switch(b){case"schar":e=Int8Array;break;case"ushort":e=Uint16Array,d=2;break;case"sshort":e=Int16Array,d=2;break;case"uint":e=Uint32Array,d=4;break;case"sint":e=Int32Array,d=4;break;case"float":e=Float32Array,d=4;break;case"complex":e=Float64Array,d=8;break;case"double":e=Float64Array,d=8}if(b=new e(a.P.slice(a.R,a.R+=c*d)),a.Hh!=a.Od){for(a=b,b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f],b[f]=h}b=a}return 1==c?b[0]:b}function Pe(a,b){var c=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],d=Pc(0,0,0,1),e=Oc();return ad(a,d,e),c[0]=e[0]<c[0]?e[0]:c[0],c[1]=e[0]>c[1]?e[0]:c[1],c[2]=e[1]<c[2]?e[1]:c[2],c[3]=e[1]>c[3]?e[1]:c[3],c[4]=e[2]<c[4]?e[2]:c[4],c[5]=e[2]>c[5]?e[2]:c[5],d=Pc(0,0,b[2]-1,1),ad(a,d,e),c[0]=e[0]<c[0]?e[0]:c[0],c[1]=e[0]>c[1]?e[0]:c[1],c[2]=e[1]<c[2]?e[1]:c[2],c[3]=e[1]>c[3]?e[1]:c[3],c[4]=e[2]<c[4]?e[2]:c[4],c[5]=e[2]>c[5]?e[2]:c[5],d=Pc(0,b[1]-1,0,1),ad(a,d,e),c[0]=e[0]<c[0]?e[0]:c[0],c[1]=e[0]>c[1]?e[0]:c[1],c[2]=e[1]<c[2]?e[1]:c[2],c[3]=e[1]>c[3]?e[1]:c[3],c[4]=e[2]<c[4]?e[2]:c[4],c[5]=e[2]>c[5]?e[2]:c[5],d=Pc(b[0]-1,0,0,1),ad(a,d,e),c[0]=e[0]<c[0]?e[0]:c[0],c[1]=e[0]>c[1]?e[0]:c[1],c[2]=e[1]<c[2]?e[1]:c[2],c[3]=e[1]>c[3]?e[1]:c[3],c[4]=e[2]<c[4]?e[2]:c[4],c[5]=e[2]>c[5]?e[2]:c[5],d=Pc(b[0]-1,b[1]-1,0,1),ad(a,d,e),c[0]=e[0]<c[0]?e[0]:c[0],c[1]=e[0]>c[1]?e[0]:c[1],c[2]=e[1]<c[2]?e[1]:c[2],c[3]=e[1]>c[3]?e[1]:c[3],c[4]=e[2]<c[4]?e[2]:c[4],c[5]=e[2]>c[5]?e[2]:c[5],d=Pc(b[0]-1,0,b[2]-1,1),ad(a,d,e),c[0]=e[0]<c[0]?e[0]:c[0],c[1]=e[0]>c[1]?e[0]:c[1],c[2]=e[1]<c[2]?e[1]:c[2],c[3]=e[1]>c[3]?e[1]:c[3],c[4]=e[2]<c[4]?e[2]:c[4],c[5]=e[2]>c[5]?e[2]:c[5],d=Pc(0,b[1]-1,b[2]-1,1),ad(a,d,e),c[0]=e[0]<c[0]?e[0]:c[0],c[1]=e[0]>c[1]?e[0]:c[1],c[2]=e[1]<c[2]?e[1]:c[2],c[3]=e[1]>c[3]?e[1]:c[3],c[4]=e[2]<c[4]?e[2]:c[4],c[5]=e[2]>c[5]?e[2]:c[5],d=Pc(b[0]-1,b[1]-1,b[2]-1,1),ad(a,d,e),c[0]=e[0]<c[0]?e[0]:c[0],c[1]=e[0]>c[1]?e[0]:c[1],c[2]=e[1]<c[2]?e[1]:c[2],c[3]=e[1]>c[3]?e[1]:c[3],c[4]=e[2]<c[4]?e[2]:c[4],c[5]=e[2]>c[5]?e[2]:c[5],c}function Qe(a,b){var c=Rc();if(a.length!=b.length||a[0]!=b[0]||a[1]!=b[1]||a[2]!=b[2]){var d=Math.acos(a[2]),e=Lc(),f=a[0],g=a[1],h=a[2],i=b[0],j=b[1],k=b[2];e[0]=g*k-h*j,e[1]=h*i-f*k,e[2]=f*j-g*i,Nc(e,e),f=Math.cos(d/2),g=Math.sin(d/2)*e[0],h=Math.sin(d/2)*e[1],d=Math.sin(d/2)*e[2],V(c,0,f*f+g*g-h*h-d*d,2*(g*h-f*d),2*(g*d+f*h),0),V(c,1,2*(g*h+f*d),f*f+h*h-g*g-d*d,2*(h*d-f*g),0),V(c,2,2*(g*d-f*h),2*(h*d+f*g),f*f+d*d-h*h-g*g,0)}return d=Qc(),Zc(c,d),[c,d]}function Re(a,b,c,d,e,f,g,h,i){var j=new Le;Nc(c,c);for(var k=[],l=[],m=0;6>m;m++)for(var n=Math.floor(m/2),o=(n+1)%3,p=(n+2)%3,r=(4+2*n)%6,s=0;2>s;s++){var v=(2+s+2*n)%6,w=-(c[n]*(e[m]-a[n])+c[o]*(e[v]-a[o]))/c[p]+a[p];if(w>=e[r]&&w<=e[r+1]||w<=e[r]&&w>=e[r+1]){var x=[];x[n]=e[m],x[o]=e[v],x[p]=w,k.push(x)}else x=[],x[n]=e[m],x[o]=e[v],x[p]=w,l.push(x)}for(a=Mc(0,0,1),a=Qe(c,a),e=a[0],a=a[1],n=[],l=0;l<k.length;++l)m=Pc(k[l][0],k[l][1],k[l][2],1),o=Oc(),ad(e,m,o),n.push([o[0],o[1],o[2]]);for(e=Mc(1,0,0),k=Lc(),$c(a,e,k),l=Mc(0,1,0),e=Lc(),$c(a,l,e),m=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],l=l=0;l<n.length;++l)n[l][0]<m[0]&&(m[0]=n[l][0]),n[l][0]>m[1]&&(m[1]=n[l][0]),n[l][1]<m[2]&&(m[2]=n[l][1]),n[l][1]>m[3]&&(m[3]=n[l][1]),n[l][2]<m[4]&&(m[4]=n[l][2]),n[l][2]>m[5]&&(m[5]=n[l][2]);l=Pc(m[0]+(m[1]-m[0])/2,m[2]+(m[3]-m[2])/2,m[4]+(m[5]-m[4])/2,0),n=Oc(),Yc(a,l,n),o=Math.floor(m[0]),p=Math.ceil(m[1]),o==p&&p++,r=p-o,s=Math.floor(m[2]),v=Math.ceil(m[3]),w=v-s,x=b[0],b=b[1];var l=Math.ceil(r/x),y=Math.ceil(w/b),z=new Uint8Array(4*l*y),A=new ed;A.Ne=l,A.Me=y;var y=Oc(),B=Pc(0,0,m[4],1),C=Qc();Yc(g.yh,a,C);for(var D=v-1e-7,E=p-1e-7,F=0,G=0,H=0,I=s,I=s;D>=I;I+=b)for(H++,G=0,B[1]=I,l=o;E>=l;l+=x){G++,B[0]=l,ad(C,B,y);var J=4*F,K=Math.floor(y[2]),L=Math.floor(y[1]),M=Math.floor(y[0]);if(M>=0&&M<g.oa[0]&&L>=0&&L<g.oa[1]&&K>=0&&K<g.oa[2]){var N=f[K][L][M],O=M=L=K=0;i?((N=i.get(N))||(N=[0,.61,0,0,1]),K=255*N[1],L=255*N[2],M=255*N[3],O=255*N[4]):(K=L=M=255*(N/g.ma),O=255),z[J]=K,z[++J]=L,z[++J]=M,z[++J]=O}else z[J]=0,z[++J]=0,z[++J]=0,z[++J]=0;F++}return A.Tb=z,j.C=A,j.Nh=m,j.Ah=a,j.zh=C,j.Gh=s,j.Dk=v,j.Mh=o,j.Ik=p,j.Zf=G,j.Yf=H,j.Hc=x,j.H=r,j.uc=b,j.v=w,j.A=[n[0],n[1],n[2]],j.tc=[c[0],c[1],c[2]],j.Td=[k[0],k[1],k[2]],j.Z=[e[0],e[1],e[2]],j.L=u,j.zb=g,j.ub=g.zb==t||h?q:u,j.pc=d,j.hc(),j.L=u,j}function Se(a,b,c,d){var e;e=d.ka;for(var f=[],g=[],h=0;6>h;h++){var i=Math.floor(h/2),j=(i+1)%3,k=(i+2)%3,l=(2+2*i)%6,m=(4+2*i)%6,n=(e[h]-b[i])*(1/c[i]);if(1/0!=n&&-1/0!=n){var o=b[j]+c[j]*n,n=b[k]+c[k]*n;o>=e[l]&&o<=e[l+1]&&n>=e[m]&&n<=e[m+1]?(l=[],l[i]=e[h],l[j]=o,l[k]=n,f.push(l)):(l=[],l[i]=e[h],l[j]=o,l[k]=n,g.push(l))}}e=[f,g],b=e[0],d.b[a].k=e,e=Ec(new U(b[0][0],b[0][1],b[0][2]),new U(b[1][0],b[1][1],b[1][2])),d.b[a].Ck=e,f=Mc(0,0,1),g=Qe(c,f)[0],h=Pc(d.ye[0],d.ye[1],d.ye[2],0),f=Oc(),ad(g,h,f),g=Oc(),h=f[2],g[0]=c[0]*h,g[1]=c[1]*h,g[2]=c[2]*h,g[3]=c[3]*h,.5>Math.abs(f[0])&&(f[0]=.5),.5>Math.abs(f[1])&&(f[1]=.5),d.b[a].Ca=[Math.abs(f[0]),Math.abs(f[1])],d.b[a].Dc=f[2],d.b[a].w=g,e=Math.floor(Math.abs(e/f[2])),d.cd[a]=e+1,d.b[a].o=e+1,d.b[a].k[0][0][0]>d.b[a].k[0][1][0]?0<g[0]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][0]<d.b[a].k[0][1][0]?0>g[0]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][1]>d.b[a].k[0][1][1]?0<g[1]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][1]<d.b[a].k[0][1][1]?0>g[1]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][2]>d.b[a].k[0][1][2]?0<g[2]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e):d.b[a].k[0][0][2]<d.b[a].k[0][1][2]&&0>g[2]&&(e=d.b[a].k[0][0],d.b[a].k[0][0]=d.b[a].k[0][1],d.b[a].k[0][1]=e),d.b[a].Je=-(c[0]*b[0][0]+c[1]*b[0][1]+c[2]*b[0][2])}function Ve(a,b){var c;c=b.P;for(var d=b.oa,e=b.ma,f=Array(d[2]),g=Array(d[2]),h=d[1]*d[0],i=0,j=0,k=0,l=0,m=0,l=0;l<d[2];l++){var n=c.subarray(l*h,(l+1)*h),m=0;for(g[l]=Array(d[1]),f[l]=Array(d[1]),k=0;k<d[1];k++)for(g[l][k]=new c.constructor(d[0]),f[l][k]=new c.constructor(d[0]),j=0;j<d[0];j++)i=n[m],g[l][k][j]=255*(i/e),f[l][k][j]=i,m++}return c=[f,g],b.ba=c[0],b.Ak=c[1],D.Ya(a.g+".reslice"),b.I=b.e!=t,b.Aa&&(b.Oc=b.Aa.Fa),b.Vk=[0,0,0],b.t=[b.ya[0]+(b.tb[0]-1)/2,b.ya[1]+(b.tb[1]-1)/2,b.ya[2]+(b.tb[2]-1)/2],b.ka=[Math.min(b.ya[0],b.ya[0]+b.tb[0]-1),Math.max(b.ya[0],b.ya[0]+b.tb[0]-1),Math.min(b.ya[1],b.ya[1]+b.tb[1]-1),Math.max(b.ya[1],b.ya[1]+b.tb[1]-1),Math.min(b.ya[2],b.ya[2]+b.tb[2]-1),Math.max(b.ya[2],b.ya[2]+b.tb[2]-1)],b.b=[{},{},{}],c=Mc(b.t[0],b.t[1],b.t[2]),b.b[0].ed=c,d=Mc(1,0,0),Nc(d,d),b.b[0].i=d,e=[1,0,0],b.b[0].u=e,Se(0,c,d,b),b.c[0].c=Array(b.b[0].o),c[0]=b.b[0].k[0][0][0]+b.b[0].w[0]*Math.floor(b.b[0].o/2),c[1]=b.b[0].k[0][0][1]+b.b[0].w[1]*Math.floor(b.b[0].o/2),c[2]=b.b[0].k[0][0][2]+b.b[0].w[2]*Math.floor(b.b[0].o/2),c=Re(c,b.b[0].Ca,b.b[0].i,b.b[0].u,b.ka,b.ba,b,b.I,b.Oc),b.I&&(c.e=b.e.c[0].c[Math.floor(b.b[0].o/2)].C),b.c[0].c[Math.floor(b.b[0].o/2)]=c,b.vb=Math.floor(b.b[0].o/2),b.vc=Math.floor(b.b[0].o/2),c=Mc(b.t[0],b.t[1],b.t[2]),b.b[1].ed=c,d=Mc(0,1,0),Nc(d,d),b.b[1].i=d,e=[0,1,0],b.b[1].u=e,Se(1,c,d,b),b.c[1].c=Array(b.b[1].o),c[0]=b.b[1].k[0][0][0]+b.b[1].w[0]*Math.floor(b.b[1].o/2),c[1]=b.b[1].k[0][0][1]+b.b[1].w[1]*Math.floor(b.b[1].o/2),c[2]=b.b[1].k[0][0][2]+b.b[1].w[2]*Math.floor(b.b[1].o/2),c=Re(c,b.b[1].Ca,b.b[1].i,b.b[1].u,b.ka,b.ba,b,b.I,b.Oc),b.I&&(c.e=b.e.c[1].c[Math.floor(b.b[1].o/2)].C),b.c[1].c[Math.floor(b.b[1].o/2)]=c,b.wb=Math.floor(b.b[1].o/2),b.wc=Math.floor(b.b[1].o/2),c=Mc(b.t[0],b.t[1],b.t[2]),b.b[2].ed=c,d=Mc(0,0,1),Nc(d,d),b.b[2].i=d,e=[0,.392,.804],b.b[2].u=e,Se(2,c,d,b),b.c[2].c=Array(b.b[2].o),c[0]=b.b[2].k[0][0][0]+b.b[2].w[0]*Math.floor(b.b[2].o/2),c[1]=b.b[2].k[0][0][1]+b.b[2].w[1]*Math.floor(b.b[2].o/2),c[2]=b.b[2].k[0][0][2]+b.b[2].w[2]*Math.floor(b.b[2].o/2),c=Re(c,b.b[2].Ca,b.b[2].i,b.b[2].u,b.ka,b.ba,b,b.I,b.Oc),b.I&&(c.e=b.e.c[2].c[Math.floor(b.b[2].o/2)].C),b.c[2].c[Math.floor(b.b[2].o/2)]=c,b.xb=Math.floor(b.b[2].o/2),b.xc=Math.floor(b.b[2].o/2),D.Ua(a.g+".reslice"),b.ba
}function Q(a){Y.call(this),this.g="volume",this.A=[0,0,0],this.oa=[10,10,10],this.ka=[1,1,1],this.cd=[10,10,10],this.kd=[1,1,1],this.Jb=[],this.xc=this.xb=this.wc=this.wb=this.vc=this.vb=0,this.gd=new Y,this.hd=new Y,this.jd=new Y,this.Wd=this.Ma=u,this.T=-1,this.ng=[],this.e=t,this.ub=q,this.ia=1/0,this.ha=-1/0,this.kg=q,this.ma=0,this.P=t,Ga(this,new wc),Ga(this,new hd),a!=t&&this.gc(a)}function We(a,b){if(!a.Id)if(!a.Ma||!a.j&&b==a.T)a.T=b;else if(-1==a.ng.indexOf(b)){a.ng.push(b),a.Id=q;var c=new Nd;c.K=a,a.dispatchEvent(c),a.onComputing(b),setTimeout(function(){var a=t;0<=this.T&&(a=this.c[this.T],a.visible=u);var c,a=this.c[b],d=a.c.length,e=Math.floor(d/4);for(c=0;1*e>c;c++){if(a.c[c]==t){var f=Lc();if(f[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*c,f[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*c,f[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*c,this.I){var g=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa);this.e.c[b].c[c]=g,this.e.c[b].p(q)}f=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t),f.c[0].L=u,this.I&&(f.e=f.C,f.e=this.e.c[b].c[c].C),a.c[c]=f}a.c[c].L=q}Ye(this,.25),setTimeout(function(){for(;2*e>c;c++){if(a.c[c]==t){var f=Lc();if(f[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*c,f[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*c,f[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*c,this.I){var g=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa);this.e.c[b].c[c]=g,this.e.c[b].p(q)}f=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t),f.c[0].L=u,this.I&&(f.e=f.C,f.e=this.e.c[b].c[c].C),a.c[c]=f}a.c[c].L=q}Ye(this,.5),setTimeout(function(){for(;3*e>c;c++){if(a.c[c]==t){var f=Lc();if(f[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*c,f[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*c,f[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*c,this.I){var g=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa);this.e.c[b].c[c]=g,this.e.c[b].p(q)}f=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t),f.c[0].L=u,this.I&&(f.e=f.C,f.e=this.e.c[b].c[c].C),a.c[c]=f}a.c[c].L=q}Ye(this,.75),setTimeout(function(){for(c=3*e;d>c;c++){if(a.c[c]==t){var f=Lc();if(f[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*c,f[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*c,f[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*c,this.I){var g=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa);this.e.c[b].c[c]=g,this.e.c[b].p(q)}f=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t),f.c[0].L=u,this.I&&(f.e=f.C,f.e=this.e.c[b].c[c].C),a.c[c]=f}a.c[c].L=q}Ye(this,1),setTimeout(function(){if(this.Id&&this.c[b].p(q),this.T=b,this.j=u,this.Id){var a=new Pd;a.K=this,this.dispatchEvent(a),this.onComputingEnd(b)}this.Id=u}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(a),10)}else{c=a.c[a.T],c.visible=u;var d,c=a.c[b],e=c.c.length;for(d=0;e>d;d++)c.c[d].L=q;a.T=b,a.j=u}}function Ye(a,b){var c=new Od;c.od=b,a.dispatchEvent(c),a.onComputingProgress(100*b)}function Ze(){Me.call(this),this.g="parserSTL"}function $e(){Me.call(this),this.g="parserDCM"}function af(a,b,c,d){switch(c){case 16975:case 20819:case 20053:case 22351:c=function(a){for(var b="",c=128;c>=1;c/=2)b+=a&c?"1":"0";return b},d=a[b++],a=a[b++],d=parseInt(c((65280&a)>>8)+c(255&a)+(c((65280&d)>>8)+c(255&d)),2),4294967295==d&&(d=0),b+=d/2;break;default:b+=d/2}return b}function bf(){Me.call(this),this.g="parserVTK"}function cf(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),d=c.length,e=c[0];switch(e){case"POINTS":return a.Rb=q,a.Ib=u,a.Qb=u,c=parseInt(c[1],10),a.nd=new W(3*c),a.md=new W(3*c),void 0;case"VERTICES":return a.Ib=q,a.Rb=u,a.Qb=u,c=parseInt(c[1],10),c>=3?a.Ka=gd:1==c?a.Ka="POINTS":m(Error("This VTK file is not supported!")),a.bc=[],void 0;case"TRIANGLE_STRIPS":return a.Ib=q,a.Rb=u,a.Qb=u,a.Ka="TRIANGLE_STRIPS",a.bc=[],void 0;case"LINES":return a.Ib=q,a.Rb=u,a.Qb=u,a.Ka="LINES",a.bc=[],void 0;case"POLYGONS":return a.Ib=q,a.Rb=u,a.Qb=u,a.Ka="POLYGONS",a.bc=[],void 0;case"POINT_DATA":return a.Qb=q,a.Rb=u,a.Ib=u,void 0}if(a.Rb)if(1==d||isNaN(parseFloat(e)))a.Rb=u;else{if(d>=3){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.nd.add(e,f,g)}d>=6&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.nd.add(e,f,g)),d>=9&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.nd.add(d,e,c))}else a.Ib?1==d||isNaN(parseFloat(e))?a.Ib=u:(c=c.slice(1),a.bc.push(c)):a.Qb&&("NORMALS"==e?a.Ie=q:1==d||isNaN(parseFloat(e))?(a.Qb=u,a.Ie=u):a.Ie&&(d>=3&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.md.add(e,f,g)),d>=6&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.md.add(e,f,g)),d>=9&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.md.add(d,e,c))))}function df(){Me.call(this),this.g="parserFSM",this.Od=u}function ff(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=0,m=Number.POSITIVE_INFINITY;for(i=0;k>i;++i)a[i]>l&&(l=a[i]),a[i]<m&&(m=a[i]);for(b=1<<l,c=new Uint32Array(b),d=1,e=0,f=2;l>=d;){for(i=0;k>i;++i)if(a[i]===d){for(g=0,h=e,j=0;d>j;++j)g=g<<1|1&h,h>>=1;for(j=g;b>j;j+=f)c[j]=d<<16|i;++e}++d,e<<=1,f<<=1}return[c,l,m]}function gf(a,b){switch(this.We=[],this.Xe=32768,this.ib=this.pd=this.xa=this.Kf=0,this.input=new Uint8Array(a),this.pg=u,this.Ye=hf,this.Cb=u,(b||!(b={}))&&(b.index&&(this.xa=b.index),b.bufferSize&&(this.Xe=b.bufferSize),b.bufferType&&(this.Ye=b.bufferType),b.resize&&(this.Cb=b.resize)),this.Ye){case jf:this.ea=32768,this.Oa=new Uint8Array(32768+this.Xe+258);break;case hf:this.ea=0,this.Oa=new Uint8Array(this.Xe),this.jc=this.di,this.sg=this.Uh,this.ef=this.Yh;break;default:m(Error("invalid inflate mode"))}}function kf(a,b){for(var c,d=a.pd,e=a.ib,f=a.input,g=a.xa;b>e;)c=f[g++],c===p&&m(Error("input buffer is broken")),d|=c<<e,e+=8;return c=d&(1<<b)-1,a.pd=d>>>b,a.ib=e-b,a.xa=g,c}function zf(a,b){for(var c,d=a.pd,e=a.ib,f=a.input,g=a.xa,h=b[0],i=b[1];i>e;)c=f[g++],c===p&&m(Error("input buffer is broken")),d|=c<<e,e+=8;return f=h[d&(1<<i)-1],h=f>>>16,a.pd=d>>h,a.ib=e-h,a.xa=g,65535&f}function nf(a){function b(a,b,c){var d,e,f;for(f=0;a>f;)switch(d=zf(this,b)){case 16:for(d=3+kf(this,2);d--;)c[f++]=e;break;case 17:for(d=3+kf(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+kf(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c,d=kf(a,5)+257,e=kf(a,5)+1,f=kf(a,4)+4,g=new Uint8Array(of.length);for(c=0;f>c;++c)g[of[c]]=kf(a,3);f=ff(g),g=new Uint8Array(d),c=new Uint8Array(e),a.ef(ff(b.call(a,d,f,g)),ff(b.call(a,e,f,c)))}function Ff(){var a=Gf;switch(q){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:m("invalid length: "+a)}}function Jf(){}function Kf(a){this.input=a,this.xa=0,this.member=[]}function Lf(){Me.call(this),this.g="parserMGZ",this.Od=u}function Mf(){Me.call(this),this.g="parserLBL"}function Nf(){Me.call(this),this.g="parserCRV",this.Od=u}function Of(){Me.call(this),this.g="parserTRK"}function Pf(){Me.call(this),this.g="parserIMAGE"}function Qf(){Me.call(this),this.g="parserLUT"}function Rf(){Me.call(this),this.g="parserNRRD"}function Sf(){Me.call(this),this.g="parserNII"}function Tf(){Me.call(this),this.g="parserOBJ"}function Uf(){O.call(this),this.g="loader",this.yc=new yc,this.bd=0}function Vf(a,b){a.bd+=b/a.yc.ee()/3,a.bd=Math.min(1,a.bd);var c=new Md;c.od=a.bd,a.dispatchEvent(c)}function Wf(a){a=a.r.Sd;var b=a.split(".").pop().toUpperCase();return b==a.toUpperCase()&&(b=""),b in Xf||m(Error("The "+b+" file format is not supported.")),[a,b,Xf[b][0],Xf[b][1],Xf[b][2]]}function Yf(a,b){(!x(a)||!x(b))&&m(Error("A camera needs valid width and height values.")),O.call(this),this.g="camera",this.cc=new D.m(0,100,0),this.sc=new D.m(0,0,0),this.Z=new D.m(0,0,1),this.H=a,this.v=b,this.n=this.me(this.cc,this.sc)}function Zf(a){function b(a,b,d){return b=2*b*Math.PI,b=Aa(Ba(i,Math.cos(b)),Ba(j,Math.sin(b))),a=Aa(Aa(c,Ba(e,a)),Ba(b,f)),d=Aa(Ba(b,1-Math.abs(d)),Ba(g,d)),new jc(a,d)}this.V=[],a=a||{};var c=new ya(a.start||[0,-1,0]),d=new ya(a.end||[0,1,0]),e=Ca(d,c),f=a.qb||1;a=a.na||16;for(var g=Da(e),h=.5<Math.abs(g.y()),i=Da(new ya(h,!h,0).ic(g)),j=Da(i.ic(g)),h=new jc(c,Fa(g)),d=new jc(d,Da(g)),k=[],l=0;a>l;l++){var m=l/a,n=(l+1)/a;k.push(new lc([h,b(0,m,-1),b(0,n,-1)])),k.push(new lc([b(0,n,0),b(0,m,0),b(1,m,0),b(1,n,0)])),k.push(new lc([d,b(1,n,1),b(1,m,1)]))}return tc(k)}function $f(){Y.call(this),this.g="cylinder",this.Re=[-10,-10,-10],this.Ae=[10,10,10],this.dc=10,this.Wa=32,Ga(this,new md)}function ag(a){function b(a,b){a*=2*Math.PI,b*=Math.PI;var e=new ya(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new jc(Aa(c,Ba(e,d)),e))}this.V=[],a=a||{};var c=new ya(a.$e||[0,0,0]),d=a.qb||1,e=a.na||16;a=a.Fj||8;for(var f=[],g=[],h=0;e>h;h++)for(var i=0;a>i;i++)g=[],b(h/e,i/a),i>0&&b((h+1)/e,i/a),a-1>i&&b((h+1)/e,(i+1)/a),b(h/e,(i+1)/a),f.push(new lc(g));return tc(f)}function bg(){Y.call(this),this.g="sphere",this.A=[0,0,0],this.dc=5,this.Wa=32,this.Ih=16,Ga(this,new md)}function Xe(a){Q.call(this),this.g="labelmap",this.zb=a,this.Qe=new Float32Array([-255,-255,-255,-255])}function cg(a){this.V=[],a=a||{};var b=new ya(a.$e||[0,0,0]),c=a.qb?a.qb.length?a.qb:[a.qb,a.qb,a.qb]:[1,1,1];return tc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new lc(a[0].map(function(d){return d=new ya(b.x()+c[0]*(2*!!(1&d)-1),b.y()+c[1]*(2*!!(2&d)-1),b.d()+c[2]*(2*!!(4&d)-1)),new jc(d,new ya(a[1]))}))}))}function dg(){Y.call(this),this.g="cube",this.A=[0,0,0],this.Fe=this.Ee=this.De=20,this.Fc=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0],Ga(this,new md)}function Ie(a){Ge.call(this,a),this.g="interactor3D",this.Bk=u}function eg(a){O.call(this),this.g="array",this.F=[],this.Rf=a}function fg(a,b,c){for(var d=0;4>d;d++)if(a[d+0]!==b[d+c])return u;return q}function gg(a,b,c){var d=c-b;if(!(2>d))for(d=b+Math.floor(d/2),gg(a,b,d),gg(a,d,c);d>b;++b)if(0<a.Rf(a.F[b],a.F[d])){var e=a.F[b];a.F[b]=a.F[d];for(var f=a,g=d,h=c;h>g+1&&0>f.Rf(f.F[g+1],e);){var i=f,j=g+1,k=i.F[g];i.F[g]=i.F[j],i.F[j]=k,++g}f.F[g]=e}}function hg(a,b){Yf.call(this,a,b),this.g="camera2D"}function ig(a,b){Yf.call(this,a,b),this.g="camera3D",this.Uf=45,this.Le=D.f.mf(D.f.td(),this.Uf,a/b,1,1e4)}function jg(a,b,c,d){var e=new Float32Array(4),f=new Float32Array(4),g=new Float32Array(16),h=new Float32Array(16);return new Float32Array(16),D.f.multiply(a.Le,a.n,h),D.f.U(h,g),e[0]=b,e[1]=c,e[2]=2*d-1,e[3]=1,D.f.Qg(g,e,f),f[3]=1/f[3],f[0]*=f[3],f[1]*=f[3],f[2]*=f[3],f}function kg(a){Pb.call(this),this.Ab=a,this.Q=[]}function mg(a,b,c,d,e){la(c)||(lg[0]=c,c=lg);for(var f=0;f<c.length;f++){var g=L(b,c[f],d||a,e||u,a.Ab||a);a.Q.push(g)}}function ng(){}function og(a){ic.call(this),this.Wb=a||Xd(),this.tj=pg}function qg(){ic.call(this)}function rg(a,b){return a.Jf==t?b:a.vd+Math.round((b-a.vd)/a.Jf)*a.Jf}function sg(a){og.call(this,a),this.zd=new qg,L(this.zd,"change",this.oi,u,this)}function vg(a){var b=a.ie();a.s().setAttribute("aria-valuenow",b)}function wg(a,b){a==t&&m(Error("No valid parent element.")),b==t&&m(Error("Invalid initial value.")),sg.call(this),this.g="progressbar",this.Va=a,this.Ke="",this.Jd=this.yb=t,this.ac=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n",c+="  background: white;\n",c+="  padding: 1px;\n",c+="  overflow: hidden;\n",c+="  margin: 2px;\n",c+="  width: 100px;\n",c+="  height: 5px;\n",c+="}";var d;d=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n",d+="  overflow: hidden;\n",d+="  width: 0%;\n",d+="  height: 100%;\n",d+="}";var e;e=".progress-bar-thumb-done {\n  background: #57E964;\n}",this.ac=[c,d,e],this.Bd(b),this.hf()}function xg(a){var b=a.s().style.top,c=a.s().style.left;de(a.s());var d=new wg(a.Va,100),e=d.s();e.style.position="absolute",e.style.top=b,e.style.left=c,e.classList.add("xtk-progress-bar"),(e.firstElementChild!=p?e.firstElementChild:ee(e.firstChild)).classList.add("progress-bar-thumb-done"),a.Jd=d}function yg(a,b,c){return oa(a)?c&&(a=va(a,c)):a&&"function"==typeof a.handleEvent?a=va(a.handleEvent,a):m(Error("Invalid listener argument")),b>2147483647?-1:ga.setTimeout(a,b||0)}function zg(){O.call(this),this.g="renderer",this.B=window.document.body,this.H=this.B.clientWidth,this.v=this.B.clientHeight,this.S=this.J=this.za=t,this.pb=new eg(ld),this.hb=[],this.W=t,this.Rd=this.Rc=this.Pd=u,this.a=this.Sb=this.Ga=t,this.O={PROGRESSBAR_ENABLED:q,INTERMEDIATE_RENDERING:u,SLICENAVIGATORS:q},this.xe=-1,window.console.log("XTK release 10 -- 2013-11-07 14:57:41 -- http://www.goXTK.com -- @goXTK")}function Ag(){O.call(this),this.g="shaders",this.Vd="";var a;a="precision mediump float;\n\n",a+="attribute vec3 vertexPosition;\n",a+="attribute vec3 vertexNormal;\n",a+="attribute vec3 vertexColor;\n",a+="attribute vec2 vertexTexturePos;\n",a+="attribute float vertexScalar;\n",a+="\n",a+="uniform mat4 view;\n",a+="uniform mat4 perspective;\n",a+="uniform vec3 center;\n",a+="uniform mat4 objectTransform;\n",a+="uniform bool useObjectColor;\n",a+="uniform bool useScalars;\n",a+="uniform bool scalarsReplaceMode;\n",a+="uniform float scalarsMin;\n",a+="uniform float scalarsMax;\n",a+="uniform vec3 scalarsMinColor;\n",a+="uniform vec3 scalarsMaxColor;\n",a+="uniform float scalarsMinThreshold;\n",a+="uniform float scalarsMaxThreshold;\n",a+="uniform int scalarsInterpolation;\n",a+="uniform vec3 objectColor;\n",a+="uniform float pointSize;\n",a+="\n",a+="varying float fDiscardNow;\n",a+="varying vec4 fVertexPosition;\n",a+="varying vec3 fragmentColor;\n",a+="varying vec2 fragmentTexturePos;\n",a+="varying vec3 fVertexNormal;\n",a+="varying vec3 fTransformedVertexNormal;\n",a+="\n",a+="void main(void) {\n",a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ",a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ",a+="vertexNormal;\n",a+="  fVertexNormal = vertexNormal;\n",a+="  fDiscardNow = 0.0;\n",a+="  vec3 vertexPosition2 = vertexPosition - center;\n",a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n",a+="  fragmentTexturePos = vertexTexturePos;\n",a+="  if (useScalars) {\n",a+="    float scalarValue = vertexScalar;\n",a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n",a+="      if (scalarsReplaceMode) {\n",a+="        fragmentColor = objectColor;\n",a+="      } else {\n",a+="        fDiscardNow = 1.0;\n",a+="      }\n",a+="    } else {\n",a+="      if (scalarsReplaceMode) {\n",a+="        if (scalarsInterpolation == 1) {\n",a+="            vec3 zeroMaxColor;\n",a+="            vec3 zeroMinColor;\n",a+="            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n",a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n",a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n",a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n",a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n",a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n",a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n",a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n",a+="        } else {\n",a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n",a+="          }\n",a+="      } else {\n",a+="        fragmentColor = vertexColor;\n",a+="      }\n",a+="    }\n",a+="  } else if (useObjectColor) {\n",a+="    fragmentColor = objectColor;\n",a+="  } else {\n",a+="    fragmentColor = vertexColor;\n",a+="  }\n",a+="  gl_PointSize = pointSize;\n",a+="  gl_Position = perspective * fVertexPosition;\n",this.Vd=a+="}\n",this.Kd="",a="precision mediump float;\n\n",a+="uniform bool usePicking;\n",a+="uniform bool useTexture;\n",a+="uniform bool volumeTexture;\n",a+="uniform bool useLabelMapTexture;\n",a+="uniform sampler2D textureSampler;\n",a+="uniform sampler2D textureSampler2;\n",a+="uniform float objectOpacity;\n",a+="uniform float labelmapOpacity;\n",a+="uniform vec4 labelmapColor;\n",a+="uniform float volumeLowerThreshold;\n",a+="uniform float volumeUpperThreshold;\n",a+="uniform float volumeScalarMin;\n",a+="uniform float volumeScalarMax;\n",a+="uniform vec3 volumeScalarMinColor;\n",a+="uniform vec3 volumeScalarMaxColor;\n",a+="uniform float volumeWindowLow;\n",a+="uniform float volumeWindowHigh;\n",a+="\n",a+="varying float fDiscardNow;\n",a+="varying vec4 fVertexPosition;\n",a+="varying vec3 fragmentColor;\n",a+="varying vec2 fragmentTexturePos;\n",a+="varying vec3 fVertexNormal;\n",a+="varying vec3 fTransformedVertexNormal;\n",a+="\n",a+="void main(void) {\n",a+=" if (fDiscardNow > 0.0) {\n",a+="   discard;\n",a+=" }\n",a+=" if (usePicking) {\n",a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n",a+=" } else if (useTexture) {\n",a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n",a+="   vec4 textureSum = texture1;\n",a+="   if (volumeTexture) {\n",a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n",a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n",a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n",a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n",a+="     vec3 fac = _maxrange - _minrange;\n",a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n",a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n",a+="   }\n",a+="   if (useLabelMapTexture) {\n",a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n",a+="     if (texture2.a > 0.0) {\n",a+="         if (labelmapColor.a != -255.0) {\n",a+="           if (all(equal(floor(texture2 * vec4(255)), labelmapColor))) {\n",a+="             if (labelmapOpacity < 1.0) {\n",a+="               textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n",a+="             } else {\n",a+="               textureSum = texture2;\n",a+="             }\n",a+="           }\n",a+="         } else {\n",a+="           if (labelmapOpacity < 1.0) {\n",a+="             textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n",a+="           } else {\n",a+="             textureSum = texture2;\n",a+="           }\n",a+="         }\n",a+="     }\n",a+="   }\n",a+="   if (volumeTexture) {\n",a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n",a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n",a+="     if (texture1.r < _volumeLowerThreshold ||\n",a+="         texture1.r > _volumeUpperThreshold ||\n",a+="         texture1.a == 0.0 ) {\n",a+="       discard;\n",a+="     };\n",a+="   };\n",a+="   gl_FragColor = textureSum;\n",a+="   gl_FragColor.a = objectOpacity;\n",a+=" } else {\n",a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n",a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n",a+="     gl_FragColor = vec4(fragmentColor,1.0);\n",a+="     return;\n",a+="   }\n",a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n",a+="   vec3 lightDirection = vec3(0,0,-10);\n",a+="   lightDirection = normalize(lightDirection);\n",a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n",a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n",a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n",a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n",a+="   float ambient = 0.3;\n",a+="   gl_FragColor = vec4(fragmentColor * ambient +\n",a+="                       fragmentColor * diffuse +\n",a+="                       vec3(0.2, 0.2, 0.2) * specular,\n",a+="                       objectOpacity);\n",a+=" }\n",this.Kd=a+="}\n"}function Dg(a,b,c,d,e,f,g,h){var i,j;if(i=c.offsetParent){var k="HTML"==i.tagName||"BODY"==i.tagName;k&&"static"==me(i,"position")||(j=re(i),k||(k=(k=se(i))&&lb?-i.scrollLeft:!k||J&&Cb("8")||"visible"==me(i,"overflowX")?i.scrollLeft:i.scrollWidth-i.clientWidth-i.scrollLeft,j=Wd(j,new Vd(k,i.scrollTop))))}i=j||new Vd,j=re(a),k=we(a),j=new je(j.x,j.y,k.width,k.height),(k=qe(a))&&j.Ig(new je(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=Xd(a),l=Xd(c);if(k.da!=l.da){var m=k.da.body,l=l.da.parentWindow||l.da.defaultView,n=new Vd(0,0),o=Zd(m)?Zd(m).parentWindow||Zd(m).defaultView:window,p=m;do{var q=o==l?re(p):te(p);n.x+=q.x,n.y+=q.y}while(o&&o!=l&&(p=o.frameElement)&&(o=o.parent));m=Wd(n,re(m)),J&&!ge(k)&&(m=Wd(m,he(k))),j.left+=m.x,j.top+=m.y}a=-5&(4&b&&se(a)?2^b:b),b=new Vd(2&a?j.left+j.width:j.left,1&a?j.top+j.height:j.top),b=Wd(b,i),e&&(b.x+=(2&a?-1:1)*e.x,b.y+=(1&a?-1:1)*e.y);var r;return g&&(r=qe(c))&&(r.top-=i.y,r.right-=i.x,r.bottom-=i.y,r.left-=i.x),Eg(b,c,d,f,r,g,h)}function Eg(a,b,c,d,e,f,g){a=a.l();var h=0,i=-5&(4&c&&se(b)?2^c:c);return c=we(b),g=g?g.l():c.l(),(d||0!=i)&&(2&i?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),1&i?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top)),f&&(e?(h=a,d=0,65==(65&f)&&(h.x<e.left||h.x>=e.right)&&(f&=-2),132==(132&f)&&(h.y<e.top||h.y>=e.bottom)&&(f&=-5),h.x<e.left&&1&f&&(h.x=e.left,d|=1),h.x<e.left&&h.x+g.width>e.right&&16&f&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4),h.x+g.width>e.right&&1&f&&(h.x=Math.max(e.right-g.width,e.left),d|=1),2&f&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0)),h.y<e.top&&4&f&&(h.y=e.top,d|=2),h.y<=e.top&&h.y+g.height<e.bottom&&32&f&&(g.height=Math.max(g.height-(e.top-h.y),0),h.y=0,d|=8),h.y>=e.top&&h.y+g.height>e.bottom&&32&f&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8),h.y+g.height>e.bottom&&4&f&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2),8&f&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0)),h=d):h=256,496&h)?h:(f=a,e=lb&&(bb||qb)&&Cb("1.9"),f instanceof Vd?(a=f.x,f=f.y):(a=f,f=p),b.style.left=ve(a,e),b.style.top=ve(f,e),c==g||(c&&g?c.width==g.width&&c.height==g.height:0)||(a=ge(Xd(Zd(b))),!J||a&&Cb("8")?(b=b.style,lb?b.MozBoxSizing="border-box":mb?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"):(c=b.style,a?(J?(a=Ae(b,"paddingLeft"),e=Ae(b,"paddingRight"),f=Ae(b,"paddingTop"),d=Ae(b,"paddingBottom"),a=new ie(f,e,d,a)):(a=le(b,"paddingLeft"),e=le(b,"paddingRight"),f=le(b,"paddingTop"),d=le(b,"paddingBottom"),a=new ie(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),J?(e=Ce(b,"borderLeft"),f=Ce(b,"borderRight"),d=Ce(b,"borderTop"),b=Ce(b,"borderBottom"),b=new ie(d,f,b,e)):(e=le(b,"borderLeftWidth"),f=le(b,"borderRightWidth"),d=le(b,"borderTopWidth"),b=le(b,"borderBottomWidth"),b=new ie(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height))),h)}function Fg(){}function Gg(a,b){this.bf=a instanceof Vd?a:new Vd(a,b)}function Hg(a,b,c){this.element=a,this.ug=b,this.mj=c}function Ig(a,b){ic.call(this),this.Ab=new kg(this),this.Ef(a||t),b&&(this.Mc=b)}function Jg(a,b){if(a.ve&&a.ve.stop(),a.je&&a.je.stop(),b){if(!a.Ha&&a.rf()){a.D||m(Error("Caller must call setElement before trying to show the popup")),a.lb();var c=Zd(a.D);if(a.ti&&mg(a.Ab,c,"keydown",a.Li,q),a.Ph)if(mg(a.Ab,c,"mousedown",a.Tg,q),J){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f,d=c.activeElement}mg(a.Ab,c,"mousedown",a.Tg,q),mg(a.Ab,c,"deactivate",a.Sg)}else mg(a.Ab,c,"blur",a.Sg);"toggle_display"==a.Mc?(a.D.style.visibility="visible",ye(a.D,q)):"move_offscreen"==a.Mc&&a.lb(),a.Ha=q,a.ve?($b(a.ve,"end",a.Wg,u,a),a.ve.play()):a.Wg()}}else Kg(a)}function Kg(a,b){return a.Ha&&a.dispatchEvent({type:"beforehide",target:b})?(a.Ab&&a.Ab.Df(),a.Ha=u,a.Lg=xa(),a.je?($b(a.je,"end",wa(a.tg,b),u,a),a.je.play()):a.tg(b),q):u}function Lg(a,b){this.qj=4,this.ne=b||p,Ig.call(this,a)}function Mg(a){this.$=new yc,a&&this.Ue(a)}function Ng(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+qa(a):b.substr(0,1)+a}function Og(a,b,c){if(this.Wb=c||(a?Xd($d(a)):Xd()),Lg.call(this,this.Wb.Ic("div",{style:"position:absolute;display:none;"})),this.cf=new Vd(1,1),this.ae=new Mg,a&&Pg(this,a),b!=t)if(a=this.s(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(Zd(a).createTextNode(String(b)))}}function Pg(a,b){b=$d(b),a.ae.add(b),L(b,"mouseover",a.ri,u,a),L(b,"mouseout",a.Ag,u,a),L(b,"mousemove",a.qi,u,a),L(b,"focus",a.pi,u,a),L(b,"blur",a.Ag,u,a)}function Vg(a,b){var c=he(a.Wb);a.cf.x=b.clientX+c.x,a.cf.y=b.clientY+c.y}function Wg(a,b){try{for(;b&&!a.ae.contains(b);)b=b.parentNode;return b}catch(c){return t}}function Ug(a,b){if(0==b){var c=a.cf.l();return new Yg(c)}return new Zg(a.Na)}function Xg(a){if(a.anchor)for(var b,c=0;b=Qg[c];c++)fe(b.s(),a.anchor)&&(b.qg=a,a.Zg=b)}function Sg(a){a.Db&&(ga.clearTimeout(a.Db),a.Db=p)}function Tg(a){2==(a.Db?a.Ha?4:1:a.Kc?3:a.Ha?2:0)&&(a.Kc=yg(va(a.Hi,a,a.anchor),a.si))}function Rg(a){a.Kc&&(ga.clearTimeout(a.Kc),a.Kc=p)}function Yg(a,b){Gg.call(this,a,b)}function Zg(a){Hg.call(this,a,3)}function $g(a,b,c,d){a==t&&m(Error("No valid parent element.")),(!x(b)||!x(c))&&m(Error("Invalid coordinates.")),!(d!=t&&d instanceof Ge||!m(Error("Invalid interactor."))),Og.call(this),this.g="caption",this.Va=a,this.Xd=b,this.Yd=c,this.S=d,this.yb=t,this.ac=[],a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n",a+="  border: 1px solid infotext;\n",a+="  padding: 1px;\n",a+="  font-family: sans-serif;\n",a+="}",this.ac=[a],$b(d,Ad,this.ud.bind(this)),this.hf()}function ah(){zg.call(this),this.g="renderer3D",this.Vc=this.Yc=this.Uc=this.Xc=this.Tc=this.Wc=this.Oe=this.Pe=t,this.A=[0,0,0],this.Nc=[0,0,0],this.gg=t,this.ze=new yc,this.ld=new yc,this.fc=new yc,this.Zc=new yc,this.rc=new yc,this.Bc=new yc,this.ec=new yc,this.Gc=new yc,this.O={PROGRESSBAR_ENABLED:q,PICKING_ENABLED:q,ORDERING_ENABLED:q,STATISTICS_ENABLED:u,INTERMEDIATE_RENDERING:u}}function bh(){Y.call(this),this.g="fibers",Ga(this,new wc)}function ch(){zg.call(this),this.g="renderer2D",this.La=t,this.Ba=-1,this.Pb=[],this.$f=this.Nd=this.Vf=this.Ld=t,this.Cc=this.Ec=this.dd=this.fd=0,this.ha=this.ia=this.ga=this.fa=this.Sf=-1,this.ag=new Float32Array([-255,-255,-255,-255]),this.hg=q}function dh(a){var b=Math.min(a.H/(a.fd*a.Ec),a.v/(a.dd*a.Cc));a.J.n[14]=b}function kh(){Y.call(this),this.g="mesh",Ga(this,new wc)}var p=void 0,q=!0,t=null,u=!1,w,ga=this,ra="closure_uid_"+(1e9*Math.random()>>>0),sa=0,xa=Date.now||function(){return+new Date};ya.prototype={l:function(){return new ya(this.Ra,this.Sa,this.Ta)},Xb:function(a){return this.Ra*a.x()+this.Sa*a.y()+this.Ta*a.d()},ke:function(a,b){return Aa(this,Ba(Ca(a,this),b))},length:function(){return Math.sqrt(this.Xb(this))},ic:function(a){return new ya(this.Sa*a.d()-this.Ta*a.y(),this.Ta*a.x()-this.Ra*a.d(),this.Ra*a.y()-this.Sa*a.x())},x:v("Ra"),y:v("Sa"),d:v("Ta")};var D=D||{};D.Nj=q,D.Ya=function(a){eval("X.DEV === undefined")||window.console.time(a)},D.Ua=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)},window["X.counter"]=new function(){this.Eh=0,this.Jj=function(){return this.Eh++}};var Ha=window.th;Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!=typeof this&&m(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;return c.prototype=this.prototype,b.prototype=new c,b});for(var Ia=0,Ja=["ms","moz","webkit","o"],Ka=0;Ka<Ja.length&&!window.requestAnimationFrame;++Ka)window.requestAnimationFrame=window[Ja[Ka]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ja[Ka]+"CancelAnimationFrame"]||window[Ja[Ka]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ia)),d=window.setTimeout(function(){a(b+c)},c);return Ia=b+c,d}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===p&&m(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a),0>c&&(c=this.byteLength+c),a>c&&(c=a=0),0>a&&(a=0),0>c&&(c=0),a>this.byteLength&&(a=this.byteLength),c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;c>g;++g,++h)f[h]=e[g];return d}),B("$",Ha),B("Function.prototype.bind",Function.prototype.bind),B("window.requestAnimationFrame",window.requestAnimationFrame),B("window.cancelAnimationFrame",window.cancelAnimationFrame);var La=0;w=Ma.prototype,w.key=0,w.mc=u,w.Zd=u,w.wa=function(a,b,c,d,e,f){oa(a)?this.Jg=q:a&&a.handleEvent&&oa(a.handleEvent)?this.Jg=u:m(Error("Invalid listener argument")),this.Yb=a,this.$g=b,this.src=c,this.type=d,this.capture=!!e,this.gf=f,this.Zd=u,this.key=++La,this.mc=u},w.handleEvent=function(a){return this.Jg?this.Yb.call(this.gf||this.src,a):this.Yb.handleEvent.call(this.Yb,a)};var Pa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ua=/&/g,Va=/</g,Wa=/>/g,Xa=/\"/g,Ta=/[&<>\"]/,Ya,Za,$a,ab,bb,cb,eb;ab=$a=Za=Ya=u;var hb;if(hb=fb()){var ib=gb();Ya=0==hb.indexOf("Opera"),Za=!Ya&&-1!=hb.indexOf("MSIE"),$a=!Ya&&-1!=hb.indexOf("WebKit"),ab=!Ya&&!$a&&"Gecko"==ib.product}var jb=Ya,J=Za,lb=ab,mb=$a,ob,pb=gb();ob=pb&&pb.platform||"",bb=-1!=ob.indexOf("Mac"),cb=-1!=ob.indexOf("Win"),eb=-1!=ob.indexOf("Linux");var qb=!!gb()&&-1!=(gb().appVersion||"").indexOf("X11"),vb;a:{var wb="",xb;if(jb&&ga.opera)var yb=ga.opera.version,wb="function"==typeof yb?yb():yb;else if(lb?xb=/rv\:([^\);]+)(\)|;)/:J?xb=/MSIE\s+([^\);]+)(\)|;)/:mb&&(xb=/WebKit\/(\S+)/),xb)var zb=xb.exec(fb()),wb=zb?zb[1]:"";if(J){var Ab=rb();if(Ab>parseFloat(wb)){vb=String(Ab);break a}}vb=wb}var Bb={},Db=ga.document,Eb=Db&&J?rb()||("CSS1Compat"==Db.compatMode?parseInt(vb,10):5):p,Fb=!J||J&&Eb>=9,Gb=J&&!Cb("9");!mb||Cb("528"),lb&&Cb("1.9b")||J&&Cb("8")||jb&&Cb("9.5")||mb&&Cb("528"),lb&&!Cb("8")||J&&Cb("9");var Hb=Array.prototype,Ib=Hb.indexOf?function(a,b,c){return Hb.indexOf.call(a,b,c)}:function(a,b,c){if(c=c==t?0:0>c?Math.max(0,a.length+c):c,na(a))return na(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Jb=Hb.forEach?function(a,b,c){Hb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=na(a)?a.split(""):a,f=0;d>f;f++)f in e&&b.call(c,e[f],f,a)},Lb=Hb.map?function(a,b,c){return Hb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=na(a)?a.split(""):a,g=0;d>g;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Mb=Hb.some?function(a,b,c){return Hb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=na(a)?a.split(""):a,f=0;d>f;f++)if(f in e&&b.call(c,e[f],f,a))return q;return u},Qb=0;w=Rb.prototype,w.lc=u,w.defaultPrevented=u,w.oe=q,w.stopPropagation=function(){this.lc=q
},w.preventDefault=function(){this.defaultPrevented=q,this.oe=u},Sb[" "]=ha,C(Tb,Rb),w=Tb.prototype,w.target=t,w.relatedTarget=t,w.offsetX=0,w.offsetY=0,w.clientX=0,w.clientY=0,w.screenX=0,w.screenY=0,w.button=0,w.keyCode=0,w.charCode=0,w.ctrlKey=u,w.altKey=u,w.shiftKey=u,w.metaKey=u,w.pj=u,w.jb=t,w.wa=function(a,b){var c=this.type=a.type;Rb.call(this,c),this.target=a.target||a.srcElement,this.currentTarget=b;var d=a.relatedTarget;if(d){if(lb){var e;a:{try{Sb(d.nodeName),e=q;break a}catch(f){}e=u}e||(d=t)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d,this.offsetX=mb||a.offsetX!==p?a.offsetX:a.layerX,this.offsetY=mb||a.offsetY!==p?a.offsetY:a.layerY,this.clientX=a.clientX!==p?a.clientX:a.pageX,this.clientY=a.clientY!==p?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0,this.button=a.button,this.keyCode=a.keyCode||0,this.charCode=a.charCode||("keypress"==c?a.keyCode:0),this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pj=bb?a.metaKey:a.ctrlKey,this.state=a.state,this.jb=a,a.defaultPrevented&&this.preventDefault(),delete this.lc},w.stopPropagation=function(){Tb.z.stopPropagation.call(this),this.jb.stopPropagation?this.jb.stopPropagation():this.jb.cancelBubble=q},w.preventDefault=function(){Tb.z.preventDefault.call(this);var a=this.jb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=u,Gb)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}},w.ki=v("jb");var Ub={},Vb={},Wb={},Xb={},gc=0;if(C(ic,Pb),ic.prototype.customEvent_=q,w=ic.prototype,w.Af=t,w.Ff=fa("Af"),w.addEventListener=function(a,b,c,d){L(this,a,b,c,d)},w.removeEventListener=function(a,b,c,d){ac(this,a,b,c,d)},w.dispatchEvent=function(a){var b=a.type||a,c=Vb;if(b in c){if(na(a))a=new Rb(a,this);else if(a instanceof Rb)a.target=a.target||this;else{var d=a;a=new Rb(b,this),Ra(a,d)}var e,f,d=1,c=c[b],b=q in c;if(b){for(e=[],f=this;f;f=f.Af)e.push(f);f=c[q],f.Ia=f.ja;for(var g=e.length-1;!a.lc&&g>=0&&f.Ia;g--)a.currentTarget=e[g],d&=ec(f,e[g],a.type,q,a)&&a.oe!=u}if(u in c)if(f=c[u],f.Ia=f.ja,b)for(g=0;!a.lc&&g<e.length&&f.Ia;g++)a.currentTarget=e[g],d&=ec(f,e[g],a.type,u,a)&&a.oe!=u;else for(e=this;!a.lc&&e&&f.Ia;e=e.Af)a.currentTarget=e,d&=ec(f,e,a.type,u,a)&&a.oe!=u;a=Boolean(d)}else a=q;return a},C(O,ic),O.prototype.__defineGetter__("classname",v("g")),O.prototype.__defineGetter__("id",v("ta")),B("X.base",O),jc.prototype={l:function(){return new jc(this.Qa.l(),this.ra.l())},kc:function(){this.ra=Fa(this.ra)}},kc.prototype={l:function(){return new kc(this.ra.l(),this.Cd)},kc:function(){this.ra=Fa(this.ra),this.Cd=-this.Cd}},lc.prototype={l:function(){var a=this.Eb.map(function(a){return a.l()});return new lc(a,this.ue)},kc:function(){this.Eb.reverse().map(function(a){a.kc()}),this.Pa.kc()}},nc.prototype={l:function(){var a=new nc,b=this.Pa&&this.Pa.l();return a.Pa=b,b=this.va&&this.va.l(),a.va=b,b=this.ua&&this.ua.l(),a.ua=b,a.te(this.V.map(function(a){return a.l()})),a},U:function(){for(var a=0;a<this.V.length;a++)this.V[a].kc();this.Pa.kc(),this.va&&this.va.U(),this.ua&&this.ua.U(),a=this.va,this.va=this.ua,this.ua=a},te:fa("V")},sc.prototype={l:function(){var a=new sc;return a.te(this.V.map(function(a){return a.l()})),a},Mf:function(a){var b=new nc(this.l().V);return a=new nc(a.l().V),qc(b,a),qc(a,b),a.U(),qc(a,b),a.U(),oc(b,pc(a)),tc(pc(b))},Ea:function(a){var b=new nc(this.l().V);return a=new nc(a.l().V),b.U(),qc(b,a),qc(a,b),a.U(),qc(a,b),a.U(),oc(b,pc(a)),b.U(),tc(pc(b))},jf:function(a){var b=new nc(this.l().V);return a=new nc(a.l().V),b.U(),qc(a,b),a.U(),qc(b,a),qc(a,b),oc(b,pc(a)),b.U(),tc(pc(b))},inverse:function(){var a=this.l();return a.V.map(function(a){a.kc()}),a},te:fa("V")},C(uc,O),uc.prototype.add=function(a){a==t&&m(Error("Invalid object."));var b=window.JSON.stringify(a);return b in this.Fa||(this.Fa[b]=this.Se.length,this.Se.push(a)),this.Fa[b]},uc.prototype.unique=v("Se"),C(vc,O),wc.prototype.__defineSetter__("file",function(a){if(a==t||la(a)&&0==a.length)this.r=t;else{if(la(a)){if(1==a.length)return this.r=new vc(a[0]),void 0;this.r=Lb(a,function(a){var b=new Q;return b.r=new vc(a),b})}else this.r=new vc(a);this.mb=t}}),wc.prototype.__defineGetter__("file",function(){return this.r?la(this.r)?this.r.map(function(a){return a.r.Sd}):this.r.Sd:""}),wc.prototype.__defineGetter__("filedata",function(){return la(this.r)?this.r.map(function(a){return a.mb}):this.mb}),wc.prototype.__defineSetter__("filedata",function(a){if((a==t||la(a)&&0==a.length)&&(this.mb=t),la(a))if(1==a.length)this.mb=a[0];else{var b,c=this.r.length;for(b=0;c>b;b++)this.r[b].mb=a[b]}else this.mb=a}),w=yc.prototype,w.ja=0,w.Of=0,w.ee=v("ja"),w.sd=function(){zc(this);for(var a=[],b=0;b<this.Q.length;b++)a.push(this.$[this.Q[b]]);return a},w.clear=function(){this.$={},this.Of=this.ja=this.Q.length=0},w.remove=function(a){return Bc(this.$,a)?(delete this.$[a],this.ja--,this.Of++,this.Q.length>2*this.ja&&zc(this),q):u},w.get=function(a,b){return Bc(this.$,a)?this.$[a]:b},w.set=function(a,b){Bc(this.$,a)||(this.ja++,this.Q.push(a),this.Of++),this.$[a]=b},w.Ue=function(a){var b;if(a instanceof yc)zc(a),b=a.Q.concat(),a=a.sd();else{b=[];var c,d=0;for(c in a)b[d++]=c;a=Oa(a)}for(d=0;d<b.length;d++)this.set(b[d],a[d])},w.l=function(){return new yc(this)},w.Lf=function(){for(var a=new yc,b=0;b<this.Q.length;b++){var c=this.Q[b];a.set(this.$[c],c)}return a},C(Cc,O),Cc.prototype.add=function(a,b,c,d,e,f){!(x(a)&&x(c)&&x(d)&&x(e)&&x(f)||!m(Error("Invalid color table entry."))),this.Fa.set(a,[b,c,d,e,f]),this.j=q},Cc.prototype.get=function(a){return this.Fa.get(a)},B("X.colortable.prototype.get",Cc.prototype.get),Dc.prototype.l=function(){return new Dc(this.x,this.y,this.d)},C(U,Dc),w=U.prototype,w.l=function(){return new U(this.x,this.y,this.d)},w.Bb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.d*this.d)},w.scale=function(a){return this.x*=a,this.y*=a,this.d*=a,this},w.U=function(){return this.x=-this.x,this.y=-this.y,this.d=-this.d,this},w.normalize=function(){return this.scale(1/this.Bb())},w.add=function(a){return this.x+=a.x,this.y+=a.y,this.d+=a.d,this},w.Ea=function(a){return this.x-=a.x,this.y-=a.y,this.d-=a.d,this},D.m=U,w=D.m.prototype,w.l=U.prototype.l,w.Bb=U.prototype.Bb,w.scale=U.prototype.scale,w.U=U.prototype.U,w.add=U.prototype.add,w.Ea=U.prototype.Ea,w.normalize=function(){var a=this.Bb();return 0==a?this.scale(0):this.scale(1/a)},D.m.Xb=function(a,b){return a.x*b.x+a.y*b.y+a.d*b.d},D.m.ic=Hc,D.m.ff=Ec,D.m.ke=function(a,b,c){return new U(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y),a.d+c*(b.d-a.d))},D.m.prototype.__defineGetter__("xx",v("x")),D.m.prototype.__defineGetter__("yy",v("y")),D.m.prototype.__defineGetter__("zz",v("d")),B("X.vector",D.m),B("X.vector.prototype.clone",D.m.prototype.l),B("X.vector.prototype.magnitude",D.m.prototype.Bb),B("X.vector.prototype.scale",D.m.prototype.scale),B("X.vector.prototype.invert",D.m.prototype.U),B("X.vector.prototype.normalize",D.m.prototype.normalize),B("X.vector.prototype.add",D.m.prototype.add),B("X.vector.prototype.subtract",D.m.prototype.Ea),B("X.vector.dot",D.m.Xb),B("X.vector.cross",D.m.ic),B("X.vector.distance",D.m.ff),B("X.vector.lerp",D.m.ke),Ic.prototype.BYTES_PER_ELEMENT=8,Ic.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]},Ic.prototype.toString=Array.prototype.join,"undefined"==typeof Float64Array){try{Ic.BYTES_PER_ELEMENT=8}catch(Jc){}Ic.prototype.BYTES_PER_ELEMENT=Ic.prototype.BYTES_PER_ELEMENT,Ic.prototype.set=Ic.prototype.set,Ic.prototype.toString=Ic.prototype.toString,B("Float64Array",Ic)}Kc.prototype.BYTES_PER_ELEMENT=4,Kc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]},Kc.prototype.toString=Array.prototype.join,"undefined"==typeof Float32Array&&(Kc.BYTES_PER_ELEMENT=4,Kc.prototype.BYTES_PER_ELEMENT=Kc.prototype.BYTES_PER_ELEMENT,Kc.prototype.set=Kc.prototype.set,Kc.prototype.toString=Kc.prototype.toString,B("Float32Array",Kc)),new Float64Array(3),new Float64Array(3),new Float64Array(4),new Float64Array(4),new Float64Array(4),new Float64Array(16),D.f={},D.f.Mg=function(a,b,c,d){c=c.Ea(b),c.normalize(),d=D.m.ic(c,d),d.normalize();var e=D.m.ic(d,c);return e.normalize(),c.U(),V(a,0,d.x,d.y,d.d,0),V(a,1,e.x,e.y,e.d,0),V(a,2,c.x,c.y,c.d,0),bd(a,-b.x,-b.y,-b.d),a},D.f.X=function(a,b,c,d){var e=1/(b*a[3]+c*a[7]+d*a[11]+a[15]);return new D.m((b*a[0]+c*a[4]+d*a[8]+a[12])*e,(b*a[1]+c*a[5]+d*a[9]+a[13])*e,(b*a[2]+c*a[6]+d*a[10]+a[14])*e)},D.f.Hj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);return Xc(a,b,d),Xc(a,c,e),Wc(a,b,e),Wc(a,c,d),a},D.f.Gj=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);return Vc(a,b,d),Vc(a,c,e),Uc(a,b,e),Uc(a,c,d),a},D.f.td=Rc,D.f.l=function(a){var b=Qc();return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},D.f.Lf=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=c,b[6]=a[9],b[7]=a[13],b[8]=d,b[9]=f,b[11]=a[14],b[12]=e,b[13]=g,b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b},D.f.$h=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14];return a=a[15],(b*g-c*f)*(l*a-m*p)-(b*h-d*f)*(k*a-m*o)+(b*i-e*f)*(k*p-l*o)+(c*h-d*g)*(j*a-m*n)-(c*i-e*g)*(j*p-l*n)+(d*i-e*h)*(j*o-k*n)},D.f.U=Zc,D.f.mf=function(a,b,c,d,e){var f=b/2;b=e-d;var g=Math.sin(f);return 0==b||0==g||0==c?a:(f=Math.cos(f)/g,Sc(a,f/c,0,0,0,0,f,0,0,0,0,-(e+d)/b,-1,0,0,-(2*d*e)/b,0))},D.f.Fi=function(a,b,c,d,e,f,g){return Sc(a,2*f/(c-b),0,0,0,0,2*f/(e-d),0,0,(c+b)/(c-b),(e+d)/(e-d),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)},D.f.Gi=function(a,b,c,d,e,f,g){return Sc(a,2/(c-b),0,0,0,0,2/(e-d),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(e+d)/(e-d),-(g+f)/(g-f),1)},D.f.multiply=Yc,D.f.Qg=ad,D.f.translate=bd,D.f.scale=function(a,b,c,d){return Sc(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])},D.f.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],i=a[3],j=a[4],k=a[5],l=a[6],m=a[7],n=a[8],o=a[9],p=a[10],q=a[11],r=Math.cos(b),s=Math.sin(b),t=1-r;b=c*c*t+r;var u=c*d*t+e*s,v=c*e*t-d*s,w=c*d*t-e*s,x=d*d*t+r,y=d*e*t+c*s,z=c*e*t+d*s;return c=d*e*t-c*s,e=e*e*t+r,Sc(a,f*b+j*u+n*v,g*b+k*u+o*v,h*b+l*u+p*v,i*b+m*u+q*v,f*w+j*x+n*y,g*w+k*x+o*y,h*w+l*x+p*y,i*w+m*x+q*y,f*z+j*c+n*e,g*z+k*c+o*e,h*z+l*c+p*e,i*z+m*c+q*e,a[12],a[13],a[14],a[15])},D.f.pe=function(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],i=a[10],j=a[11],k=Math.cos(b),l=Math.sin(b);return a[4]=c*k+g*l,a[5]=d*k+h*l,a[6]=e*k+i*l,a[7]=f*k+j*l,a[8]=c*-l+g*k,a[9]=d*-l+h*k,a[10]=e*-l+i*k,a[11]=f*-l+j*k,a},D.f.qe=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],i=a[10],j=a[11],k=Math.cos(b),l=Math.sin(b);return a[0]=c*k+g*-l,a[1]=d*k+h*-l,a[2]=e*k+i*-l,a[3]=f*k+j*-l,a[8]=c*l+g*k,a[9]=d*l+h*k,a[10]=e*l+i*k,a[11]=f*l+j*k,a},D.f.re=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=Math.cos(b),l=Math.sin(b);return a[0]=c*k+g*l,a[1]=d*k+h*l,a[2]=e*k+i*l,a[3]=f*k+j*l,a[4]=c*-l+g*k,a[5]=d*-l+h*k,a[6]=e*-l+i*k,a[7]=f*-l+j*k,a},B("X.matrix.identity",D.f.td),B("X.matrix.clone",D.f.l),B("X.matrix.transpose",D.f.Lf),B("X.matrix.determinant",D.f.$h),B("X.matrix.invert",D.f.U),B("X.matrix.multiply",D.f.multiply),B("X.matrix.multiplyByVector",D.f.X),B("X.matrix.multiplyByVec4",D.f.Qg),B("X.matrix.makePerspective",D.f.mf),B("X.matrix.makeFrustum",D.f.Fi),B("X.matrix.makeOrtho",D.f.Gi),B("X.matrix.makeLookAt",D.f.Mg),B("X.matrix.translate",D.f.translate),B("X.matrix.scale",D.f.scale),B("X.matrix.rotate",D.f.rotate),B("X.matrix.rotateX",D.f.pe),B("X.matrix.rotateY",D.f.qe),B("X.matrix.rotateZ",D.f.re),B("X.matrix.swapRows",D.f.Hj),B("X.matrix.swapCols",D.f.Gj),C(cd,O),cd.prototype.__defineGetter__("matrix",v("N")),cd.prototype.__defineSetter__("matrix",function(a){!(a!=t&&a instanceof Float32Array||!m(Error("Invalid matrix."))),this.N=a,this.p()}),w=cd.prototype,w.pe=function(a){(!x(a)||-360>a||a>360)&&m(Error("Invalid angle.")),D.f.pe(this.N,a*Math.PI/180),this.p()},w.qe=function(a){(!x(a)||-360>a||a>360)&&m(Error("Invalid angle.")),D.f.qe(this.N,a*Math.PI/180),this.p()},w.re=function(a){(!x(a)||-360>a||a>360)&&m(Error("Invalid angle.")),D.f.re(this.N,a*Math.PI/180),this.p()},w.nh=function(a){x(a)||m(Error("Invalid distance.")),D.f.translate(this.N,a,0,0),this.p()},w.oh=function(a){x(a)||m(Error("Invalid distance.")),D.f.translate(this.N,0,a,0),this.p()},w.ph=function(a){x(a)||m(Error("Invalid distance.")),D.f.translate(this.N,0,0,a),this.p()},w.gi=function(){dd(this,0,0)},w.hi=function(){dd(this,1,1)},w.ii=function(){dd(this,2,2)},w.p=function(){this.j=q},B("X.transform",cd),B("X.transform.prototype.rotateX",cd.prototype.pe),B("X.transform.prototype.rotateY",cd.prototype.qe),B("X.transform.prototype.rotateZ",cd.prototype.re),B("X.transform.prototype.translateX",cd.prototype.nh),B("X.transform.prototype.translateY",cd.prototype.oh),B("X.transform.prototype.translateZ",cd.prototype.ph),B("X.transform.prototype.flipX",cd.prototype.gi),B("X.transform.prototype.flipY",cd.prototype.hi),B("X.transform.prototype.flipZ",cd.prototype.ii),B("X.transform.prototype.modified",cd.prototype.p),C(ed,O),ed.prototype.__defineSetter__("rawData",function(a){this.Tb=a,this.j=q}),ed.prototype.__defineSetter__("rawDataHeight",function(a){this.Me=a,this.j=q}),ed.prototype.__defineSetter__("rawDataWidth",function(a){this.Ne=a,this.j=q}),ed.prototype.__defineSetter__("grayscale",function(a){this.Xf=a,this.j=q}),B("X.texture",ed),C(W,O),w=W.prototype,w.add=function(a,b,c){return this.eb=Math.min(this.eb,a),this.$a=Math.max(this.$a,a),this.fb=Math.min(this.fb,b),this.ab=Math.max(this.ab,b),this.gb=Math.min(this.gb,c),this.bb=Math.max(this.bb,c),this.Hd=[(this.eb+this.$a)/2,(this.fb+this.ab)/2,(this.gb+this.bb)/2],this.Wf=u,this.j=q,this.Y[this.R++]=a,this.Y[this.R++]=b,this.Y[this.R++]=c,this.R/3},w.Cb=function(){if(this.R!=this.Y.length){var a=new Float32Array(this.R);a.set(this.Y.subarray(0,this.R)),this.Y=a}},w.get=function(a){return a*=3,[this.Y[a],this.Y[a+1],this.Y[a+2]]},w.remove=function(){m(Error("Not implemented."))},w.clear=function(){this.Y=new Float32Array(this.Y.length),this.j=q},W.prototype.__defineGetter__("count",function(){return this.Cb(),this.Y.length/3}),W.prototype.__defineGetter__("length",function(){return this.Cb(),this.Y.length}),B("X.triplets",W),B("X.triplets.prototype.add",W.prototype.add),B("X.triplets.prototype.resize",W.prototype.Cb),B("X.triplets.prototype.get",W.prototype.get),B("X.triplets.prototype.remove",W.prototype.remove),B("X.triplets.prototype.clear",W.prototype.clear);var gd="TRIANGLES";fd.prototype.__defineSetter__("type",function(a){return this.Da=a}),fd.prototype.__defineGetter__("type",v("Da")),fd.prototype.__defineGetter__("texture",function(){return this.C||(this.C=new ed),this.C}),fd.prototype.__defineGetter__("transform",v("ca")),fd.prototype.__defineGetter__("points",v("h")),fd.prototype.__defineSetter__("points",fa("h")),fd.prototype.__defineGetter__("normals",v("q")),fd.prototype.__defineSetter__("normals",fa("q")),fd.prototype.__defineGetter__("colors",v("la")),fd.prototype.__defineSetter__("colors",fa("la")),fd.prototype.__defineGetter__("color",v("u")),fd.prototype.__defineSetter__("color",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid color."));for(var b=this.c,c=b.length,d=0,d=0;c>d;d++)b[d].color=a;this.u=a,this.j=q}),fd.prototype.__defineGetter__("opacity",v("qa")),fd.prototype.__defineSetter__("opacity",function(a){(!x(a)||a>1||0>a)&&m(Error("Invalid opacity."));for(var b=this.c,c=b.length,d=0,d=0;c>d;d++)b[d]!=t&&(b[d].opacity=a);this.qa=a,this.j=q}),fd.prototype.__defineGetter__("caption",v("qc")),fd.prototype.__defineSetter__("caption",function(a){this.qc=a,this.j=q}),fd.prototype.__defineGetter__("visible",v("L")),fd.prototype.__defineSetter__("visible",function(a){for(var b=this.c,c=b.length,d=0,d=0;c>d;d++)b[d]!=t&&(b[d].visible=a);this.L=a,this.j=q}),fd.prototype.__defineGetter__("pointsize",v("ad")),fd.prototype.__defineSetter__("pointsize",function(a){x(a)||m(Error("Invalid point size.")),this.ad=a,this.j=q}),fd.prototype.__defineGetter__("magicmode",v("Sc")),fd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&m(Error("Invalid magic mode setting.")),this.Sc=a,this.j=q}),fd.prototype.__defineGetter__("linewidth",v("zc")),fd.prototype.__defineSetter__("linewidth",function(a){x(a)||m(Error("Invalid line width.")),this.zc=a,this.j=q}),fd.prototype.__defineGetter__("pickable",v("$c")),fd.prototype.__defineSetter__("pickable",function(a){"boolean"!=typeof a&&m(Error("Invalid pickable setting.")),this.$c=a,this.j=q}),fd.prototype.__defineGetter__("textureCoordinateMap",v("Fc")),fd.prototype.__defineSetter__("textureCoordinateMap",fa("Hk")),hd.prototype.__defineGetter__("lowerThreshold",v("fa")),hd.prototype.__defineSetter__("lowerThreshold",fa("fa")),hd.prototype.__defineGetter__("upperThreshold",v("ga")),hd.prototype.__defineSetter__("upperThreshold",fa("ga")),hd.prototype.__defineGetter__("min",v("cb")),hd.prototype.__defineGetter__("max",v("ma")),hd.prototype.__defineGetter__("minColor",v("Ob")),hd.prototype.__defineSetter__("minColor",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid min. color.")),this.Ob=a}),hd.prototype.__defineGetter__("maxColor",v("Mb")),hd.prototype.__defineSetter__("maxColor",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid max. color.")),this.Mb=a}),C(id,O),id.prototype.__defineGetter__("array",v("F")),id.prototype.__defineSetter__("array",function(a){this.Pc=this.F=a,this.j=q}),id.prototype.__defineGetter__("interpolation",v("Be")),id.prototype.__defineSetter__("interpolation",fa("Be")),B("X.scalars",id),C(Y,O),Y.prototype.gc=function(a){this.Da=a.Da,this.ca=new cd,this.ca.N=new Float32Array(a.ca.N),this.u=a.u.slice(),a.h&&(this.h=new W(a.h.length,a.h)),a.q&&(this.q=new W(a.q.length,a.q)),a.la&&(this.la=new W(a.la.length,a.la)),this.C=a.C,this.Fc=a.Fc,a.r&&(this.r=new vc(new String(a.r.Sd).toString())),this.qa=a.qa,this.c.length=0;var b=a.c;if(b)for(var c=b.length,d=0,d=0;c>d;d++)this.c.push(new D[b[d].g](b[d]));this.L=a.L,this.ad=a.ad,this.zc=a.zc,a.qc&&(this.qc=new String(a.qc).toString()),this.Sc=a.Sc,this.$c=a.$c,this.Ac=a.Ac.slice(),this.j=q},Y.prototype.__defineGetter__("colortable",function(){return this.Aa||(this.Aa=new Cc),this.Aa}),Y.prototype.__defineGetter__("scalars",function(){return this.G||(this.G=new id),this.G}),Y.prototype.__defineGetter__("children",v("c")),Y.prototype.p=function(){var a=new jd;a.K=this,this.dispatchEvent(a)},Y.prototype.remove=function(){var a=new kd;a.K=this,this.dispatchEvent(a)},B("X.object",Y),B("X.object.prototype.modified",Y.prototype.p),B("X.object.prototype.remove",Y.prototype.remove),md.prototype.Mf=function(a){!(a!=t&&(a instanceof sc||a instanceof Y)||!m(Error("Invalid object.")));var b=a;return a instanceof Y&&(b=nd(b)),a=new Y,Ga(a,new md),od(a,nd(this).Mf(b)),a},md.prototype.Ea=function(a){!(a!=t&&(a instanceof sc||a instanceof Y)||!m(Error("Invalid object.")));var b=a;return a instanceof Y&&(b=nd(b)),a=new Y,Ga(a,new md),od(a,nd(this).Ea(b)),a},md.prototype.jf=function(a){!(a!=t&&(a instanceof sc||a instanceof Y)||!m(Error("Invalid object.")));var b=a;return a instanceof Y&&(b=nd(b)),a=new Y,Ga(a,new md),od(a,nd(this).jf(b)),a},md.prototype.inverse=function(){var a=new Y;return Ga(a,new md),od(a,nd(this).inverse()),a},B("X.constructable",md),B("X.constructable.prototype.intersect",md.prototype.jf),B("X.constructable.prototype.inverse",md.prototype.inverse),B("X.constructable.prototype.subtract",md.prototype.Ea),B("X.constructable.prototype.union",md.prototype.Mf),C(pd,Rb);var qd=hc("pan"),rd=hc("rotate"),sd=hc("zoom"),td=hc("scroll");hc("render");var ud=hc("resetview"),vd=hc("windowlevel"),wd=hc("modified"),xd=hc("remove"),yd=hc("progress"),zd=hc("hover"),Ad=hc("hover_end"),Bd=hc("computing"),Cd=hc("computing_end"),Dd=hc("computing_progress");C(Ed,pd),C(Fd,pd),C(Gd,pd),C(Hd,pd),C(Id,pd),C(Jd,pd),C(Kd,pd),C(Ld,pd),C(jd,pd),C(kd,pd),C(Md,pd),C(Nd,pd),C(Od,pd),C(Pd,pd),B("X.event.events.PAN",qd),B("X.event.events.ROTATE",rd),B("X.event.events.ZOOM",sd),B("X.event.events.SCROLL",td),C(Qd,O);var Rd;w=Td.prototype,w.l=function(){return new Td(this.width,this.height)},w.ceil=function(){return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},w.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},w.round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},w.scale=function(a,b){var c=x(b)?b:a;return this.width*=a,this.height*=c,this};var Ud=!J||J&&Eb>=9;!lb&&!J||J&&J&&Eb>=9||lb&&Cb("1.9.1"),J&&Cb("9"),w=Vd.prototype,w.l=function(){return new Vd(this.x,this.y)},w.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},w.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},w.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},w.translate=function(a,b){return a instanceof Vd?(this.x+=a.x,this.y+=a.y):(this.x+=a,x(b)&&(this.y+=b)),this},w.scale=function(a,b){var c=x(b)?b:a;return this.x*=a,this.y*=c,this};var ae={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};w=Yd.prototype,w.fe=Xd,w.s=function(a){return na(a)?this.da.getElementById(a):a},w.th=Yd.prototype.s,w.Ic=function(){return ce(this.da,arguments)},w.createElement=function(a){return this.da.createElement(a)},w.createTextNode=function(a){return this.da.createTextNode(String(a))},w.appendChild=function(a,b){a.appendChild(b)},w.contains=fe,w=ie.prototype,w.l=function(){return new ie(this.top,this.right,this.bottom,this.left)},w.contains=function(a){return this&&a?a instanceof ie?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:u},w.ceil=function(){return this.top=Math.ceil(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this.left=Math.ceil(this.left),this},w.floor=function(){return this.top=Math.floor(this.top),this.right=Math.floor(this.right),this.bottom=Math.floor(this.bottom),this.left=Math.floor(this.left),this},w.round=function(){return this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this.left=Math.round(this.left),this},w.translate=function(a,b){return a instanceof Vd?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,x(b)&&(this.top+=b,this.bottom+=b)),this},w.scale=function(a,b){var c=x(b)?b:a;return this.left*=a,this.right*=a,this.top*=c,this.bottom*=c,this},w=je.prototype,w.l=function(){return new je(this.left,this.top,this.width,this.height)},w.Ig=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(c>=b){var d=Math.max(this.top,a.top);if(a=Math.min(this.top+this.height,a.top+a.height),a>=d)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,q}return u},w.contains=function(a){return a instanceof je?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height},w.ff=function(a){return Math.sqrt(ke(this,a))},w.ceil=function(){return this.left=Math.ceil(this.left),this.top=Math.ceil(this.top),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},w.floor=function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},w.round=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.width=Math.round(this.width),this.height=Math.round(this.height),this},w.translate=function(a,b){return a instanceof Vd?(this.left+=a.x,this.top+=a.y):(this.left+=a,x(b)&&(this.top+=b)),this},w.scale=function(a,b){var c=x(b)?b:a;return this.left*=a,this.width*=a,this.top*=c,this.height*=c,this};var Be={thin:2,medium:4,thick:6},ue=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;C(De,ic),De.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.jb,"mousewheel"==a.type?(c=1,(J||mb&&(cb||Cb("532.0")))&&(c=40),d=Ee(-a.wheelDelta,c),ja(a.wheelDeltaX)?(b=Ee(-a.wheelDeltaX,c),c=Ee(-a.wheelDeltaY,c)):c=d):(d=a.detail,d>100?d=3:-100>d&&(d=-3),ja(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d),x(this.Ng)&&(b=Math.min(Math.max(b,-this.Ng),this.Ng)),x(this.Og)&&(c=Math.min(Math.max(c,-this.Og),this.Og)),this.Di&&(b=-b),b=new Fe(d,a,b,c),this.dispatchEvent(b)},C(Fe,Tb),J||mb&&Cb("525"),C(Ge,O),Ge.prototype.__defineGetter__("config",v("O")),Ge.prototype.__defineGetter__("leftButtonDown",v("ob")),Ge.prototype.__defineGetter__("middleButtonDown",v("Nb")),Ge.prototype.__defineGetter__("rightButtonDown",v("Ub")),Ge.prototype.wa=function(){this.O.MOUSEWHEEL_ENABLED?(this.He=new De(this.Ja),this.fg=L(this.He,"mousewheel",this.wd.bind(this))):(bc(this.fg),this.He=t),this.O.MOUSECLICKS_ENABLED?(this.bg=L(this.Ja,"mousedown",this.Pi.bind(this)),this.eg=L(this.Ja,"mouseup",this.Ui.bind(this))):(bc(this.bg),bc(this.eg)),this.Ja.oncontextmenu=this.O.CONTEXTMENU_ENABLED?t:function(){return u},window.onkeydown=this.O.KEYBOARD_ENABLED?this.Ug.bind(this):t,this.O.TOUCH_ENABLED?(this.O.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",function(a){a.preventDefault()},u),this.Lh=L(this.Ja,"touchstart",this.ij.bind(this)),this.Kh=L(this.Ja,"touchmove",this.gj.bind(this)),this.Jh=L(this.Ja,"touchend",this.cj.bind(this))):(bc(this.Lh),bc(this.Kh),bc(this.Jh)),bc(this.cg),bc(this.dg),this.cg=L(this.Ja,"mousemove",this.Ri.bind(this)),this.dg=L(this.Ja,"mouseout",this.Si.bind(this))},Ge.prototype.Pi=function(a){0==a.button?this.ob=q:1==a.button?this.Nb=q:2==a.button&&(this.Ub=q),eval("this.onMouseDown("+this.ob+","+this.Nb+","+this.Ub+")"),He(this),a.preventDefault()},Ge.prototype.Oi=ea(),Ge.prototype.Ui=function(a){0==a.button?this.ob=u:1==a.button?this.Nb=u:2==a.button&&(this.Ub=u),eval("this.onMouseUp("+this.ob+","+this.Nb+","+this.Ub+")"),He(this),a.preventDefault()},Ge.prototype.__defineGetter__("mousePosition",v("pa")),w=Ge.prototype,w.Ti=ea(),w.Si=function(a){this.Qd=u,this.O.KEYBOARD_ENABLED&&(window.onkeydown=t),this.Ub=this.Nb=this.ob=u,He(this),this.Ce=new D.m(0,0,0),a.preventDefault()},w.Qi=ea(),w.ij=function(a){a.preventDefault(),a.wa(a.jb.targetTouches[0],a.currentTarget),eval("this.onTouchStart("+a.clientX+","+a.clientY+")"),this.Qc=new D.m(a.clientX,a.clientY,0),this.mg=setTimeout(this.ej.bind(this,a),500)},w.hj=ea(),w.ej=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")"),a=new Hd,a.nb=q,a.Za=this instanceof Ie,this.dispatchEvent(a),this.Ud=q},w.dj=ea(),w.cj=function(a){a.preventDefault(),eval("this.onTouchEnd()"),Je(this)},w.bj=ea(),w.gj=function(a){a.preventDefault(),this.Ud||Je(this),this.touchmoveEvent=a=a.jb,eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new D.m(c[0],c[1],0);var b=c[0]>3*this.Ja.clientWidth/4,e=c[0]<this.Ja.clientWidth/4,d=c[1]<this.Ja.clientHeight/4,c=c[1]>3*this.Ja.clientHeight/4,c=!(b||e||d||c),d=this.Qc.Ea(a);this.Qc=a.l(),this.Ud?(a=new Fd,5<d.x?d.x=1:-5>d.x&&(d.x=-1),5<d.y?d.y=1:-5>d.y&&(d.y=-1),a.sa=d,this.dispatchEvent(a)):this instanceof Ke&&(b||e)?(a=new Id,a.Z=0>d.y,this.dispatchEvent(a)):(this instanceof Ie||c)&&(d.scale(3),a=new Gd,a.sa=d,this.dispatchEvent(a))}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new D.m(a[0],a[1],0),b=new D.m(b[0],b[1],0),d=Fc(a,b),b=d-this.Kg,this.Kg=d,this.Qc.Ea(a),this.Qc=a.l(),10<Math.abs(b)&&(a=new Hd,a.nb=b>0,a.Za=this instanceof Ie,this.dispatchEvent(a)))},w.fj=ea(),w.Ri=function(a){this.mousemoveEvent=a,eval("this.onMouseMove(this['mousemoveEvent'])"),this.Qd=q,this.O.KEYBOARD_ENABLED&&window.onkeydown==t&&(window.onkeydown=this.Ug.bind(this)),a.preventDefault();var b=a.shiftKey;this.lg=b,this.pa=[a.offsetX,a.offsetY];var c=new D.m(this.pa[0],this.pa[1],0);a=this.Ce.Ea(c),this.Ce=c.l(),this.O.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.Nb||this.ob||this.Ub)&&He(this),this.Md=setTimeout(function(){He(this);var a=new Jd;a.Xd=c.x,a.Yd=c.y,this.dispatchEvent(a),this.Md=t}.bind(this),300)),0!=a.Bb()&&(this.ob&&!b?(b=new Gd,a.scale(3),b.sa=a,this.dispatchEvent(b)):this.Nb||this.ob&&b?(b=new Fd,b.sa=a,this.dispatchEvent(b)):this.Ub&&(b=new Hd,b.nb=0<a.y,b.Za=u,this.dispatchEvent(b)))},w.Vi=ea(),w.wd=function(a){this.mouseWheelEvent=a,eval("this.onMouseWheel(this['mouseWheelEvent'])"),He(this),a.preventDefault()},w.Mi=ea(),w.Ug=function(a){if(this.Qd){this.keyEvent=a,eval("this.onKey(this['keyEvent'])"),He(this);var b=a.altKey,c=a.ctrlKey,e=a.metaKey,d=a.shiftKey,f=a.keyCode;82!=f||b||c||e||d?f>=37&&40>=f&&(a.preventDefault(),d?a=new Fd:b?a=new Hd:(a=new Gd,this instanceof Ke&&(a=new Id)),a&&(c=new D.m(0,0,0),37==f?(c.x=5,a.Z=u,b&&(a.Z=q,a.nb=q,a.Za=u)):39==f?(c.x=-5,a.Z=q,b&&(a.nb=u,a.Za=u)):38==f?(c.y=5,a.Z=q,b&&(a.nb=q,a.Za=q)):40==f&&(c.y=-5,a.Z=u,b&&(a.nb=u,a.Za=q)),a.sa=c,this.dispatchEvent(a))):(a.preventDefault(),a=new Ld,this.dispatchEvent(a))}},B("X.interactor",Ge),B("X.interactor.prototype.init",Ge.prototype.wa),B("X.interactor.prototype.onMouseDown",Ge.prototype.Oi),B("X.interactor.prototype.onMouseUp",Ge.prototype.Ti),B("X.interactor.prototype.onMouseMove",Ge.prototype.Qi),B("X.interactor.prototype.onMouseWheel",Ge.prototype.Vi),B("X.interactor.prototype.onKey",Ge.prototype.Mi),B("X.interactor.prototype.onTouchStart",Ge.prototype.hj),B("X.interactor.prototype.onTouchMove",Ge.prototype.fj),B("X.interactor.prototype.onTouchEnd",Ge.prototype.bj),B("X.interactor.prototype.onTouchHover",Ge.prototype.dj),C(Ke,Ge),Ke.prototype.wd=function(a){Ke.z.wd.call(this,a);var b=new Id;a.Jc==t&&(a.Jc=0),b.Z=0>a.Jc,this.dispatchEvent(b)},C(Le,Y),Le.prototype.gc=function(a){this.A=a.A.slice(),this.tc=a.tc.slice(),this.Z=a.Z.slice(),this.H=a.H,this.v=a.v,this.zb=a.zb,this.e=a.e,this.ub=a.ub,this.pc=a.pc,this.Fh=a.Fh,Le.z.gc.call(this,a)},Le.prototype.__defineSetter__("height",fa("v")),Le.prototype.__defineSetter__("width",fa("H")),Le.prototype.create=function(){this.hc()},Le.prototype.hc=function(){var a=new U(this.tc[0],this.tc[1],this.tc[2]).normalize(),b=new U(this.Z[0],this.Z[1],this.Z[2]),c=new U(this.Td[0],this.Td[1],this.Td[2]),d=new U(this.A[0],this.A[1],this.A[2]),e=Gc(c.l().U().scale(this.H/2),b.l().U().scale(this.v/2)),f=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Gc(c.l().U().scale(this.H/2),b.l().scale(this.v/2)),g=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Gc(c.l().scale(this.H/2),b.l().U().scale(this.v/2)),h=new U(e.x+d.x,e.y+d.y,e.d+d.d),e=Gc(c.l().scale(this.H/2),b.l().scale(this.v/2)),b=new U(e.x+d.x,e.y+d.y,e.d+d.d);this.h=new W(18),this.q=new W(18),this.h.add(f.x,f.y,f.d),this.h.add(g.x,g.y,g.d),this.h.add(h.x,h.y,h.d),this.h.add(h.x,h.y,h.d),this.h.add(b.x,b.y,b.d),this.h.add(g.x,g.y,g.d),this.q.add(a.x,a.y,a.d),this.q.add(a.x,a.y,a.d),this.q.add(a.x,a.y,a.d),this.q.add(a.x,a.y,a.d),this.q.add(a.x,a.y,a.d),this.q.add(a.x,a.y,a.d),this.ub&&(a=new Y,a.h=new W(24),a.q=new W(24),a.h.add(f.x,f.y,f.d),a.h.add(g.x,g.y,g.d),a.h.add(g.x,g.y,g.d),a.h.add(b.x,b.y,b.d),a.h.add(b.x,b.y,b.d),a.h.add(h.x,h.y,h.d),a.h.add(h.x,h.y,h.d),a.h.add(f.x,f.y,f.d),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.u=[this.pc[0],this.pc[1],this.pc[2]],a.Da="LINES",a.zc=2,this.c.push(a))
},B("X.slice",Le),B("X.slice.prototype.create",Le.prototype.create),C(Me,O),Me.prototype.parse=function(){m(Error("The function parse() should be overloaded."))},C(Q,Y),Q.prototype.gc=function(a){this.A=a.A.slice(),this.oa=a.oa.slice(),this.kd=a.kd.slice(),this.vb=a.vb,this.vc=a.vc,this.wb=a.wb,this.wc=a.wc,this.xb=a.xb,this.xc=a.xc,this.Tf=a.Tf.slice(),this.gd=new Y(a.gd),this.hd=new Y(a.hd),this.jd=new Y(a.jd),this.ma=a.ma,this.P=a.P,this.Ma=a.Ma,this.Wd=a.Wd,this.T=a.T,this.e=a.e,this.ub=a.ub,Q.z.gc.call(this,a)},Q.prototype.hc=function(a){this.c.length=0,this.gd.c.length=0,this.hd.c.length=0,this.jd.c.length=0,this.c.push(this.gd),this.c.push(this.hd),this.c.push(this.jd),this.ya=a.Ed,this.ye=a.Fd,this.tb=a.Dd,this.oc=a.Fb,this.yh=a.Gb,this.ma=a.max,this.P=a.data,this.j=q},Q.prototype.p=function(a){if(a="undefined"!=typeof a?a:q,0<this.c.length){if(this.Ma!=this.Wd&&(!this.Ma&&-1!=this.T&&(this.c[this.T].visible=u),this.j=q,this.Wd=this.Ma),!this.L)return;for(var b=0,b=0;3>b;b++){var c=this.c[b],d=0,e=0;if(0==b?(d=this.vb,e=this.vc,this.vc=this.vb):1==b?(d=this.wb,e=this.wc,this.wc=this.wb):2==b&&(d=this.xb,e=this.xc,this.xc=this.xb),this.c[b].c[parseInt(d,10)]==t){var f=Lc();if(f[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*parseInt(d,10),f[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*parseInt(d,10),f[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*parseInt(d,10),this.I){var g=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa);this.e.c[b].c[parseInt(d,10)]=g,this.e.c[b].p(q)}f=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t),this.I&&(f.e=f.C,f.e=this.e.c[b].c[parseInt(d,10)].C),c.c[parseInt(d,10)]=f,this.c[b].p(q)}e=c.c[parseInt(e,10)],this.Ma||(e.visible=u),c=c.c[parseInt(d,10)],c.visible=q,c.qa=1,this.Ma&&(c.c[0].L=u,b!=this.T&&(c.visible=u,c.qa=0))}this.Ma&&-1!=this.T&&We(this,this.T)}a&&Q.z.p.call(this)},Q.prototype.__defineGetter__("dimensions",v("oa")),Q.prototype.__defineGetter__("bbox",v("ka")),Q.prototype.__defineGetter__("range",v("cd")),Q.prototype.__defineGetter__("dimensionsRAS",v("Tf")),Q.prototype.__defineGetter__("volumeRendering",v("Ma")),Q.prototype.__defineSetter__("volumeRendering",function(a){this.Ma=a,this.p(u)}),Q.prototype.__defineGetter__("visible",v("L")),Q.prototype.__defineSetter__("visible",function(a){if(a)this.L=a,this.p(u);else{for(var b=this.c,c=b.length,d=0,d=0;c>d;d++)b[d].visible=a;this.L=a,this.j=q}}),Q.prototype.__defineGetter__("center",v("A")),Q.prototype.__defineSetter__("center",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid center.")),this.A=a}),Q.prototype.__defineGetter__("image",v("Jb")),Q.prototype.__defineGetter__("labelmap",function(){return this.e||(this.e=new Xe(this)),this.e}),Q.prototype.__defineGetter__("indexX",v("vb")),Q.prototype.__defineSetter__("indexX",function(a){x(a)&&a>=0&&a<this.gd.c.length&&(this.vb=a,this.p(u))}),Q.prototype.__defineGetter__("indexY",v("wb")),Q.prototype.__defineSetter__("indexY",function(a){x(a)&&a>=0&&a<this.hd.c.length&&(this.wb=a,this.p(u))}),Q.prototype.__defineGetter__("indexZ",v("xb")),Q.prototype.__defineSetter__("indexZ",function(a){x(a)&&a>=0&&a<this.jd.c.length&&(this.xb=a,this.p(u))}),Q.prototype.__defineGetter__("windowLow",v("ia")),Q.prototype.__defineSetter__("windowLow",fa("ia")),Q.prototype.__defineGetter__("windowHigh",v("ha")),Q.prototype.__defineSetter__("windowHigh",fa("ha")),Q.prototype.__defineGetter__("borders",v("ub")),Q.prototype.__defineSetter__("borders",fa("ub")),Q.prototype.__defineGetter__("reslicing",v("kg")),Q.prototype.__defineSetter__("reslicing",fa("kg")),Q.prototype.__defineSetter__("xNormX",function(a){this.b[0].i[0]=a}),Q.prototype.__defineGetter__("xNormX",function(){return this.b[0].i[0]}),Q.prototype.__defineSetter__("xNormY",function(a){this.b[0].i[1]=a}),Q.prototype.__defineGetter__("xNormY",function(){return this.b[0].i[1]}),Q.prototype.__defineSetter__("xNormZ",function(a){this.b[0].i[2]=a}),Q.prototype.__defineGetter__("xNormZ",function(){return this.b[0].i[2]}),Q.prototype.__defineSetter__("xColor",function(a){this.b[0].u=a}),Q.prototype.__defineGetter__("xColor",function(){return this.b[0].u}),Q.prototype.__defineSetter__("yNormX",function(a){this.b[1].i[0]=a}),Q.prototype.__defineGetter__("yNormX",function(){return this.b[1].i[0]}),Q.prototype.__defineSetter__("yNormY",function(a){this.b[1].i[1]=a}),Q.prototype.__defineGetter__("yNormY",function(){return this.b[1].i[1]}),Q.prototype.__defineSetter__("yNormZ",function(a){this.b[1].i[2]=a}),Q.prototype.__defineGetter__("yNormZ",function(){return this.b[1].i[2]}),Q.prototype.__defineSetter__("yColor",function(a){this.b[1].u=a}),Q.prototype.__defineGetter__("yColor",function(){return this.b[1].u}),Q.prototype.__defineSetter__("zNormX",function(a){this.b[2].i[0]=a}),Q.prototype.__defineGetter__("zNormX",function(){return this.b[2].i[0]}),Q.prototype.__defineSetter__("zNormY",function(a){this.b[2].i[1]=a}),Q.prototype.__defineGetter__("zNormY",function(){return this.b[2].i[1]}),Q.prototype.__defineSetter__("zNormZ",function(a){this.b[2].i[2]=a}),Q.prototype.__defineGetter__("zNormZ",function(){return this.b[2].i[2]}),Q.prototype.__defineSetter__("zColor",function(a){this.b[2].u=a}),Q.prototype.__defineGetter__("zColor",function(){return this.b[2].u}),Q.prototype.zj=function(a){this.c[a].visible=u;for(var b=0;b<this.c[a].c.length;b++)"undefined"!=typeof this.c[a].c[b]&&(this.I&&(this.e.c[a].c[b].remove(),this.e.c[a].c[b]=t),this.c[a].c[b].remove(),this.c[a].c[b]=t);Nc(this.b[a].i,this.b[a].i),Se(a,this.b[a].ed,this.b[a].i,this),this.c[a].c=[],this.c[a].c=Array(this.b[a].o),this.I&&(b=Re(this.b[a].ed,this.b[a].Ca,this.b[a].i,this.b[a].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa),this.e.c[a].c=[],this.e.c[a].c=Array(this.b[a].o),this.e.c[a].c[Math.floor(this.b[a].o/2)]=b,this.e.c[a].p()),b=Re(this.b[a].ed,this.b[a].Ca,this.b[a].i,this.b[a].u,this.ka,this.ba,this,q,t),this.I&&(b.e=b.C,b.e=this.e.c[a].c[Math.floor(this.b[a].o/2)].C),this.c[a].c[Math.floor(this.b[a].o/2)]=b,0==a?(this.vb=Math.floor(this.b[a].o/2),this.vc=Math.floor(this.b[a].o/2)):1==a?(this.wb=Math.floor(this.b[a].o/2),this.wc=Math.floor(this.b[a].o/2)):(this.xb=Math.floor(this.b[a].o/2),this.xc=Math.floor(this.b[a].o/2)),this.c[a].p(),this.c[a].c[Math.floor(this.b[a].o/2)].L=q},Q.prototype.sf=ea(),Q.prototype.uf=ea(),Q.prototype.tf=ea(),B("X.volume",Q),B("X.volume.prototype.modified",Q.prototype.p),B("X.volume.prototype.sliceInfoChanged",Q.prototype.zj),B("X.volume.prototype.onComputing",Q.prototype.sf),B("X.volume.prototype.onComputingProgress",Q.prototype.uf),B("X.volume.prototype.onComputingEnd",Q.prototype.tf),C(Ze,Me),Ze.prototype.parse=function(a,b,c){D.Ya(this.g+".parse"),this.P=c;var d=b.h,e=b.q;if("solid"==Oe(Z(this,"uchar",5))){b.h=d=new W(c.byteLength),b.q=e=new W(c.byteLength);var f=d,d=e,e=Z(this,"uchar",c.byteLength-5);c=e.length;var g,h=u,i=u,j=0;for(g=0;c>g;g++)if(10==e[g]){if(h||i){var k=Oe(e,j,g).split(" "),i=parseFloat(k[0]),l=parseFloat(k[1]),k=parseFloat(k[2]);h?(d.add(i,l,k),d.add(i,l,k),d.add(i,l,k)):f.add(i,l,k),i=h=u}}else 32==e[g-1]&&(102==e[g]?(j=g+=13,h=q):118==e[g]&&(j=g+=7,i=q))}else for(this.R=80,f=Z(this,"uint"),b.h=d=new W(9*f),b.q=e=new W(9*f),c=c=0;f>c;c++)h=Z(this,"float",12),j=h[0],g=h[1],i=h[2],e.add(j,g,i),e.add(j,g,i),e.add(j,g,i),d.add(h[3],h[4],h[5]),d.add(h[6],h[7],h[8]),d.add(h[9],h[10],h[11]),this.R+=2;D.Ua(this.g+".parse"),f=new jd,f.K=b,f.B=a,this.dispatchEvent(f)},B("X.parserSTL",Ze),B("X.parserSTL.prototype.parse",Ze.prototype.parse),C($e,Me),$e.prototype.parse=function(a,b,c){if(b.nc={},b.nc.lf=0,this.yd(c,b),b.r.length==t||b.na.length==b.r.length){b.nc.lf=b.r.length;var d={};c={};for(var e=0;e<b.na.length;e++)d.hasOwnProperty(b.na[e].series_instance_uid)||(d[b.na[e].series_instance_uid]=[],c[b.na[e].series_instance_uid]={}),c[b.na[e].series_instance_uid].hasOwnProperty(b.na[e].sop_instance_uid)||(c[b.na[e].series_instance_uid][b.na[e].sop_instance_uid]=q,d[b.na[e].series_instance_uid].push(b.na[e]));var f=Object.keys(d)[0],e=d[f],g=e.length;c={};var h="image_position_patient";if(1==g?(h="image_position_patient",d[f][0].dist=0):e[0].image_position_patient[0]!=e[1].image_position_patient[0]||e[0].image_position_patient[1]!=e[1].image_position_patient[1]||e[0].image_position_patient[2]!=e[1].image_position_patient[2]?(h="image_position_patient",d=new U(e[0].image_orientation_patient[0],e[0].image_orientation_patient[1],e[0].image_orientation_patient[2]),f=new U(e[0].image_orientation_patient[3],e[0].image_orientation_patient[4],e[0].image_orientation_patient[5]),d=Hc(d,f),e.map(function(a,b){return b.dist=b.image_position_patient[0]*a.x+b.image_position_patient[1]*a.y+b.image_position_patient[2]*a.d,b}.bind(t,d)),e.sort(function(a,b){return a.dist-b.dist})):e[0].instance_number!=e[1].instance_number?(h="instance_number",e.sort(function(a,b){return a.instance_number-b.instance_number})):window.console.log("Could not resolve the ordering mode"),isNaN(e[0].pixel_spacing[0])&&(e[0].pixel_spacing[0]=1),isNaN(e[0].pixel_spacing[1])&&(e[0].pixel_spacing[1]=1),g>1)switch(h){case"image_position_patient":var i=e[0].image_position_patient,d=e[1].image_position_patient,f=d[0]-i[0],j=d[1]-i[1],k=d[2]-i[2];e[0].pixel_spacing[2]=Math.sqrt(f*f+j*j+k*k);break;case"instance_number":e[0].pixel_spacing[2]=1;break;default:window.console.log("Unkown ordering mode - returning: "+h)}else e[0].pixel_spacing[2]=1;switch(d=1,h){case"image_position_patient":var i=e[0].image_position_patient,l=e[g-1].image_position_patient,f=l[0]-i[0],j=l[1]-i[1],k=l[2]-i[2],f=Math.sqrt(f*f+j*j+k*k),d=d+Math.round(f/e[0].pixel_spacing[2]);break;case"instance_number":d+=Math.abs(e[g-1].instance_number-e[0].instance_number);break;default:window.console.log("Unkown ordering mode - returning: "+h)}switch(i=e[0].columns*e[0].rows,f=i*d,l=t,e[0].Ve){case 8:l=new Uint8Array(f);break;case 16:l=new Uint16Array(f);break;case 32:l=new Uint32Array(f);default:window.console.log("Unknown number of bits allocated - using default: 32 bits")}b.kd=e[0].pixel_spacing;for(var m=0;g>m;m++){var n=e[m].data,f=0;switch(h){case"image_position_patient":f=e[m].image_position_patient[0]-e[0].image_position_patient[0],j=e[m].image_position_patient[1]-e[0].image_position_patient[1],k=e[m].image_position_patient[2]-e[0].image_position_patient[2],f=Math.sqrt(f*f+j*j+k*k)/e[0].pixel_spacing[2];break;case"instance_number":f=e[m].instance_number-e[0].instance_number;break;default:window.console.log("Unkown ordering mode - returning: "+h)}l.set(n,f*i)}switch(c.data=l,b.P=l,b.oa=[e[0].columns,e[0].rows,d],c.Nk=b.oa,d=Ne(l),g=d[0],d=d[1],c.min=b.cb=b.ia=g,c.max=b.ma=b.ha=d,-1/0==b.fa&&(b.fa=g),1/0==b.ga&&(b.ga=d),j=e[0].image_position_patient,g=Qc(),h){case"image_position_patient":d=new U(e[0].image_orientation_patient[0],e[0].image_orientation_patient[1],e[0].image_orientation_patient[2]),f=new U(e[0].image_orientation_patient[3],e[0].image_orientation_patient[4],e[0].image_orientation_patient[5]),d=Hc(d,f),V(g,0,-e[0].image_orientation_patient[0]*e[0].pixel_spacing[0],-e[0].image_orientation_patient[3]*e[0].pixel_spacing[1],-d.x*e[0].pixel_spacing[2],-j[0]),V(g,1,-e[0].image_orientation_patient[1]*e[0].pixel_spacing[0],-e[0].image_orientation_patient[4]*e[0].pixel_spacing[1],-d.y*e[0].pixel_spacing[2],-j[1]),V(g,2,e[0].image_orientation_patient[2]*e[0].pixel_spacing[0],e[0].image_orientation_patient[5]*e[0].pixel_spacing[1],d.d*e[0].pixel_spacing[2],j[2]),V(g,3,0,0,0,1);break;case"instance_number":V(g,0,-1,0,0,-j[0]),V(g,1,-0,-1,-0,-j[1]),V(g,2,0,0,1,j[2]),V(g,3,0,0,0,1);break;default:window.console.log("Unkown ordering mode - returning: "+h)}c.Fb=g,c.Gb=Qc(),Zc(c.Fb,c.Gb),h=Pc(0,0,0,1),e=Oc(),ad(g,h,e),h=Pc(1,1,1,1),d=Oc(),ad(g,h,d),c.Fd=[d[0]-e[0],d[1]-e[1],d[2]-e[2]],e=Pe(g,[b.oa[0],b.oa[1],b.oa[2]]),c.Dd=[e[1]-e[0]+1,e[3]-e[2]+1,e[5]-e[4]+1],c.Ed=[e[0],e[2],e[4]],b.hc(c),b.Jb=Ve(this,b)}c=new jd,c.K=b,c.B=a,this.dispatchEvent(c)},$e.prototype.yd=function(a,b){this.P=a,("undefined"==typeof b.na||b.na==t)&&(b.na=[]);for(var c={pixel_spacing:[.1,.1,1/0],image_orientation_patient:[1,0,0,0,1,0],image_position_patient:[0,0,0],transfer_syntax_uid:"no_transfer_syntax_uid"},d=Z(this,"ushort",this.P.byteLength),e=66,f=t,g=t,h=t,i=t;e<d.length;)switch(f=d[e++],g=d[e++],h=d[e++],i=d[e++],"1.2.840.10008.1.2"==c.transfer_syntax_uid&&0==i&&(i=h),f){case 2:switch(g){case 16:for(var j="",f=f=0;i/2>f;f++)h=d[e++],g=255&h,h=(65280&h)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);c.transfer_syntax_uid=j.replace(/\0/g,"");break;default:e=af(d,e,h,i)}break;case 40:switch(g){case 16:c.rows=d[e],e+=i/2;break;case 17:c.columns=d[e],e+=i/2;break;case 256:c.Ve=d[e],e+=i/2;break;case 257:c.bits_stored=d[e],e+=i/2;break;case 2:c.number_of_images=d[e],e+=i/2;break;case 48:for(j="",f=0;i/2>f;f++)h=d[e++],g=255&h,h=(65280&h)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\"),c.pixel_spacing=[parseFloat(j[0]),parseFloat(j[1]),1/0];break;default:e=af(d,e,h,i)}break;case 32:switch(g){case 14:for(c.series_instance_uid="",f=0;i/2>f;f++)h=d[e++],g=255&h,h=(65280&h)>>8,c.series_instance_uid+=String.fromCharCode(g),c.series_instance_uid+=String.fromCharCode(h);break;case 19:for(j="",f=0;i/2>f;f++)h=d[e++],g=255&h,h=(65280&h)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);c.instance_number=parseInt(j,10);break;case 50:for(j="",f=0;i/2>f;f++)h=d[e++],g=255&h,h=(65280&h)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\"),c.image_position_patient=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2])];break;case 55:for(j="",f=0;i/2>f;f++)h=d[e++],g=255&h,h=(65280&h)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\"),c.image_orientation_patient=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3]),parseFloat(j[4]),parseFloat(j[5])];break;default:e=af(d,e,h,i)}break;case 65534:switch(g){default:i=0,e+=i/2}break;case 8:switch(g){case 24:for(c.sop_instance_uid="",f=0;i/2>f;f++)h=d[e++],g=255&h,h=(65280&h)>>8,c.sop_instance_uid+=String.fromCharCode(g),c.sop_instance_uid+=String.fromCharCode(h);break;default:e=af(d,e,h,i)}break;case 16:switch(g){case 8720:for(f=0;i/2>f;f++)e++;break;default:e=af(d,e,h,i)}break;default:e=af(d,e,h,i)}switch(c.Ve){case 8:c.data=new Uint8Array(c.columns*c.rows);break;case 16:c.data=new Uint16Array(c.columns*c.rows);break;case 32:c.data=new Uint32Array(c.columns*c.rows)}switch(this.R=this.P.byteLength-2*c.columns*c.rows,d=t,c.Ve){case 8:d=Z(this,"uchar",c.columns*c.rows);break;case 16:d=Z(this,"ushort",c.columns*c.rows);break;case 32:d=Z(this,"uint",c.columns*c.rows)}return c.data=d,b.na.push(c),b},B("X.parserDCM",$e),B("X.parserDCM.prototype.parse",$e.prototype.parse),C(bf,Me),bf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");var d=b.h,e=b.q,f=new Uint8Array(c),g="";b.h=d=new W(c.byteLength),b.q=e=new W(c.byteLength),c=0;for(var h=f.length;h>c;c+=32768)g+=Oe(f,c,Math.min(c+32768,h));for(f=g.split("\n"),g=f.length,this.md=this.nd=t,this.bc=[],this.Ka=gd,this.Ie=this.Qb=this.Ib=this.Rb=u,c=0,h=g%8;h--;)cf(this,f[c]),c++;for(h=0^.125*g;h--;)cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++;c=this.nd;var f=this.md,g=f.length,i=h=this.bc.length;do{var j,k=this.bc[h-i],l=k.length;for(j=0;l>j&&!("LINES"==this.Ka&&j+1>=l);j++){var m=parseInt(k[j],10),n=c.get(m);d.add(n[0],n[1],n[2]);var o=m,p=n;"LINES"==this.Ka?(o=parseInt(k[j+1],10),p=c.get(o),d.add(p[0],p[1],p[2])):"TRIANGLE_STRIPS"==this.Ka&&(0==j||j==l-1)&&d.add(n[0],n[1],n[2]),g>m?(p=f.get(m),e.add(p[0],p[1],p[2]),"LINES"==this.Ka?(o=f.get(o),e.add(o[0],o[1],o[2])):"TRIANGLE_STRIPS"==this.Ka&&(0==j||j==l-1)&&e.add(p[0],p[1],p[2])):(o=new U(n[0],n[1],n[2]),o.normalize(),e.add(o.x,o.y,o.d),"LINES"==this.Ka?(o=new U(p[0],p[1],p[2]),o.normalize(),e.add(o.x,o.y,o.d)):"TRIANGLE_STRIPS"==this.Ka&&(0==j||j==l-1)&&e.add(o.x,o.y,o.d))}i--}while(i>0);b.Da=this.Ka,D.Ua(this.g+".parse"),d=new jd,d.K=b,d.B=a,this.dispatchEvent(d)},B("X.parserVTK",bf),B("X.parserVTK.prototype.parse",bf.prototype.parse),C(df,Me),df.prototype.parse=function(a,b,c){D.Ya(this.g+".parse"),this.P=c;var d=b.h,e=b.q;b.Ac=[];var f=b.Ac;c=0;var g;do g=Z(this,"uchar"),c++;while(200>c&&10!=g);Z(this,"uchar"),e=Z(this,"uint"),c=Z(this,"uint");var h=Z(this,"float",3*e);g=Z(this,"uint",3*c);var i=new Uint32Array(e),j=new Float32Array(9*c);b.h=d=new W(9*c),b.q=e=new W(9*c);var k;for(k=0;c>k;k++){var l=3*k,m=g[l],n=g[l+1],o=g[l+2];f.push(m),f.push(n),f.push(o),i[m]+=1,i[n]+=1,i[o]+=1;var l=3*m,p=3*n,q=3*o,r=h[l],s=h[l+1],u=h[l+2],n=h[p],o=h[p+1],m=h[p+2],v=h[q],w=h[q+1],x=h[q+2];d.add(r,s,u),d.add(n,o,m),d.add(v,w,x),r=new U(r,s,u),v=new U(v,w,x),n=new U(n,o,m).l().Ea(r),o=v.l().Ea(r),n=Hc(n,o).normalize(),j[l]+=n.x,j[l+1]+=n.y,j[l+2]+=n.d,j[p]+=n.x,j[p+1]+=n.y,j[p+2]+=n.d,j[q]+=n.x,j[q+1]+=n.y,j[q+2]+=n.d}for(k=0;c>k;k++)l=3*k,m=g[l],n=g[l+1],o=g[l+2],l=3*m,p=3*n,q=3*o,f=new U(j[p],j[p+1],j[p+2]),h=new U(j[q],j[q+1],j[q+2]),l=new U(j[l],j[l+1],j[l+2]).scale(1/i[m]).normalize(),f=f.scale(1/i[n]).normalize(),h=h.scale(1/i[o]).normalize(),e.add(l.x,l.y,l.d),e.add(f.x,f.y,f.d),e.add(h.x,h.y,h.d);for(c=Z(this,"uchar",this.P.byteLength-this.R),g=t,l=0;l<c.length;l++)if(99==c[l]&&114==c[l+1]&&97==c[l+2]&&115==c[l+3]){for(e=g=l+9;10!=c[l]&&l<c.length;)e++,l++;g=Oe(c.subarray(g,e)).split(" ");break}g&&(b.ca.nh(parseFloat(g[0])),b.ca.oh(parseFloat(g[1])),b.ca.ph(parseFloat(g[2]))),b.Da=gd,D.Ua(this.g+".parse"),c=new jd,c.K=b,c.B=a,this.dispatchEvent(c)},B("X.parserFSM",df),B("X.parserFSM.prototype.parse",df.prototype.parse);var ef={Ze:function(a,b,c){return ef.update(a,0,b,c)},update:function(a,b,c,d){var e=ef.uh,f="number"==typeof c?c:c=0;for(d="number"==typeof d?d:a.length,b^=4294967295,f=7&d;f--;++c)b=b>>>8^e[255&(b^a[c])];for(f=d>>3;f--;c+=8)b=b>>>8^e[255&(b^a[c])],b=b>>>8^e[255&(b^a[c+1])],b=b>>>8^e[255&(b^a[c+2])],b=b>>>8^e[255&(b^a[c+3])],b=b>>>8^e[255&(b^a[c+4])],b=b>>>8^e[255&(b^a[c+5])],b=b>>>8^e[255&(b^a[c+6])],b=b>>>8^e[255&(b^a[c+7])];return(4294967295^b)>>>0}};ef.uh=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);var jf=0,hf=1;gf.prototype.rd=function(){for(;!this.pg;){var a=kf(this,3);switch(1&a&&(this.pg=q),a>>>=1){case 0:var a=this.input,b=this.xa,c=this.Oa,d=this.ea,e=p,f=p,g=p,h=c.length,e=p;switch(this.ib=this.pd=0,e=a[b++],e===p&&m(Error("invalid uncompressed block header: LEN (first byte)")),f=e,e=a[b++],e===p&&m(Error("invalid uncompressed block header: LEN (second byte)")),f|=e<<8,e=a[b++],e===p&&m(Error("invalid uncompressed block header: NLEN (first byte)")),g=e,e=a[b++],e===p&&m(Error("invalid uncompressed block header: NLEN (second byte)")),g|=e<<8,f===~g&&m(Error("invalid uncompressed block header: length verify")),b+f>a.length&&m(Error("input buffer is broken")),this.Ye){case jf:for(;d+f>c.length;)e=h-d,f-=e,c.set(a.subarray(b,b+e),d),d+=e,b+=e,this.ea=d,c=this.jc(),d=this.ea;break;case hf:for(;d+f>c.length;)c=this.jc({yg:2});break;default:m(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),d),d+=f,this.xa=b+=f,this.ea=d,this.Oa=c;break;case 1:this.ef(lf,mf);break;case 2:nf(this);break;default:m(Error("unknown BTYPE: "+a))}}return this.sg()};var of=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),qf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),rf=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),sf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),tf=new Uint8Array(288),uf,vf;for(uf=0,vf=tf.length;vf>uf;++uf)tf[uf]=143>=uf?8:255>=uf?9:279>=uf?7:8;var lf=ff(tf),wf=new Uint8Array(30),xf,yf;for(xf=0,yf=wf.length;yf>xf;++xf)wf[xf]=5;var mf=ff(wf);w=gf.prototype,w.ef=function(a,b){var c=this.Oa,d=this.ea;this.vg=a;for(var e,f,g,h=c.length-258;256!==(e=zf(this,a));)if(256>e)d>=h&&(this.ea=d,c=this.jc(),d=this.ea),c[d++]=e;else for(e-=257,g=pf[e],0<qf[e]&&(g+=kf(this,qf[e])),e=zf(this,b),f=rf[e],0<sf[e]&&(f+=kf(this,sf[e])),d>=h&&(this.ea=d,c=this.jc(),d=this.ea);g--;)c[d]=c[d++-f];for(;8<=this.ib;)this.ib-=8,this.xa--;this.ea=d},w.Yh=function(a,b){var c=this.Oa,d=this.ea;this.vg=a;for(var e,f,g,h=c.length;256!==(e=zf(this,a));)if(256>e)d>=h&&(c=this.jc(),h=c.length),c[d++]=e;else for(e-=257,g=pf[e],0<qf[e]&&(g+=kf(this,qf[e])),e=zf(this,b),f=rf[e],0<sf[e]&&(f+=kf(this,sf[e])),d+g>h&&(c=this.jc(),h=c.length);g--;)c[d]=c[d++-f];for(;8<=this.ib;)this.ib-=8,this.xa--;this.ea=d},w.jc=function(){var a=new Uint8Array(this.ea-32768),b=this.ea-32768,c=this.Oa;return a.set(c.subarray(32768,a.length)),this.We.push(a),this.Kf+=a.length,c.set(c.subarray(b,b+32768)),this.ea=32768,c},w.di=function(a){var b=0|this.input.length/this.xa+1,c=this.input,d=this.Oa;return a&&("number"==typeof a.yg&&(b=a.yg),"number"==typeof a.Oh&&(b+=a.Oh)),2>b?(a=(c.length-this.xa)/this.vg[2],a=0|258*(a/2),a=a<d.length?d.length+a:d.length<<1):a=d.length*b,a=new Uint8Array(a),a.set(d),this.Oa=a},w.sg=function(){var a,b,c,d,e,f=0,g=this.Oa,h=this.We,i=new Uint8Array(this.Kf+(this.ea-32768));if(0===h.length)return this.Oa.subarray(32768,this.ea);for(b=0,c=h.length;c>b;++b)for(a=h[b],d=0,e=a.length;e>d;++d)i[f++]=a[d];for(b=32768,c=this.ea;c>b;++b)i[f++]=g[b];return this.We=[],this.buffer=i},w.Uh=function(){var a,b=this.ea;return this.Cb?(a=new Uint8Array(b),a.set(this.Oa.subarray(0,b))):a=this.Oa.subarray(0,b),this.buffer=a},new Uint8Array(256);var Af;for(Af=0;256>Af;++Af)for(var Bf=Af,Cf=7,Bf=Bf>>>1;Bf;Bf>>>=1)--Cf;var Df=[],Ef;for(Ef=0;288>Ef;Ef++)switch(q){case 143>=Ef:Df.push([Ef+48,8]);break;case 255>=Ef:Df.push([Ef-144+400,9]);break;case 279>=Ef:Df.push([Ef-256+0,7]);break;case 287>=Ef:Df.push([Ef-280+192,8]);break;default:m("invalid literal: "+Ef)}var Hf=[],Gf,If;for(Gf=3;258>=Gf;Gf++)If=Ff(),Hf[Gf]=If[2]<<24|If[1]<<16|If[0];new Uint32Array(Hf),Kf.prototype.rd=function(){for(var a=this.input.length;this.xa<a;){var b=new Jf,c=p,d=p,e=p,f=c=e=p,g=p,c=c=p,h=this.input,d=this.xa;switch(b.Eg=h[d++],b.Fg=h[d++],(31!==b.Eg||139!==b.Fg)&&m(Error("invalid file signature:",b.Eg,b.Fg)),b.rg=h[d++],b.rg){case 8:break;default:m(Error("unknown compression method: "+b.rg))}if(b.de=h[d++],c=h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24,b.Tk=new Date(1e3*c),b.Xk=h[d++],b.Uk=h[d++],0<(4&b.de)&&(b.Kj=h[d++]|h[d++]<<8,d+=b.Kj),0<(8&b.de)){for(g=[],f=0;0<(c=h[d++]);)g[f++]=String.fromCharCode(c);b.name=g.join("")}if(0<(16&b.de)){for(g=[],f=0;0<(c=h[d++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(2&b.de)&&(b.Vh=65535&ef.Ze(h,0,d),b.Vh!==(h[d++]|h[d++]<<8)&&m(Error("invalid header crc16"))),c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24,h.length-d-4-4<512*c&&(e=c),d=new gf(h,{index:d,bufferSize:e}),b.data=e=d.rd(),d=d.xa,b.Kk=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0,ef.Ze(e)!==c&&m(Error("invalid CRC-32 checksum: 0x"+ef.Ze(e).toString(16)+" / 0x"+c.toString(16))),b.Qk=c=(h[d++]|h[d++]<<8|h[d++]<<16|h[d++]<<24)>>>0,(4294967295&e.length)!==c&&m(Error("invalid input size: "+(4294967295&e.length)+" / "+c)),this.member.push(b),this.xa=d}for(a=this.member,b=e=d=0,h=a.length;h>b;++b)e+=a[b].data.length;for(e=new Uint8Array(e),b=0;h>b;++b)e.set(a[b].data,d),d+=a[b].data.length;return e},C(Lf,Me),Lf.prototype.parse=function(a,b,c,d){D.Ya(this.g+".parse"),d&&(c=new Kf(new Uint8Array(c)).rd(),c=c.buffer),d=this.yd(c);var e=[d.of,d.pf,d.qf];b.oa=e;var f=d.qh;b.kd=f,c=d.min;var g=d.max;b.cb=b.ia=c,b.ma=b.ha=g,-1/0==b.fa&&(b.fa=c),1/0==b.ga&&(b.ga=g),c=Qc(),V(c,0,d.Xa[0][0],d.Xa[1][0],d.Xa[2][0],0),V(c,1,d.Xa[0][1],d.Xa[1][1],d.Xa[2][1],0),V(c,2,d.Xa[0][2],d.Xa[1][2],d.Xa[2][2],0),V(c,3,0,0,0,1);for(var g=e[0]/2,h=e[1]/2,i=e[2]/2,e=[0,0,0],j=0;3>j;++j)e[j]=d.Xa[3][j]-(c[j+0]*f[0]*g+c[j+4]*f[1]*h+c[j+8]*f[2]*i);f=e[1],g=e[2],c[12]=e[0],c[13]=f,c[14]=g,c[15]=1,d.Fb=c,d.Gb=Qc(),Zc(d.Fb,d.Gb),e=Pc(0,0,0,1),f=Oc(),ad(c,e,f),g=Pc(1,1,1,1),e=Oc(),ad(c,g,e),c=Pe(c,b.oa),d.Fd=[e[0]-f[0],e[1]-f[1],e[2]-f[2]],d.Dd=[c[1]-c[0]+1,c[3]-c[2]+1,c[5]-c[4]+1],d.Ed=[c[0],c[2],c[4]],b.hc(d),D.Ua(this.g+".parse"),b.Jb=Ve(this,b),d=new jd,d.K=b,d.B=a,this.dispatchEvent(d)},Lf.prototype.yd=function(a){if(this.P=a,a={version:0,xh:0,vh:0,ji:0,wh:0,of:0,pf:0,qf:0,Ki:0,type:0,bi:0,hh:0,Qj:t,Xa:t,qh:t,data:t,min:1/0,max:-1/0},a.version=Z(this,"uint"),a.of=Z(this,"uint"),a.pf=Z(this,"uint"),a.qf=Z(this,"uint"),a.Ki=Z(this,"uint"),a.type=Z(this,"uint"),a.bi=Z(this,"uint"),a.hh=Z(this,"ushort"),0<a.hh){a.qh=Z(this,"float",3);var b=[];b.push(Z(this,"float",3)),b.push(Z(this,"float",3)),b.push(Z(this,"float",3)),b.push(Z(this,"float",3)),a.Xa=b}switch(this.R=284,b=a.of*a.pf*a.qf,a.type){case 0:a.data=Z(this,"uchar",b);break;case 1:a.data=Z(this,"uint",b);break;case 3:a.data=Z(this,"float",b);break;case 4:a.data=Z(this,"ushort",b);break;default:m(Error("Unsupported MGH/MGZ data type: "+a.type))}return b=Ne(a.data),a.min=b[0],a.max=b[1],this.R+16<this.P.byteLength&&(a.xh=Z(this,"float"),a.ji=Z(this,"float"),a.vh=Z(this,"float"),a.wh=Z(this,"float")),a},B("X.parserMGZ",Lf),B("X.parserMGZ.prototype.parse",Lf.prototype.parse),C(Mf,Me),Mf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");var d=b.Ac,e=d.length;0==e&&m(Error("No _pointIndices defined on the X.object.")),this.P=c;var f=[],g=Z(this,"uchar",c.byteLength),h=g.length,i=u,j=0;for(c=1;h>c;c++)10==g[c-1]?(j=c,i=q):i&&32==g[c]&&(f.push(parseInt(Oe(g,j,c),10)),i=u);for(g=b.G.F?b.G.F:new Float32Array(e),h=f.length,c=0;h>c;c++)g[f[c]]=1;for(f=new Float32Array(3*e),c=h=0;e>c;c++)i=d[c],i>e&&m(Error("Could not find scalar for vertex.")),i=g[i],f[h++]=i,f[h++]=i,f[h++]=i;b.G.F=g,b.G.Pc=f,b.G.j=q,D.Ua(this.g+".parse"),d=new jd,d.K=b,d.B=a,this.dispatchEvent(d)},B("X.parserLBL",Mf),B("X.parserLBL.prototype.parse",Mf.prototype.parse),C(Nf,Me),Nf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");var d=b.Ac;0==d.length&&m(Error("No _pointIndices defined on the X.object.")),this.P=c,this.R=3;var e=Z(this,"uint");Z(this,"uint"),Z(this,"uint");var f=0,g=0,h=0,i=0,j=0,k=0,l=0,n=0,o=0,p=0,r=0;c=Array(2);var s,t=Array(2),u=Z(this,"float",e);for(s=0;e>s;s++){var v=u[s];0==s&&(c[0]=t[0]=v),v>=0?(f++,i+=v):(g++,h+=v),o+=v,r++,t[0]=Math.max(v,t[0]),c[0]=Math.min(v,c[0]),u[s]=v}for(0!=f&&(j=i/f),0!=g&&(k=h/g),0!=r&&(p=o/r),r=o=h=i=0;e>r;r++)v=u[r],s=0,v>=0?(s=Math.pow(v-j,2),i+=s):(s=Math.pow(v-k,2),h+=s),s=Math.pow(v-p,2),o+=s;for(f>1&&(l=Math.sqrt(i/(f-1))),g>1&&(n=Math.sqrt(h/(g-1))),c[1]=k-2.5*n,t[1]=j+2.5*l,e=d.length,f=new Float32Array(3*e),r=0;e>r;r++)g=u[d[r]],h=3*r,f[h]=g,f[h+1]=g,f[h+2]=g;b.G.cb=c[1],b.G.ma=t[1],-1/0==b.G.fa&&(b.G.fa=c[1]),1/0==b.G.ga&&(b.G.ga=t[1]),b.G.F=u,b.G.Pc=f,b.G.j=q,D.Ua(this.g+".parse"),d=new jd,d.K=b,d.B=a,this.dispatchEvent(d)},B("X.parserCRV",Nf),B("X.parserCRV.prototype.parse",Nf.prototype.parse),C(Of,Me),Of.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");var d=b.h,e=b.q,f=b.la;this.P=c,Z(this,"uchar",6),Z(this,"ushort",3);var g=Z(this,"float",3);Z(this,"float",3);var h=Z(this,"ushort");Z(this,"uchar",200),Z(this,"ushort"),Z(this,"uchar",200),c=Z(this,"float",16),Z(this,"uchar",444),Z(this,"uchar",4),Z(this,"uchar",4),Z(this,"float",6),Z(this,"uchar",2),Z(this,"uchar"),Z(this,"uchar"),Z(this,"uchar"),Z(this,"uchar"),Z(this,"uchar"),Z(this,"uchar");var i=Z(this,"uint");Z(this,"uint");var j=Z(this,"uint"),k=[],l=[],m=1/0,n=-1/0,o=t,p=t,r=t,s=t,e=d=t,v=Z(this,"uint",(this.P.byteLength-1e3)/4);this.R=j;for(var w=Z(this,"float",(this.P.byteLength-1e3)/4),x=0,j=f=0;i>j;j++){for(var y=v[x],z=new W(3*y),A=0,B=0;y>B;B++){var C=w[x+3*B+B*h+1],E=w[x+3*B+B*h+2],F=w[x+3*B+B*h+3],C=C/g[0],E=E/g[1],F=F/g[2];if(z.add(C,E,F),B>0)var G=z.get(B-1),A=A+Math.sqrt(Math.pow(C-G[0],2)+Math.pow(E-G[1],2)+Math.pow(F-G[2],2));y-1>B&&(f+=6)}x+=3*y+y*h+1,B=z.eb,y=z.$a,C=z.fb,E=z.ab,F=z.gb,G=z.bb,(!o||o>B)&&(o=B),(!p||y>p)&&(p=y),(!r||r>C)&&(r=C),(!s||E>s)&&(s=E),(!d||d>F)&&(d=F),(!e||G>e)&&(e=G),k.push(z),l.push(A)}for(g=(o+p)/2,r=(r+s)/2,h=(d+e)/2,s=new Float32Array(f),b.h=d=new W(f),b.q=e=new W(f),b.la=f=new W(f),j=o=0;i>j;j++)for(p=k[j],v=p.count,A=l[j],m=Math.min(m,A),n=Math.max(n,A),B=0;v-1>B;B++){x=p.get(B),w=p.get(B+1),d.add(x[0],x[1],x[2]),d.add(w[0],w[1],w[2]);var z=x[0]-g,y=x[1]-r,C=x[2]-h,E=Math.sqrt(z*z+y*y+C*C),F=w[0]-g,G=w[1]-r,H=w[2]-h,I=Math.sqrt(F*F+G*G+H*H);e.add(z/E,y/E,C/E),e.add(F/I,G/I,H/I),w=[Math.abs(w[0]-x[0]),Math.abs(w[1]-x[1]),Math.abs(w[2]-x[2])],x=Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]),w[0]/=x,w[1]/=x,w[2]/=x,f.add(w[0],w[1],w[2]),f.add(w[0],w[1],w[2]),s[o++]=A,s[o++]=A,s[o++]=A,s[o++]=A,s[o++]=A,s[o++]=A}b.Da="LINES",i=new id,i.cb=m,i.ma=n,i.fa=m,i.ga=n,i.Pc=s,i.jg=u,i.j=q,b.G=i,D.Ua(this.g+".parse"),D.f.Lf(c,b.ca.N),c=new jd,c.K=b,c.B=a,this.dispatchEvent(c)},B("X.parserTRK",Of),B("X.parserTRK.prototype.parse",Of.prototype.parse),C(Pf,Me),Pf.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||m(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join("")),f=new Image,$b(f,"load",this.nj.bind(this,f,a,b,c,d)),f.src="data:image/"+d+";base64,"+e},Pf.prototype.nj=function(a,b,c){b.Jb=a,b.Tb=t,a=new jd,a.K=c,a.B=b,this.dispatchEvent(a)},B("X.parserIMAGE",Pf),B("X.parserIMAGE.prototype.parse",Pf.prototype.parse),C(Qf,Me),Qf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse"),this.P=c,c=Z(this,"uchar",c.byteLength);
var d,e=c.length,f=0;for(d=0;e>d;d++)if(10==c[d]){var g=Oe(c,f,d),f=d+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}D.Ua(this.g+".parse"),c=new jd,c.K=b,c.B=a,this.dispatchEvent(c)},B("X.parserLUT",Qf),B("X.parserLUT.prototype.parse",Qf.prototype.parse),C(Rf,Me),Rf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse"),this.P=c,c=Z(this,"uchar",c.byteLength);var d,e=c.length,f=t,g=0;for(d=1;e>d;d++)if(10==c[d-1]&&10==c[d]){f=Oe(c,0,d-2),g=d+1;break}var h,i,j,k,e=f.split(/\r?\n/),f=0;for(d=e.length;d>f;f++)h=e[f],h.match(/NRRD\d+/)?this.Ci=q:!h.match(/^#/)&&(k=h.match(/(.*):(.*)/))&&(i=k[1].trim(),h=k[2].trim(),(j=this.fi[i])?j.call(this,h):this[i]=h);if(this.Ci||m(Error("Not an NRRD file")),"raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding&&m(Error("Only raw or gz/gzip encoding is allowed")),!this.aa&&(this.aa=[new U(1,0,0),new U(0,1,0),new U(0,0,1)],this.If))for(e=[],k=0;2>=k;k++)e.push(isNaN(this.If[k])?p:this.aa[k].scale(this.If[k]));g=c.subarray(g),("gzip"==this.encoding||"gz"==this.encoding)&&(g=new Kf(new Uint8Array(g)).rd()),g=g.buffer,c={data:t,min:1/0,max:-1/0},c.data=new this.Hb(g),k=Ne(c.data),g=c.min=k[0],k=c.max=k[1],b.cb=b.ia=g,b.ma=b.ha=k,b.oa=[this.Gf[0],this.Gf[1],this.Gf[2]],e=new U(this.aa[0][0],this.aa[0][1],this.aa[0][2]).Bb(),f=new U(this.aa[1][0],this.aa[1][1],this.aa[1][2]).Bb(),d=new U(this.aa[2][0],this.aa[2][1],this.aa[2][2]).Bb(),b.kd=[e,f,d],-1/0==b.fa&&(b.fa=g),1/0==b.ga&&(b.ga=k),e=k=1,"left-posterior-superior"==this.Ej&&(e=k=-1),g=Rc(),V(g,0,k*this.aa[0][0],k*this.aa[1][0],k*this.aa[2][0],k*this.Hf[0]),V(g,1,e*this.aa[0][1],e*this.aa[1][1],e*this.aa[2][1],e*this.Hf[1]),V(g,2,1*this.aa[0][2],1*this.aa[1][2],1*this.aa[2][2],1*this.Hf[2]),V(g,3,0,0,0,1),c.Fb=g,c.Gb=Qc(),Zc(c.Fb,c.Gb),e=Pc(0,0,0,1),k=Oc(),ad(g,e,k),f=Pc(1,1,1,1),e=Oc(),ad(g,f,e),g=Pe(g,b.oa),c.Fd=[e[0]-k[0],e[1]-k[1],e[2]-k[2]],c.Dd=[g[1]-g[0]+1,g[3]-g[2]+1,g[5]-g[4]+1],c.Ed=[g[0],g[2],g[4]],b.hc(c),D.Ua(this.g+".parse"),b.Jb=Ve(this,b),c=new jd,c.K=b,c.B=a,this.dispatchEvent(c)},Rf.prototype.fi={type:function(a){switch(a){case"uchar":case"unsigned char":case"uint8":case"uint8_t":this.Hb=Uint8Array;break;case"signed char":case"int8":case"int8_t":this.Hb=Int8Array;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":this.Hb=Int16Array;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":this.Hb=Uint16Array;break;case"int":case"signed int":case"int32":case"int32_t":this.Hb=Int32Array;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":this.Hb=Uint32Array;break;case"float":this.Hb=Float32Array;break;case"double":this.Hb=Float64Array;break;default:m(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.Ok=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.Vb=parseInt(a,10)},sizes:function(a){var b,c,d,e;for(d=a.split(/\s+/),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(parseInt(a,10));return this.Gf=e},space:function(a){return this.Ej=a},"space origin":function(a){return this.Hf=a.split("(")[1].split(")")[0].split(",")},"space directions":function(a){var b,c;a=a.match(/\(.*?\)/g);var d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(function(){var a,d,e,f;for(e=c.slice(1,-1).split(/,/),f=[],a=0,d=e.length;d>a;a++)b=e[a],f.push(parseFloat(b));return f}());return this.aa=f},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;for(e=[],c=0,d=b.length;d>c;c++)a=b[c],e.push(parseFloat(a));return this.If=e}},B("X.parserNRRD",Rf),B("X.parserNRRD.prototype.parse",Rf.prototype.parse),C(Sf,Me),Sf.prototype.parse=function(a,b,c){var d=c,e=-1,e="undefined"==typeof DataView?new Int32Array(c,0,1)[0]:new DataView(c,0).getInt32(0,q);if(348!=e&&(d=new Kf(new Uint8Array(d)).rd(),d=d.buffer),c=this.yd(d),d=c.min,e=c.max,b.cb=b.ia=d,b.ma=b.ha=e,-1/0==b.fa&&(b.fa=d),1/0==b.ga&&(b.ga=e),d=Qc(),V(d,3,0,0,0,1),0<c.Cf){var e=0,f=c.eh,g=c.fh,h=c.gh,i=1,j=1,k=1,l=c.ah,m=c.bh,n=c.dh,e=1-(f*f+g*g+h*h);1e-7>e?(e=1/Math.sqrt(f*f+g*g+h*h),f*=e,g*=e,h*=e,e=0):e=Math.sqrt(e),0<c.kb[1]&&(i=c.kb[1]),0<c.kb[2]&&(j=c.kb[2]),0<c.kb[2]&&(k=c.kb[3]),0>c.kb[0]&&(k=-k),V(d,0,(e*e+f*f-g*g-h*h)*i,2*(f*g-e*h)*j,2*(f*h+e*g)*k,l),V(d,1,2*(f*g+e*h)*i,(e*e+g*g-f*f-h*h)*j,2*(g*h-e*f)*k,m),V(d,2,2*(f*h-e*g)*i,2*(g*h+e*f)*j,(e*e+h*h-g*g-f*f)*k,n)}else 0<c.ih?(e=c.kh,f=c.lh,g=c.mh,V(d,0,e[0],e[1],e[2],e[3]),V(d,1,f[0],f[1],f[2],f[3]),V(d,2,g[0],g[1],g[2],g[3])):0==c.Cf?(V(d,0,c.kb[1],0,0,0),V(d,1,0,c.kb[2],0,0),V(d,2,0,0,c.kb[3],0)):window.console.log("UNKNOWN METHOD IN PARSER NII");c.Fb=d,c.Gb=Qc(),Zc(c.Fb,c.Gb),f=Pc(0,0,0,1),e=Oc(),ad(d,f,e),g=Pc(1,1,1,1),f=Oc(),ad(d,g,f),g=[c.Vb[1],c.Vb[2],c.Vb[3]],d=Pe(d,g),c.Fd=[f[0]-e[0],f[1]-e[1],f[2]-e[2]],c.Dd=[d[1]-d[0]+1,d[3]-d[2]+1,d[5]-d[4]+1],c.Ed=[d[0],d[2],d[4]],b.oa=g,b.hc(c),b.Jb=Ve(this,b),c=new jd,c.K=b,c.B=a,this.dispatchEvent(c)},Sf.prototype.yd=function(a){this.P=a,a={yj:0,Wh:t,Xh:t,ei:0,wj:0,rj:0,ai:t,Vb:t,yi:0,zi:0,Ai:0,wi:0,df:0,Rh:0,Dj:0,kb:t,rh:0,vj:0,uj:0,Cj:0,Aj:t,Lj:t,Sh:0,Th:0,Bj:0,Ij:0,li:0,mi:0,Zh:t,Qh:t,Cf:0,ih:0,eh:0,fh:0,gh:0,ah:0,bh:0,dh:0,kh:t,lh:t,mh:t,xi:t,Ei:t,data:t,min:1/0,max:-1/0},a.yj=Z(this,"uint"),a.Wh=Z(this,"uchar",10),a.Xh=Z(this,"uchar",18),a.ei=Z(this,"uint"),a.wj=Z(this,"ushort"),a.rj=Z(this,"uchar"),a.ai=Z(this,"uchar"),a.Vb=Z(this,"ushort",8),a.yi=Z(this,"float"),a.zi=Z(this,"float"),a.Ai=Z(this,"float"),a.wi=Z(this,"ushort"),a.df=Z(this,"ushort"),a.Rh=Z(this,"ushort"),a.Dj=Z(this,"ushort"),a.kb=Z(this,"float",8),a.rh=Z(this,"float"),a.vj=Z(this,"float"),a.uj=Z(this,"float"),a.Cj=Z(this,"ushort"),a.Aj=Z(this,"uchar"),a.Lj=Z(this,"uchar"),a.Sh=Z(this,"float"),a.Th=Z(this,"float"),a.Bj=Z(this,"float"),a.Ij=Z(this,"float"),a.li=Z(this,"uint",1),a.mi=Z(this,"uint",1),a.Zh=Z(this,"uchar",80),a.Qh=Z(this,"uchar",24),a.Cf=Z(this,"ushort"),a.ih=Z(this,"ushort"),a.eh=Z(this,"float"),a.fh=Z(this,"float"),a.gh=Z(this,"float"),a.ah=Z(this,"float"),a.bh=Z(this,"float"),a.dh=Z(this,"float"),a.kh=Z(this,"float",4),a.lh=Z(this,"float",4),a.mh=Z(this,"float",4),a.xi=Z(this,"uchar",16),a.Ei=Z(this,"uchar",4),this.R=parseInt(a.rh,10);var b=a.Vb[1]*a.Vb[2]*a.Vb[3];switch(a.df){case 2:a.data=Z(this,"uchar",b);break;case 4:a.data=Z(this,"sshort",b);break;case 8:a.data=Z(this,"sint",b);break;case 16:a.data=Z(this,"float",b);break;case 32:a.data=Z(this,"complex",b);break;case 64:a.data=Z(this,"double",b);break;case 256:a.data=Z(this,"schar",b);break;case 512:a.data=Z(this,"ushort",b);break;case 768:a.data=Z(this,"uint",b);break;default:m(Error("Unsupported NII data type: "+a.df))}return b=Ne(a.data),a.min=b[0],a.max=b[1],a},B("X.parserNII",Sf),B("X.parserNII.prototype.parse",Sf.prototype.parse),C(Tf,Me),Tf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse"),this.P=c,c=c.byteLength;var d=Z(this,"uchar",c),e=[];b.h=new W(c),b.q=new W(c);var f,g=b.h,h=b.q,i=0;for(f=0;c>f;++f)if(10==d[f]){var j=Oe(d,i,f).replace(/\s{2,}/g," ").split(" ");if("v"==j[0])e.push([parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3])]);else if("f"==j[0]){var k=e[parseInt(j[1],10)-1],i=e[parseInt(j[2],10)-1],j=e[parseInt(j[3],10)-1];g.add(k[0],k[1],k[2]),g.add(i[0],i[1],i[2]),g.add(j[0],j[1],j[2]),k=new U(k[0],k[1],k[2]),j=new U(j[0],j[1],j[2]),i=Hc(new U(i[0],i[1],i[2]).Ea(k),j.Ea(k)),i.normalize(),h.add(i.x,i.y,i.d),h.add(i.x,i.y,i.d),h.add(i.x,i.y,i.d)}i=f+1}D.Ua(this.g+".parse"),c=new jd,c.K=b,c.B=a,this.dispatchEvent(c)},B("X.parserOBJ",Tf),B("X.parserOBJ.prototype.parse",Tf.prototype.parse),C(Uf,O),Uf.prototype.load=function(a,b){if((!a||!b)&&m(Error("No container or object to load.")),!Bc(this.yc.$,a.ta)||this.yc.get(a.ta)){this.yc.set(a.ta,u);var c=Wf(a)[0];if(a.mb!=t)this.parse(t,a,b);else{var d=new XMLHttpRequest;L(d,"abort",this.xg.bind(this,d,a,b)),L(d,"error",this.xg.bind(this,d,a,b)),L(d,"load",this.parse.bind(this,d,a,b)),d.open("GET",c,q),d.responseType="arraybuffer",d.send(t)}}},Uf.prototype.parse=function(a,b,c){Vf(this,1),setTimeout(function(){var d=Wf(b),e=d[3],d=new d[2];$b(d,wd,this.complete.bind(this));var f=b.mb;f==t&&(f=a.response,b.mb=f),d.parse(b,c,f,e)}.bind(this),100)},Uf.prototype.complete=function(a){Vf(this,1),setTimeout(function(){var b=a.B,c=a.K;b.r.j=u,b.j=q,c.p(),this.yc.set(b.ta,q)}.bind(this),100)},Uf.prototype.xg=function(a,b,c){m(Error("Loading failed: ",b,c))};var Xf={OBJ:[Tf,t],STL:[Ze,t],VTK:[bf,t],TRK:[Of,t],FSM:[df,t],INFLATED:[df,t],SMOOTHWM:[df,t],SPHERE:[df,t],PIAL:[df,t],ORIG:[df,t],NRRD:[Rf,t],NII:[Sf,t],GZ:[Sf,t],DCM:[$e,t],DICOM:[$e,t],"":[$e,t],CRV:[Nf,t],LABEL:[Mf,t],MGH:[Lf,u],MGZ:[Lf,q],TXT:[Qf,t],LUT:[Qf,t],PNG:[Pf,"png"],JPG:[Pf,"jpeg"],JPEG:[Pf,"jpeg"],GIF:[Pf,"gif"]};C(Yf,O),Yf.prototype.observe=function(a){!(a!=t&&a instanceof Ge||!m(Error("Could not observe the interactor."))),L(a,rd,this.Zi.bind(this)),L(a,qd,this.Wi.bind(this)),L(a,sd,this.lj.bind(this))},Yf.prototype.Zi=function(a){a instanceof Gd||m(Error("Received no valid rotate event.")),this.rotate(a.sa)},Yf.prototype.lj=function(a){a instanceof Hd||m(Error("Received no valid zoom event.")),a.nb?this.Pf(a.Za):this.Qf(a.Za)},Yf.prototype.Wi=function(a){a instanceof Fd||m(Error("Received no valid pan event.")),this.zf(a.sa)},Yf.prototype.__defineGetter__("view",v("n")),Yf.prototype.__defineSetter__("view",function(a){!(a!=t&&a instanceof Float32Array||!m(Error("Invalid view matrix."))),this.n=a}),Yf.prototype.__defineGetter__("position",function(){return[this.cc.x,this.cc.y,this.cc.d]}),Yf.prototype.__defineSetter__("position",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid position.")),this.cc=new D.m(a[0],a[1],a[2]),this.reset()}),Yf.prototype.__defineGetter__("focus",function(){return[this.sc.x,this.sc.y,this.sc.d]}),Yf.prototype.__defineSetter__("focus",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid focus")),this.sc=new D.m(a[0],a[1],a[2]),this.reset()}),Yf.prototype.__defineGetter__("up",function(){return[this.Z.x,this.Z.y,this.Z.d]}),Yf.prototype.__defineSetter__("up",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid up vector.")),this.Z=new D.m(a[0],a[1],a[2]),this.reset()}),w=Yf.prototype,w.reset=function(){this.n=this.me(this.cc,this.sc)},w.rotate=function(a){return la(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||m(Error("Invalid distance vector for rotate operation.")),a},w.zf=function(a){la(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||m(Error("Invalid distance vector for pan operation.")),this.n[12]-=a.x,this.n[13]+=a.y},w.Pf=function(a){var b=20;a!=t&&!a&&(b=1),this.n[14]+=b},w.Qf=function(a){var b=20;a!=t&&!a&&(b=1),this.n[14]-=b},w.me=function(a,b){return!(a instanceof D.m&&b instanceof D.m||!m(Error("3D vectors required for calculating the view."))),D.f.td()},B("X.camera",Yf),B("X.camera.prototype.pan",Yf.prototype.zf),B("X.camera.prototype.rotate",Yf.prototype.rotate),B("X.camera.prototype.zoomIn",Yf.prototype.Pf),B("X.camera.prototype.zoomOut",Yf.prototype.Qf),C(Zf,sc),C($f,Y),$f.prototype.__defineGetter__("start",v("Re")),$f.prototype.__defineSetter__("start",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid start")),this.Re=a}),$f.prototype.__defineGetter__("end",v("Ae")),$f.prototype.__defineSetter__("end",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid end")),this.Ae=a}),$f.prototype.__defineGetter__("radius",v("dc")),$f.prototype.__defineSetter__("radius",function(a){x(a)||m(Error("Invalid radius.")),this.dc=a}),$f.prototype.p=function(){od(this,new Zf({start:this.Re,end:this.Ae,qb:this.dc,na:this.Wa})),$f.z.p.call(this)},B("X.cylinder",$f),B("X.cylinder.prototype.modified",$f.prototype.p),C(ag,sc),C(bg,Y),bg.prototype.__defineGetter__("center",v("A")),bg.prototype.__defineSetter__("center",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid center")),this.A=a}),bg.prototype.__defineGetter__("radius",v("dc")),bg.prototype.__defineSetter__("radius",function(a){x(a)||m(Error("Invalid radius.")),this.dc=a}),bg.prototype.p=function(){od(this,new ag({$e:this.A,qb:this.dc,na:this.Wa,Fj:this.Ih})),bg.z.p.call(this)},B("X.sphere",bg),B("X.sphere.prototype.modified",bg.prototype.p),C(Xe,Q),Xe.prototype.p=function(){var a=new jd;a.K=this,this.dispatchEvent(a),this.zb.p()},Xe.prototype.__defineSetter__("showOnly",function(a){var b=[-1,-1,-1,-1];a!=t&&(la(a)&&4==a.length?b=a:(this.Aa||m(Error("No colortable assigned.")),b=this.Aa.Fa.get(a).slice(1,5))),this.Qe=new Float32Array([Math.floor(255*b[0]),Math.floor(255*b[1]),Math.floor(255*b[2]),Math.floor(255*b[3])])}),B("X.labelmap",Xe),C(cg,sc),C(dg,Y),dg.prototype.__defineGetter__("center",v("A")),dg.prototype.__defineSetter__("center",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid center")),this.A=a}),dg.prototype.__defineGetter__("lengthX",v("De")),dg.prototype.__defineSetter__("lengthX",function(a){x(a)||m(Error("Invalid lengthX.")),this.De=a}),dg.prototype.__defineGetter__("lengthY",v("Ee")),dg.prototype.__defineSetter__("lengthY",function(a){x(a)||m(Error("Invalid lengthY.")),this.Ee=a}),dg.prototype.__defineGetter__("lengthZ",v("Fe")),dg.prototype.__defineSetter__("lengthZ",function(a){x(a)||m(Error("Invalid lengthZ.")),this.Fe=a}),dg.prototype.p=function(){od(this,new cg({$e:this.A,qb:[this.De/2,this.Ee/2,this.Fe/2]})),dg.z.p.call(this)},B("X.cube",dg),B("X.cube.prototype.modified",dg.prototype.p),C(Ie,Ge),Ie.prototype.wd=function(a){Ie.z.wd.call(this,a);var b=new Hd;a.Jc==t&&(a.Jc=0),b.nb=0>a.Jc,b.Za=q,this.dispatchEvent(b)},C(eg,O),eg.prototype.add=function(a){return this.F.push(a),q},eg.prototype.remove=function(a){return a=this.F.indexOf(a),a>-1&&this.F.splice(a,1),q},eg.prototype.clear=function(){this.F.length=0},eg.prototype.sort=function(){gg(this,0,this.F.length)},C(hg,Yf),hg.prototype.rotate=function(a){a=hg.z.rotate.call(this,a);var b=new Ed;0<a.x?b.Te--:0>a.x&&b.Te++,0<a.y?b.Ge++:0>a.y&&b.Ge--,this.dispatchEvent(b)},hg.prototype.Pf=function(a){var b=20;a!=t&&!a&&(b=.02),this.n[14]+=b},hg.prototype.Qf=function(a){var b=20;a!=t&&!a&&(b=.02),this.n[14]-=b},hg.prototype.zf=function(a){la(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||m(Error("Invalid distance vector for pan operation.")),this.n[12]-=a.x/this.n[14],this.n[13]+=a.y/this.n[14]},C(ig,Yf),ig.prototype.rotate=function(a){a=ig.z.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new D.m(this.n[1],this.n[5],this.n[9]),d=new D.m(this.n[0],this.n[4],this.n[8]);c.normalize(),d.normalize(),D.f.rotate(this.n,b,c.x,c.y,c.d),D.f.rotate(this.n,a,d.x,d.y,d.d)},ig.prototype.me=function(a,b){var c=ig.z.me.call(this,a,b);return D.f.Mg(c,a,b,this.Z),c},B("X.camera3D",ig),C(kg,Pb);var lg=[];kg.prototype.Df=function(){Jb(this.Q,bc),this.Q.length=0},kg.prototype.handleEvent=function(){m(Error("EventHandler.handleEvent not implemented"))},ng.zg=function(){return ng.Hg?ng.Hg:ng.Hg=new ng},ng.prototype.Ji=0,ng.zg(),C(og,ic),og.prototype.ui=ng.zg();var pg=t;w=og.prototype,w.Gg=t,w.Lc=u,w.D=t,w.tj=t,w.xd=t,w.qd=t,w.af=t,w.s=v("D"),w.Ff=function(a){this.xd&&this.xd!=a&&m(Error("Method not supported")),og.z.Ff.call(this,a)},w.fe=v("Wb"),w.Ic=function(){this.D=this.Wb.createElement("div")},w.Zb=function(a){this.$b(a)},w.$b=function(a,b){this.Lc&&m(Error("Component already rendered")),this.D||this.Ic(),a?a.insertBefore(this.D,b||t):this.Wb.da.body.appendChild(this.D),(!this.xd||this.xd.Lc)&&this.be()},w.be=function(){function a(a){!a.Lc&&a.s()&&a.be()}this.Lc=q,this.qd&&Jb(this.qd,a,p)},w.ce=function(){function a(a){a.Lc&&a.ce()}this.qd&&Jb(this.qd,a,p),this.ni&&this.ni.Df(),this.Lc=u},w.removeChild=function(a,b){if(a){var c,d=na(a)?a:a.Gg||(a.Gg=":"+(a.ui.Ji++).toString(36));this.af&&d?(c=this.af,c=(d in c?c[d]:p)||t):c=t,a=c,d&&a&&(c=this.af,d in c&&delete c[d],Nb(this.qd,a),b&&(a.ce(),a.D&&de(a.D)),d=a,d==t&&m(Error("Unable to set parent component")),d.xd=t,og.z.Ff.call(d,t))}return a||m(Error("Child is not in parent component")),a},C(qg,ic),w=qg.prototype,w.Nf=0,w.vd=0,w.nf=100,w.wg=0,w.Jf=1,w.Bi=u,w.Ii=u,w.Bd=function(a){a=rg(this,a),this.Nf!=a&&(this.Nf=a+this.wg>this.nf?this.nf-this.wg:a<this.vd?this.vd:a,!this.Bi&&!this.Ii&&this.dispatchEvent("change"))},w.ie=function(){return rg(this,this.Nf)},w.he=function(){return rg(this,this.vd)},w.ge=function(){return rg(this,this.nf)},C(sg,og);var ug={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};w=sg.prototype,w.Ic=function(){this.rb=this.fe().Ic("div","progress-bar-thumb");var a=ug[this.Yg];this.D=this.fe().Ic("div",a,this.rb),vg(this),a=this.he(),this.s().setAttribute("aria-valuemin",a),a=this.ge(),this.s().setAttribute("aria-valuemax",a)},w.be=function(){sg.z.be.call(this),J&&7>vb&&L(this.s(),"resize",this.we,u,this),this.we();var a=this.s();a.setAttribute("role","progressbar"),a.setAttribute("aria-live","polite")},w.ce=function(){sg.z.ce.call(this),J&&7>vb&&ac(this.s(),"resize",this.we,u,this)},w.ie=function(){return this.zd.ie()},w.Bd=function(a){this.zd.Bd(a),this.s()&&vg(this)},w.he=function(){return this.zd.he()},w.ge=function(){return this.zd.ge()},w.Yg="horizontal",w.oi=function(){this.we(),this.dispatchEvent("change")},w.we=function(){if(this.rb){var a=this.he(),b=this.ge(),a=(this.ie()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Yg?J&&7>vb?(this.rb.style.top=0,this.rb.style.height="100%",b=this.rb.offsetHeight,a=Math.round(a*b),this.rb.style.top=b-a+"px",this.rb.style.height=a+"px"):(this.rb.style.top=100-b+"%",this.rb.style.height=b+"%"):this.rb.style.width=b+"%"}},C(wg,sg),wg.prototype.hf=function(){var a=le(this.Va,"position");("static"==a||""==a)&&(this.Ke=this.Va.style.position,this.Va.style.position="relative");var a=document.getElementsByTagName("head")[0],b=be("style");b.type="text/css",b.media="screen";var c=document.createTextNode(String(this.ac[0])),d=document.createTextNode(String(this.ac[1])),e=document.createTextNode(String(this.ac[2]));a.appendChild(b),b.appendChild(c),b.appendChild(d),b.appendChild(e),this.yb=b,this.Zb(this.Va),a=this.s(),a.style.position="absolute",a.style.top=(this.Va.clientHeight-5)/2+"px",a.style.left=(this.Va.clientWidth-100)/2+"px",a.classList.add("xtk-progress-bar")},wg.prototype.ud=function(){this.yb&&de(this.yb),this.s()&&de(this.s()),this.Jd&&de(this.Jd.s()),this.Jd=this.yb=t,this.Ke&&(this.Va.style.position=this.Ke)},C(zg,O),w=zg.prototype,w.sf=function(){window.cancelAnimationFrame(this.xe),this.O.PROGRESSBAR_ENABLED&&(this.Sb=new wg(this.B,3))},w.tf=function(){this.O.PROGRESSBAR_ENABLED&&this.Sb&&(xg(this.Sb),this.Gd=yg(function(){this.Gd=t,this.Sb&&(this.Sb.ud(),this.Sb=t),this.Rc=this.Rd=q,this.Zb()}.bind(this),700))},w.uf=function(a){this.Sb&&this.Sb.Bd(100*a.od)},w.Xi=function(a){this.Ga&&this.Ga.Bd(100*a.od)},w.Ni=function(a){a!=t&&a instanceof jd&&a.K&&this.sb(a.K)},w.Yi=function(a){a!=t&&a instanceof kd&&a.K&&this.remove(a.K)},w.wf=function(a){!(a!=t&&a instanceof Jd||!m(Error("Invalid hover event.")))},w.xf=function(){var a=$d(this.B);this.H=a.clientWidth,this.v=a.clientHeight,a=$d(this.za),a.width=this.H,a.height=this.v,"renderer3D"==this.g&&(this.a.viewport(0,0,this.H,this.v),this.J.Le=D.f.mf(D.f.td(),this.J.Uf,this.za.width/this.za.height,1,1e4))},w.yf=function(a){!(a!=t&&a instanceof Id||!m(Error("Invalid scroll event.")))},zg.prototype.__defineGetter__("config",v("O")),zg.prototype.__defineGetter__("interactor",v("S")),zg.prototype.__defineGetter__("camera",v("J")),zg.prototype.__defineGetter__("loadingCompleted",v("Rc")),zg.prototype.__defineGetter__("container",v("B")),zg.prototype.__defineSetter__("container",function(a){a==t&&m(Error("An ID to a valid container (<div>..) is required."));var b=a;na(b)&&(b=$d(a)),pa(b)&&1==b.nodeType||m(Error("Could not find the given container.")),this.B=b}),w=zg.prototype,w.Ad=function(){this.J.reset()},w.wa=function(a){var b=be("canvas");this.B.appendChild(b),this.H=this.B.clientWidth,this.v=this.B.clientHeight,b.width=this.H,b.height=this.v;try{var c=b.getContext(a);c||m(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.B.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>",m(Error(e))}this.W=new Uf,L(this.W,yd,this.Xi.bind(this)),this.za=b,this.a=c,b=new Ie(this.za),"2d"==a&&(b=new Ke(this.za)),b.wa(),L(b,ud,this.Ad.bind(this)),L(b,zd,this.wf.bind(this)),L(b,td,this.yf.bind(this)),this.S=b,b=new ig(this.H,this.v),"2d"==a&&(b=new hg(this.H,this.v)),b.observe(this.S),this.J=b,L(window,"resize",this.xf,u,this)},w.add=function(a){(a instanceof dg||a instanceof bg||a instanceof $f)&&a.p(),this.hb.push(a),this.sb(a)},w.remove=function(a){if((!this.za||!this.a)&&m(Error("The renderer was not initialized properly.")),a!=t){var b=0;if(a!=t){if(a=qa(a),Wb[a]){a=Wb[a];for(var c=a.length-1;c>=0;c--)bc(a[c].key),b++}}else Na(Ub,function(a,c){bc(c),b++})}return u},w.sb=function(a){(!this.za||!this.a)&&m(Error("The renderer was not initialized properly.")),a!=t&&(dc(a,wd)||L(a,wd,this.Ni.bind(this)),dc(a,xd)||L(a,xd,this.Yi.bind(this)),dc(a,Bd)||L(a,Bd,this.sf.bind(this)),dc(a,Dd)||L(a,Dd,this.uf.bind(this)),dc(a,Cd)||L(a,Cd,this.tf.bind(this)))},w.get=function(a){a==t&&m(Error("Invalid object id."));for(var b=this.pb.F,c=b.length,d=0,d=0;c>d;d++)if(b[d].ta==a)return b[d];return t},w.Zb=function(){if((!this.za||!this.a)&&m(Error("The renderer was not initialized properly.")),this.ig==t){if(Ac(this.W.yc)){if(this.O.PROGRESSBAR_ENABLED&&!this.Ga&&(this.Ga=new wg(this.B,3)),this.Rd=this.Rc=u,this.ig=yg(function(){this.ig=t,this.Zb()}.bind(this),100),!this.O.INTERMEDIATE_RENDERING)return}else if(!this.Rc&&!this.Rd&&(this.Rd=q,eval("this.onShowtime()"),this.Rc=q),this.Ga)return this.O.PROGRESSBAR_ENABLED&&this.Ga&&!this.Gd&&(xg(this.Ga),this.Gd=yg(function(){this.Gd=t,this.Ga&&(this.Ga.ud(),this.Ga=t),this.Zb()}.bind(this),700)),void 0;this.xe=window.requestAnimationFrame(this.Zb.bind(this)),eval("this.onRender()"),this.$b(u,q)}},w.Xg=ea(),w.Vg=ea(),w.$b=ea(),w.$d=function(){window.cancelAnimationFrame(this.xe),this.W&&(delete this.W,this.W=t),this.Ga&&(this.Ga.ud(),delete this.Ga,this.Ga=t),this.pb.clear(),delete this.pb,this.hb.length=0,delete this.hb,delete this.W,this.W=t,delete this.J,this.J=t,delete this.S,this.S=t,delete this.a,this.a=t,de(this.za),delete this.za,this.za=t},C(Ag,O);var Bg={nk:"vertexPosition",mk:"vertexNormal",lk:"vertexColor",pk:"vertexTexturePos",ok:"vertexScalar"},Cg={qk:"view",Vj:"perspective",Mj:"center",Uj:"objectTransform",hk:"useObjectColor",Sj:"objectColor",jk:"useScalars",dk:"scalarsReplaceMode",ak:"scalarsMin",Yj:"scalarsMax",bk:"scalarsMinColor",Zj:"scalarsMaxColor",ck:"scalarsMinThreshold",$j:"scalarsMaxThreshold",Xj:"scalarsInterpolation",Wj:"pointSize",Tj:"objectOpacity",Rj:"normal",ik:"usePicking",kk:"useTexture",gk:"useLabelMapTexture",Pj:"labelmapOpacity",Oj:"labelmapColor",ek:"textureSampler",fk:"textureSampler2",rk:"volumeLowerThreshold",xk:"volumeUpperThreshold",uk:"volumeScalarMin",sk:"volumeScalarMax",vk:"volumeScalarMinColor",tk:"volumeScalarMaxColor",zk:"volumeWindowLow",yk:"volumeWindowHigh",wk:"volumeTexture"};Fg.prototype.lb=ea(),C(Gg,Fg),Gg.prototype.lb=function(a,b,c,d){Dg(ne(a),0,a,b,this.bf,c,t,d)},C(Hg,Fg),Hg.prototype.lb=function(a,b,c){Dg(this.element,this.ug,a,b,p,c,this.mj)},C(Ig,ic),w=Ig.prototype,w.D=t,w.Ph=q,w.og=t,w.Ha=u,w.xj=u,w.kf=-1,w.Lg=-1,w.ti=u,w.ci=q,w.Mc="toggle_display",w.s=v("D"),w.Ef=function(a){this.Ha&&m(Error("Can not change this state of the popup while showing.")),this.D=a},w.lb=ha,w.tg=function(a){"toggle_display"==this.Mc?this.xj?yg(this.Dg,0,this):this.Dg():"move_offscreen"==this.Mc&&(this.D.style.top="-10000px"),this.vf(a)},w.Dg=function(){this.D.style.visibility="hidden",ye(this.D,u)},w.rf=function(){return this.dispatchEvent("beforeshow")},w.Wg=function(){this.kf=xa(),this.Lg=-1,this.dispatchEvent("show")},w.vf=function(a){this.dispatchEvent({type:"hide",target:a})},w.Tg=function(a){a=a.target,!(fe(this.D,a)||this.og&&!fe(this.og,a)||150>xa()-this.kf||!Kg(this,a))},w.Li=function(a){27==a.keyCode&&Kg(this,a.target)&&(a.preventDefault(),a.stopPropagation())},w.Sg=function(a){if(this.ci){var b=Zd(this.D);if(J||jb){if(a=b.activeElement,!a||fe(this.D,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>xa()-this.kf||Kg(this)}},C(Lg,Ig),Lg.prototype.lb=function(){if(this.ne){var a=!this.Ha&&"move_offscreen"!=this.Mc,b=this.s();a&&(b.style.visibility="hidden",ye(b,q)),this.ne.lb(b,this.qj,this.Sk),a&&ye(b,u)}},w=Mg.prototype,w.ee=function(){return this.$.ee()},w.add=function(a){this.$.set(Ng(a),a)},w.Ue=function(a){a=xc(a);for(var b=a.length,c=0;b>c;c++)this.add(a[c])},w.Df=function(a){a=xc(a);for(var b=a.length,c=0;b>c;c++)this.remove(a[c])},w.remove=function(a){return this.$.remove(Ng(a))},w.clear=function(){this.$.clear()},w.contains=function(a){return a=Ng(a),Bc(this.$.$,a)},w.Ig=function(a){var b=new Mg;a=xc(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b},w.sd=function(){return this.$.sd()},w.l=function(){return new Mg(this)},C(Og,Lg);var Qg=[];w=Og.prototype,w.Na=t,w.className="goog-tooltip",w.jh=500,w.si=0,w.fe=v("Wb"),w.Ef=function(a){var b=this.s();b&&de(b),Og.z.Ef.call(this,a),a&&(b=this.Wb.da.body,b.insertBefore(a,b.lastChild))},w.rf=function(){if(!Ig.prototype.rf.call(this))return u;if(this.anchor)for(var a,b=0;a=Qg[b];b++)fe(a.s(),this.anchor)||Jg(a,u);return 0<=Ib(Qg,this)||Qg.push(this),a=this.s(),a.className=this.className,Rg(this),L(a,"mouseover",this.Cg,u,this),L(a,"mouseout",this.Bg,u,this),Sg(this),q},w.vf=function(){Nb(Qg,this);for(var a,b=this.s(),c=0;a=Qg[c];c++)a.anchor&&fe(b,a.anchor)&&Jg(a,u);this.Zg&&Tg(this.Zg),ac(b,"mouseover",this.Cg,u,this),ac(b,"mouseout",this.Bg,u,this),this.anchor=p,0==(this.Db?this.Ha?4:1:this.Kc?3:this.Ha?2:0)&&(this.se=u),Ig.prototype.vf.call(this)},w.Pg=function(a,b){this.anchor==a&&this.ae.contains(this.anchor)&&(this.se||!this.Wk?(Jg(this,u),this.Ha||(this.anchor=a,this.ne=b||Ug(this,0)||p,this.Ha&&this.lb(),Jg(this,q))):this.anchor=p),this.Db=p},w.Hi=function(a){this.Kc=p,!(a!=this.anchor||this.Na!=t&&(this.Na==this.s()||this.ae.contains(this.Na))||this.qg&&this.qg.Na||!Jg(this,u))},w.ri=function(a){var b=Wg(this,a.target);this.Na=b,Rg(this),b!=this.anchor&&(this.anchor=b,this.Db||(this.Db=yg(va(this.Pg,this,b,p),this.jh)),Xg(this),Vg(this,a))},w.qi=function(a){Vg(this,a),this.se=q},w.pi=function(a){if(this.Na=a=Wg(this,a.target),this.se=q,this.anchor!=a){this.anchor=a;var b=Ug(this,1);Rg(this),this.Db||(this.Db=yg(va(this.Pg,this,a,b),this.jh)),Xg(this)}},w.Ag=function(a){var b=Wg(this,a.target),c=Wg(this,a.relatedTarget);b!=c&&(b==this.Na&&(this.Na=t),Sg(this),this.se=u,!this.Ha||a.relatedTarget&&fe(this.s(),a.relatedTarget)?this.anchor=p:Tg(this))},w.Cg=function(){var a=this.s();this.Na!=a&&(Rg(this),this.Na=a)},w.Bg=function(a){var b=this.s();this.Na!=b||a.relatedTarget&&fe(b,a.relatedTarget)||(this.Na=t,Tg(this))},C(Yg,Gg),Yg.prototype.lb=function(a,b,c){b=ne(a),b=qe(b),c=c?new ie(c.top+10,c.right,c.bottom,c.left+10):new ie(10,0,0,10),496&Eg(this.bf,a,4,c,b,9)&&Eg(this.bf,a,4,c,b,5)},C(Zg,Hg),Zg.prototype.lb=function(a,b,c){var d=new Vd(10,0);496&Dg(this.element,this.ug,a,b,d,c,9)&&Dg(this.element,2,a,1,d,c,5)},C($g,Og),$g.prototype.hf=function(){var a=le(this.Va,"position");("static"==a||""==a)&&(this.Va.style.position="relative");var a=document.getElementsByTagName("head")[0],b=be("style");b.type="text/css",b.media="screen";var c=document.createTextNode(String(this.ac[0]));a.appendChild(b),b.appendChild(c),this.yb=b,this.ne=new Gg(this.Xd,this.Yd)||p,this.Ha&&this.lb(),Jg(this,q),Pg(this,this.Va),this.s().classList.add("x-tooltip")},$g.prototype.ud=function(){Jg(this,u),this.yb&&de(this.yb),this.s()&&de(this.s()),this.yb=t},C(ah,zg),ah.prototype.__defineGetter__("config",v("O")),w=ah.prototype,w.sj=function(){this.Vc=this.Yc=this.Uc=this.Xc=this.Tc=this.Wc=t,this.A=[0,0,0]},w.wf=function(a){ah.z.wf.call(this,a);var b=a.Xd;a=a.Yd;var c=this.Bf(b,a);if((c=this.get(c))&&(c=c.qc)){var d=te(this.B);new $g(this.B,d.x+b+10,d.y+a+10,this.S).s().innerHTML=c}},w.wa=function(){ah.z.wa.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.H,this.v),this.a.clearColor(this.Nc[0],this.Nc[1],this.Nc[2],0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.O.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,c),this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.H,this.v,0,this.a.RGB,this.a.UNSIGNED_BYTE,t),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST),this.a.bindFramebuffer(this.a.FRAMEBUFFER,a),this.a.bindRenderbuffer(this.a.RENDERBUFFER,b),this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.H,this.v),this.a.bindRenderbuffer(this.a.RENDERBUFFER,t),this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0),this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b),this.a.bindFramebuffer(this.a.FRAMEBUFFER,t),this.gg=a}}catch(d){m(Error("Exception while accessing GL Context!\n"+d))}a=new Ag,(this.za==t||this.a==t||this.J==t)&&m(Error("Renderer was not initialized properly.")),!(a!=t&&a instanceof Ag||!m(Error("Could not add shaders."))),b=Object.keys(Cg),Object.keys(Bg).every(function(a){return a=Bg[a],-1!=this.Vd.search(a)||-1!=this.Kd.search(a)}.bind(a))||m(Error("Could not find all attributes in the shader sources.")),b.every(function(a){return a=Cg[a],-1!=this.Vd.search(a)||-1!=this.Kd.search(a)}.bind(a))||m(Error("Could not find all uniforms in the shader sources.")),b=this.a.createShader(this.a.FRAGMENT_SHADER),c=this.a.createShader(this.a.VERTEX_SHADER),this.a.shaderSource(b,a.Kd),this.a.shaderSource(c,a.Vd),this.a.compileShader(b),this.a.compileShader(c),this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||m(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b))),this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||m(Error("Vertex Shader compilation failed!\n"+this.a.getShaderInfoLog(c)));var e=this.a.createProgram();this.a.attachShader(e,c),this.a.attachShader(e,b),this.a.linkProgram(e),this.a.getProgramParameter(e,this.a.LINK_STATUS)||m(Error("Could not create shader program!\n"+this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(e))),this.a.useProgram(e),this.Oe=e,Object.keys(Bg).forEach(function(a){a=Bg[a],this.ze.set(a,this.a.getAttribLocation(this.Oe,a)),this.a.enableVertexAttribArray(this.ze.get(a))}.bind(this)),Object.keys(Cg).forEach(function(a){a=Cg[a],this.ld.set(a,this.a.getUniformLocation(this.Oe,a))}.bind(this)),this.Pe=a},w.sb=function(a){ah.z.sb.call(this,a);var b=u;if(a!=t){this.get(a.ta)&&(b=q);var c=a.ta,d=a.h,e=a.q,f=a.la,g=a.C,h=a.r,i=a.ca,j=a.Aa,k=a.e,l=a.G;if(k!=t&&k.r!=t&&k.r.j)this.sb(k);else if(k!=t&&k.j&&this.sb(k),j!=t&&j.r!=t&&j.r.j)this.W.load(j,a);else if(g!=t&&g.r!=t&&g.r.j)this.W.load(g,a);else{if(h!=t&&la(h)){if(a.nc==t){for(b=0,c=h.length,b=0;c>b;b++)this.W.load(h[b],a);return}if(a.nc.lf!=h.length||!a.j)return}else{if(h!=t&&h.j)return this.W.load(a,a),void 0;if(l!=t&&l.r!=t&&l.r.j)return this.W.load(l,a),void 0}if(0<a.c.length)for(h=a.c,j=h.length,k=k=0;j>k;k++)this.sb(h[k]);if(d){for(h=0;this.Pd;)h++,window.console.log("Possible thread lock avoided: "+h);
this.Pd=q,j=a instanceof Le&&a.zb instanceof Xe,b&&g!=t&&g.j&&(h=this.ec.get(c),h!=t&&this.a.isBuffer(h.M)&&this.a.deleteBuffer(h.M)),h=t,g!=t&&(!b||g.j?(h=a.Fc,h==t&&m(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),k=u,g.Tb&&(k=q),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,k),k=this.a.createTexture(),k.vi=g.Jb,this.Gc.set(g.ta,k),this.a.bindTexture(this.a.TEXTURE_2D,k),g.Tb?(k=this.a.RGBA,g.Xf&&(k=this.a.LUMINANCE,this.a.pixelStorei(this.a.UNPACK_ALIGNMENT,1)),this.a.texImage2D(this.a.TEXTURE_2D,0,k,g.Ne,g.Me,0,k,this.a.UNSIGNED_BYTE,g.Tb)):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,k.vi),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),j?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,t),k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Qd(k,h.length,2),this.ec.set(c,h),g.j=u):h=this.ec.get(c)),Vf(this.W,.1),j?(this.Pd=u,D.Ua(this.g+".update"),Vf(this.W,.9)):((!b||d.j||i.j)&&(j=i.N,g=D.f.X(j,d.eb,d.fb,d.gb),j=D.f.X(j,d.$a,d.ab,d.bb),(this.Wc===t||g.x<this.Wc)&&(this.Wc=g.x),(this.Tc===t||j.x>this.Tc)&&(this.Tc=j.x),(this.Xc===t||g.y<this.Xc)&&(this.Xc=g.y),(this.Uc===t||j.y>this.Uc)&&(this.Uc=j.y),(this.Yc===t||g.d<this.Yc)&&(this.Yc=g.d),(this.Vc===t||j.d>this.Vc)&&(this.Vc=j.d),this.A=[(this.Wc+this.Tc)/2,(this.Xc+this.Uc)/2,(this.Yc+this.Vc)/2],i.j=u),b&&d.j&&(i=this.fc.get(c),i!=t&&this.a.isBuffer(i.M)&&this.a.deleteBuffer(i.M)),i=t,!b||d.j?(i=this.a.createBuffer(),d.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,i),this.a.bufferData(this.a.ARRAY_BUFFER,d.Y,this.a.STATIC_DRAW),i=new Qd(i,d.count,3),d.j=u):i=this.fc.get(c),Vf(this.W,.3),b&&e.j&&(g=this.fc.get(c),g!=t&&this.a.isBuffer(g.M)&&this.a.deleteBuffer(g.M)),g=t,!b||e.j?(g=this.a.createBuffer(),e.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.Y,this.a.STATIC_DRAW),g=new Qd(g,e.count,3),e.j=u):g=this.Zc.get(c),Vf(this.W,.3),b&&f&&f.j&&(e=this.rc.get(c),e!=t&&this.a.isBuffer(e.M)&&this.a.deleteBuffer(e.M)),e=t,f&&(!b||f.j?(f.length!=d.length&&m(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.Y,this.a.STATIC_DRAW),e=new Qd(e,f.count,3),f.j=u):e=this.rc.get(c)),Vf(this.W,.2),b&&l&&l.j&&(f=this.Bc.get(c),f!=t&&this.a.isBuffer(f.M)&&this.a.deleteBuffer(f.M)),f=t,l&&(f=l.Pc,!b||l.j?(f.length!=d.length&&m(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Qd(d,f.length,3),l.j=u):f=this.Bc.get(c)),Vf(this.W,.1),b||this.pb.add(a),this.fc.set(c,i),this.Zc.set(c,g),this.rc.set(c,e),this.ec.set(c,h),this.Bc.set(c,f),this.Pd=a.j=u)}else a.j=u}}},w.Bf=function(a,b){if(this.O.PICKING_ENABLED){this.$b(q,u);var c=new Uint8Array(4);return this.a.readPixels(a,this.v-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c),c[0]+255*c[1]+65025*c[2]}return-1},w.$b=function(a,b){ah.z.$b.call(this,a,b),this.a.viewport(0,0,this.H,this.v),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.pb.F,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.gg):this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);var e=this.J.Le,f=this.J.n;for(this.a.uniformMatrix4fv(this.ld.get("perspective"),u,e),this.a.uniformMatrix4fv(this.ld.get("view"),u,f),e=this.A,this.a.uniform3f(this.ld.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])),f=this.hb.length,e=0;f>e;++e){var g=this.hb[e];if(g instanceof Q){var h=D.f.X(this.J.n,g.t[0]+g.b[0].i[0],g.t[1]+g.b[0].i[1],g.t[2]+g.b[0].i[2]),i=D.f.X(this.J.n,g.t[0]-g.b[0].i[0],g.t[1]-g.b[0].i[1],g.t[2]-g.b[0].i[2]),j=Math.abs(h.d-i.d),h=D.f.X(this.J.n,g.t[0]+g.b[1].i[0],g.t[1]+g.b[1].i[1],g.t[2]+g.b[1].i[2]),i=D.f.X(this.J.n,g.t[0]-g.b[1].i[0],g.t[1]-g.b[1].i[1],g.t[2]+-g.b[1].i[2]),k=Math.abs(h.d-i.d),h=D.f.X(this.J.n,g.t[0]+g.b[2].i[0],g.t[1]+g.b[2].i[1],g.t[2]+g.b[2].i[2]),i=D.f.X(this.J.n,g.t[0]-g.b[2].i[0],g.t[1]-g.b[2].i[1],g.t[2]-g.b[2].i[2]),h=Math.max(j,k,Math.abs(h.d-i.d));h==j?We(g,0):h==k?We(g,1):We(g,2)}}if(this.O.ORDERING_ENABLED){j=u,f=this.hb,g=f.length-1;do if(e=f[g],e instanceof Q&&e.Ma&&-1!=e.T){var j=e.c[e.T].c,k=e.T,h=D.f.X(this.J.n,e.t[0]+e.b[k].w[0],e.t[1]+e.b[k].w[1],e.t[2]+e.b[k].w[2]),i=D.f.X(this.J.n,e.t[0]-e.b[k].w[0],e.t[1]-e.b[k].w[1],e.t[2]-e.b[k].w[2]),h=h.d-i.d,i=Math.max(e.oc[e.T],Math.max(e.oc[e.T+4],e.oc[e.T+8])),l=Math.min(e.oc[e.T],Math.min(e.oc[e.T+4],e.oc[e.T+8]));if(0>h*(i+l))for(h=h=0;h<e.cd[k]-1;h++)j[h]&&(j[h].qa=e.qa,j[h].sa=e.b[k].Dc*h);else for(h=e.cd[k]-1;h>=0;h--)j[h]&&(j[h].qa=e.qa,j[h].sa=(e.cd[k]-1)*e.b[k].Dc-e.b[k].Dc*h);j=q}while(g--);f=this.pb.F,g=f.length-1;do e=f[g],!e.L||1==e.qa||e instanceof Le||(j=e,k=e.h.Hd,e=D.f.X(e.ca.N,k[0],k[1],k[2]),e=D.f.X(this.J.n,e.x,e.y,e.d),e=D.m.ff(this.J.cc,e),e=Math.round(1e3*e)/1e3,j.sa=e,j=q);while(g--);j&&this.pb.sort()}if(f=!a&&b!=t&&b&&this.O.STATISTICS_ENABLED)var m=0,n=0,o=0,p=0;var e=this.ze,g=e.get("vertexPosition"),j=e.get("vertexNormal"),k=e.get("vertexColor"),h=e.get("vertexTexturePos"),i=e.get("vertexScalar"),e=this.ld,l=e.get("usePicking"),r=e.get("useObjectColor"),s=e.get("objectColor"),v=e.get("useScalars"),w=e.get("scalarsReplaceMode"),x=e.get("scalarsMin"),y=e.get("scalarsMax"),z=e.get("scalarsMinColor"),A=e.get("scalarsMaxColor"),B=e.get("scalarsInterpolation"),C=e.get("scalarsMinThreshold"),E=e.get("scalarsMaxThreshold"),F=e.get("objectOpacity"),G=e.get("labelmapOpacity"),H=e.get("labelmapColor"),I=e.get("useTexture"),J=e.get("useLabelMapTexture"),K=e.get("textureSampler"),L=e.get("textureSampler2"),M=e.get("volumeLowerThreshold"),N=e.get("volumeUpperThreshold"),O=e.get("volumeScalarMin"),P=e.get("volumeScalarMax"),R=e.get("volumeWindowLow"),S=e.get("volumeWindowHigh"),T=e.get("volumeScalarMinColor"),U=e.get("volumeScalarMaxColor"),V=e.get("volumeTexture"),W=e.get("objectTransform"),X=e.get("pointSize"),e=d;do{var Y=c[d-e];if(Y){var Z=t;if(Y instanceof Le&&Y.zb&&(Z=Y.zb),Y.L&&(!Z||Z.L)&&(!a||Y.$c)){var $=Y.ta,_=Y.Sc,ab=this.fc.get($),bb=this.Zc.get($),cb=this.rc.get($),db=this.Bc.get($),eb=this.ec.get($);this.a.bindBuffer(this.a.ARRAY_BUFFER,ab.M),this.a.vertexAttribPointer(g,ab.Lb,this.a.FLOAT,u,0,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,bb.M),this.a.vertexAttribPointer(j,bb.Lb,this.a.FLOAT,u,0,0),a?this.a.uniform1i(l,q):this.a.uniform1i(l,u),!cb||a||_?(bb=1,_&&!a&&(bb=0),this.a.uniform1i(r,bb),bb=Y.u,a&&(bb=[Math.floor($%65025%255)/255,Math.floor($%65025/255)/255,Math.floor($/65025)/255]),this.a.uniform3f(s,parseFloat(bb[0]),parseFloat(bb[1]),parseFloat(bb[2])),this.a.vertexAttribPointer(k,ab.Lb,this.a.FLOAT,u,0,0)):(this.a.uniform1i(r,u),this.a.bindBuffer(this.a.ARRAY_BUFFER,cb.M),this.a.vertexAttribPointer(k,cb.Lb,this.a.FLOAT,u,0,0)),!db||a||_?(this.a.uniform1i(v,u),this.a.vertexAttribPointer(i,ab.Lb,this.a.FLOAT,u,0,0)):(this.a.uniform1i(v,q),this.a.uniform1i(w,Y.G.jg),$=Y.G.Ob,_=Y.G.Mb,this.a.uniform3f(z,parseFloat($[0]),parseFloat($[1]),parseFloat($[2])),this.a.uniform3f(A,parseFloat(_[0]),parseFloat(_[1]),parseFloat(_[2])),this.a.uniform1f(C,parseFloat(Y.G.fa)),this.a.uniform1f(E,parseFloat(Y.G.ga)),this.a.uniform1f(x,parseFloat(Y.G.cb)),this.a.uniform1f(y,parseFloat(Y.G.ma)),this.a.uniform1i(B,parseInt(Y.G.Be,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,db.M),this.a.vertexAttribPointer(i,db.Lb,this.a.FLOAT,u,0,0)),this.a.uniform1f(F,parseFloat(Y.qa)),Y.C&&eb&&!a?(this.a.uniform1i(I,q),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.Gc.get(Y.C.ta)),this.a.uniform1i(K,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,eb.M),this.a.vertexAttribPointer(h,eb.Lb,this.a.FLOAT,u,0,0),this.a.uniform1i(V,u)):(this.a.uniform1i(I,u),this.a.vertexAttribPointer(h,ab.Lb,this.a.FLOAT,u,0,0)),Z&&(this.a.uniform1i(V,q),this.a.uniform1f(M,Z.fa),this.a.uniform1f(N,Z.ga),this.a.uniform1f(O,Z.cb),this.a.uniform1f(P,Z.ma),$=Z.Ob,_=Z.Mb,this.a.uniform3f(T,parseFloat($[0]),parseFloat($[1]),parseFloat($[2])),this.a.uniform3f(U,parseFloat(_[0]),parseFloat(_[1]),parseFloat(_[2])),this.a.uniform1f(R,Z.ia),this.a.uniform1f(S,Z.ha),db=Z.e,this.a.uniform1i(J,u),Z.Ma?this.a.uniform1f(F,parseFloat(Z.qa)):db&&db.L&&(Z=Y.e.ta,this.a.uniform1i(J,q),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Gc.get(Z)),this.a.uniform1i(L,1),this.a.uniform1f(G,db.qa),this.a.uniform4fv(H,db.Qe))),this.a.uniformMatrix4fv(W,u,Y.ca.N),Z=1,"POINTS"==Y.Da&&(Z=Y.ad),this.a.uniform1f(X,Z),Z=-1,Y.Da==gd?(Z=this.a.TRIANGLES,f&&(n+=ab.Kb/3)):"LINES"==Y.Da?(this.a.lineWidth(Y.zc),Z=this.a.LINES,f&&(o+=ab.Kb/2)):"POINTS"==Y.Da?(Z=this.a.POINTS,f&&(p+=ab.Kb)):"TRIANGLE_STRIPS"==Y.Da?(Z=this.a.TRIANGLE_STRIP,f&&(n+=ab.Kb/3)):"POLYGONS"==Y.Da&&(Z=0==ab.Kb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(n+=ab.Kb/3)),f&&(m+=ab.Kb),this.a.drawArrays(Z,0,ab.Kb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+m+" | "),c+="Triangles: "+Math.round(n)+" | ",c+="Lines: "+o+" | ",c+="Points: "+p+" | ",c+="Textures: "+this.Gc.ee(),window.console.log(c))}},w.remove=function(a){if(ah.z.remove.call(this,a),0<a.c.length)for(var b=a.c,c=b.length,d=0,d=0;c>d;d++)this.remove(b[d]);return b=a.ta,c=this.ec.get(b),c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M),a.C&&(c=this.Gc.get(a.C.ta))&&(this.a.deleteTexture(c),this.Gc.remove(a.C.ta)),c=this.fc.get(b),c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M),c=this.Zc.get(b),c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M),c=this.rc.get(b),c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M),c=this.Bc.get(b),c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M),this.fc.remove(b),this.Zc.remove(b),this.rc.remove(b),this.ec.remove(b),this.Bc.remove(b),this.pb.remove(a),q},w.$d=function(){this.Pe=t,delete this.Pe,this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),ah.z.$d.call(this)},ah.prototype.__defineGetter__("bgColor",v("Nc")),ah.prototype.__defineSetter__("bgColor",fa("Nc")),ah.prototype.oj=function(a,b,c,d,e){if(c!=t||(c=4),d!=t||(d=2),e==t){if(e=this.Bf(a,b),-1==e)return t;if(e=this.get(e),!e)return t}var f=jg(this.J,2*(a/this.H)-1,2*((this.v-b)/this.v)-1,0);a=jg(this.J,2*(a/this.H)-1,2*((this.v-b)/this.v)-1,1),f[0]+=this.A[0],f[1]+=this.A[1],f[2]+=this.A[2],a[0]+=this.A[0],a[1]+=this.A[1],a[2]+=this.A[2],b=[e.h.eb,e.h.fb,e.h.gb];var g=[e.h.$a,e.h.fb,e.h.gb],h=[e.h.$a,e.h.ab,e.h.gb],i=[e.h.eb,e.h.ab,e.h.gb],j=[e.h.eb,e.h.ab,e.h.bb],k=[e.h.eb,e.h.fb,e.h.bb],l=[e.h.$a,e.h.ab,e.h.bb],m=[e.h.$a,e.h.fb,e.h.bb];b=[D.f.X(e.ca.N,b[0],b[1],b[2]),D.f.X(e.ca.N,g[0],g[1],g[2]),D.f.X(e.ca.N,h[0],h[1],h[2]),D.f.X(e.ca.N,i[0],i[1],i[2]),D.f.X(e.ca.N,j[0],j[1],j[2]),D.f.X(e.ca.N,k[0],k[1],k[2]),D.f.X(e.ca.N,l[0],l[1],l[2]),D.f.X(e.ca.N,m[0],m[1],m[2])];var n,g=[1/0,-1/0,1/0,-1/0,1/0,-1/0];for(n in b)n=b[n],g=[Math.min(g[0],n.x),Math.max(g[1],n.x),Math.min(g[2],n.y),Math.max(g[3],n.y),Math.min(g[4],n.d),Math.max(g[5],n.d)];for(n=g,b=[],g=[],h=0;6>h;h++){var i=Math.floor(h/2),j=(i+1)%3,k=(i+2)%3,m=(2+2*i)%6,o=(4+2*i)%6,p=(n[h]-f[i])*(1/a[i]);1/0!=p&&-1/0!=p&&(l=f[j]+a[j]*p,p=f[k]+a[k]*p,l>=n[m]&&l<=n[m+1]&&p>=n[o]&&p<=n[o+1]?(m=[],m[i]=n[h],m[j]=l,m[k]=p,b.push(m)):(m=[],m[i]=n[h],m[j]=l,m[k]=p,g.push(m)))}if(a=[b,g],a=a[0],0==a.length)return t;for(g=Array(2),n=0;2>n;n++)b=a[n],g[n]=Math.sqrt((b[0]-f[0])*(b[0]-f[0])+(b[1]-f[1])*(b[1]-f[1])+(b[2]-f[2])*(b[2]-f[2]));for(f=b=n=t,g[0]<g[1]?(n=a[0],b=a[1]):(n=a[1],b=a[0]),f=Math.sqrt((n[0]-b[0])*(n[0]-b[0])+(n[1]-b[1])*(n[1]-b[1])+(n[2]-b[2])*(n[2]-b[2])),f/=c,a=n,n=[b[0]-n[0],b[1]-n[1],b[2]-n[2]],b=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),g=[n[0]/b,n[1]/b,n[2]/b],h=e.h.Y,i=h.length,n=0;f>n;n+=c)for(a=[a[0]+c*g[0],a[1]+c*g[1],a[2]+c*g[2]],b=0;i>b;b+=3)if(j=h[b],k=h[b+1],l=h[b+2],m=new D.m(j,k,l),m=D.f.X(e.ca.N,j,k,l),Math.sqrt((a[0]-m.x)*(a[0]-m.x)+(a[1]-m.y)*(a[1]-m.y)+(a[2]-m.d)*(a[2]-m.d))<=d)return[m.x,m.y,m.d];return t},B("X.renderer3D",ah),B("X.renderer3D.prototype.init",ah.prototype.wa),B("X.renderer3D.prototype.add",ah.prototype.add),B("X.renderer3D.prototype.onShowtime",ah.prototype.Xg),B("X.renderer3D.prototype.onRender",ah.prototype.Vg),B("X.renderer3D.prototype.get",ah.prototype.get),B("X.renderer3D.prototype.render",ah.prototype.Zb),B("X.renderer3D.prototype.destroy",ah.prototype.$d),B("X.renderer3D.prototype.remove",ah.prototype.remove),B("X.renderer3D.prototype.resetBoundingBox",ah.prototype.sj),B("X.renderer3D.prototype.resetViewAndRender",ah.prototype.Ad),B("X.renderer3D.prototype.pick",ah.prototype.Bf),B("X.renderer3D.prototype.pick3d",ah.prototype.oj),C(bh,Y),B("X.fibers",bh),C(ch,zg),ch.prototype.$i=ea(),ch.prototype.jj=ea(),ch.prototype.yf=function(a){ch.z.yf.call(this,a);var b=this.hb[0];if(b){var c="",c=0==this.Ba?"indexX":1==this.Ba?"indexY":"indexZ";b[c]=a.Z?b[c]+1:b[c]-1,eval("this.onScroll();")}},ch.prototype.kj=function(a){var b=this.hb[0];if(b){var c=b.ha-b.ia,e=c/2,d=parseInt(c+c/15*-a.Te,10);a=parseInt(e+e/15*a.Ge,10),c==d&&d++,e==a&&a++,b.ia-=parseInt(e-a,10),b.ia-=parseInt(c-d,10),b.ia=Math.max(b.ia,b.cb),b.ha-=parseInt(e-a,10),b.ha+=parseInt(c-d,10),b.ha=Math.min(b.ha,b.ma),eval("this.onWindowLevel();")}},ch.prototype.__defineGetter__("orientation",v("La")),ch.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase(),"AXIAL"==a?(a="Z",this.Ba=2):"SAGITTAL"==a?(a="X",this.Ba=0):"CORONAL"==a&&(a="Y",this.Ba=1),"X"!=a&&"Y"!=a&&"Z"!=a&&m(Error("Invalid orientation.")),this.La=a}),ch.prototype.__defineGetter__("radiological",v("hg")),ch.prototype.__defineSetter__("radiological",fa("hg")),w=ch.prototype,w.wa=function(){this.La||m(Error("No 2D orientation set.")),ch.z.wa.call(this,"2d"),this.a.fillStyle="rgba(50,50,50,0)",this.a.fillRect(0,0,this.za.width,this.za.height),this.Ld=be("canvas"),this.Nd=be("canvas"),L(this.J,vd,this.kj.bind(this))},w.xf=function(){ch.z.xf.call(this),dh(this)},w.Ad=function(){ch.z.Ad.call(this),dh(this);var a=this.hb[0];a&&(a.ha=a.ma,a.ia=a.cb)},w.sb=function(a){ch.z.sb.call(this,a);var b=u;if(this.get(a.ta)&&(b=q),a instanceof Q){var c=a.r,d=a.e,e=a.Aa;if(d!=t&&d.r!=t&&d.r.j)this.sb(d);else if(e!=t&&e.r!=t&&e.r.j)this.W.load(e,a);else{if(c!=t&&la(c)){if(a.nc==t){for(b=0,d=c.length,b=0;d>b;b++)this.W.load(c[b],a);return}if(a.nc.lf!=c.length||b&&!a.j)return}else if(c!=t&&c.j)return this.W.load(a,a),void 0;this.Ba="X"==this.La?0:"Y"==this.La?1:2,this.Wa=a.c[this.Ba].c,e=t,e=0==this.Ba?a.indexX:1==this.Ba?a.indexY:a.indexZ,c=a.c[this.Ba].c[e].Zf,d=a.c[this.Ba].c[e].Yf,this.Ec=a.c[this.Ba].c[e].Hc,this.Cc=a.c[this.Ba].c[e].uc,this.fd=c,this.dd=d,e=this.Ld,e.width=c,e.height=d;var f=this.Nd;f.width=c,f.height=d,this.Vf=e.getContext("2d"),this.$f=f.getContext("2d"),b||(this.pb.add(a),dh(this))}}},w.aj=ea(),w.sh=function(a,b){var c=this.hb[0],d=this.J.n,e=t,f=this.fd,g=this.dd,h=t,i=t;if("Y"==this.La)e=this.Wa[parseInt(c.indexY,10)],h=e.Hc,i=e.uc,this.Pb[0]="red",this.Pb[1]="blue";else if("Z"==this.La)e=this.Wa[parseInt(c.indexZ,10)],h=e.Hc,i=e.uc,this.Pb[0]="red",this.Pb[1]="green";else{e=this.Wa[parseInt(c.indexX,10)],h=e.uc,i=e.Hc,this.Pb[0]="green",this.Pb[1]="blue";var j=f,f=g,g=j}var k=1*d[12],l=-1*d[13],j=Math.max(d[14],.6),d=[this.H/2,this.v/2],h=f*h*j,i=g*i*j,m=d[0]-h/2,d=d[1]-i/2,m=m+k*j,d=d+l*j;return a>m&&m+h>a&&b>d&&d+i>b?(k=(a-m)/h*f,l=(b-d)/i*g,i=e.Nh[4],"X"==this.La?(j=f-k,k=l,l=j):"Y"==this.La?k=f-k:"Z"==this.La&&(k=f-k,l=g-l),k=e.Mh+k*e.Hc,l=e.Gh+l*e.uc,k=Pc(k,l,i,1),f=Qc(),ad(e.zh,k,f),g=Qc(),ad(e.Ah,k,g),e=Math.round((c.b[0].i[0]*g[0]+c.b[0].i[1]*g[1]+c.b[0].i[2]*g[2]+c.b[0].Je)/c.b[0].Dc),e>=c.b[0].o?e=c.b[0].o-1:0>e&&(e=0),k=Math.round((c.b[1].i[0]*g[0]+c.b[1].i[1]*g[1]+c.b[1].i[2]*g[2]+c.b[1].Je)/c.b[1].Dc),k>=c.b[1].o?k=c.b[1].o-1:0>k&&(k=0),l=Math.round((c.b[2].i[0]*g[0]+c.b[2].i[1]*g[1]+c.b[2].i[2]*g[2]+c.b[2].Je)/c.b[2].Dc),l>=c.b[2].o?l=c.b[2].o-1:0>l&&(l=0),[[e,k,l],[f[0],f[1],f[2]],[g[0],g[1],g[2]]]):t},w.$b=function(a,b){if(ch.z.$b.call(this,a,b),0!=this.pb.F.length){var c=this.hb[0],d=t,d=0==this.Ba?c.indexX:1==this.Ba?c.indexY:c.indexZ,e=this.Wa[parseInt(d,10)].Zf,f=this.Wa[parseInt(d,10)].Yf;this.Ec=this.Wa[parseInt(d,10)].Hc,this.Cc=this.Wa[parseInt(d,10)].uc,this.fd=e,this.dd=f;var g=this.H,h=this.v,i=this.J.n;this.a.save(),this.a.clearRect(-g,-h,2*g,2*h),this.a.restore();var j=Math.max(i[14],.1);this.a.setTransform(j,0,0,j,0,0);var k=1*i[12],i=-1*i[13],l=t;c.e&&(l=c.e.Qe);var m=this.Wa[parseInt(d,10)],n=m.C.Tb,m=m.e,o=t;m&&(o=m.Tb);var p=this.fd,q=this.dd,r=this.Vf,s=this.$f,v=r.getImageData(0,0,p,q),w=s.getImageData(0,0,p,q),x=v.data,y=w.data,z=x.length,A=c.ma,B=c.fa,C=c.ga,D=c.ia/A,E=c.ha/A;if(this.Sf!=d||this.fa!=B||this.ga!=C||this.ia!=D||this.ha!=E||l&&!fg(l,this.ag,0)){var F=this.Ld;F.width=e,F.height=f,F=this.Nd,F.width=e,F.height=f,e=0;do{var F=[0,0,0,0],f=[0,0,0,0],G=n[e]/255*A,H=n[e],H=(H/255-D)/(E-D),H=255*H;G>=B&&C>=G&&(F=new U(c.Ob[0],c.Ob[1],c.Ob[2]),F=new U(c.Mb[0],c.Mb[1],c.Mb[2]).scale(H).add(F.scale(255-H)),F=[Math.floor(F.x),Math.floor(F.y),Math.floor(F.d),255],m&&(-255==l[3]?f=[o[e],o[e+1],o[e+2],o[e+3]]:fg(l,o,e)&&(f=[o[e],o[e+1],o[e+2],o[e+3]]))),"X"==this.La?(x[e]=F[0],x[e+1]=F[1],x[e+2]=F[2],x[e+3]=F[3],y[e]=f[0],y[e+1]=f[1],y[e+2]=f[2],y[e+3]=f[3]):"Y"==this.La?(H=Math.floor(e/(4*p)),H=4*H*p+(4*(p-1)-(e-4*H*p)),x[H]=F[0],x[H+1]=F[1],x[H+2]=F[2],x[H+3]=F[3],y[H]=f[0],y[H+1]=f[1],y[H+2]=f[2],y[H+3]=f[3]):(H=z-1-e,x[H-3]=F[0],x[H-2]=F[1],x[H-1]=F[2],x[H]=F[3],y[H-3]=f[0],y[H-2]=f[1],y[H-1]=f[2],y[H]=f[3]),e+=4}while(z>e);r.putImageData(v,0,0),s.putImageData(w,0,0),this.Sf=d,this.fa=B,this.ga=C,this.ia=D,this.ha=E,m&&(this.ag=l)}this.a.globalAlpha=1,this.a.translate(g/2/j,h/2/j),"X"==this.La&&(this.a.rotate(.5*Math.PI),d=k,k=i,i=-d),k=-p*this.Ec/2+k,i=-q*this.Cc/2+i,this.a.drawImage(this.Ld,k,i,p*this.Ec,q*this.Cc),m&&c.e.L&&(this.a.globalAlpha=c.e.qa,this.a.drawImage(this.Nd,k,i,p*this.Ec,q*this.Cc)),this.O.SLICENAVIGATORS&&this.S.Qd&&this.S.lg&&!this.S.ob&&(k=this.S.pa,k=this.sh(k[0],k[1]))&&(c.vb=k[0][0],c.wb=k[0][1],c.xb=k[0][2],c.p(u),this.onSliceNavigation(),this.a.setTransform(1,0,0,1,0,0),this.a.lineWidth=1,this.a.beginPath(),this.a.moveTo(this.S.pa[0],0),this.a.lineTo(this.S.pa[0],this.S.pa[1]-10),this.a.moveTo(this.S.pa[0],this.S.pa[1]+10),this.a.lineTo(this.S.pa[0],this.v),this.a.strokeStyle=this.Pb[0],this.a.stroke(),this.a.closePath(),this.a.beginPath(),this.a.moveTo(0,this.S.pa[1]),this.a.lineTo(this.S.pa[0]-10,this.S.pa[1]),this.a.moveTo(this.S.pa[0]+10,this.S.pa[1]+.5),this.a.lineTo(this.H,this.S.pa[1]),this.a.strokeStyle=this.Pb[1],this.a.stroke(),this.a.closePath(),this.a.font="10pt Arial",this.a.textAlign="left",this.a.textBaseline="top",this.a.fillStyle="white",this.a.fillText("RAS: "+k[2][0].toFixed(2)+", "+k[2][1].toFixed(2)+", "+k[2][2].toFixed(2),0,0),p=m=i="undefined","undefined"!=typeof c.ba[k[1][2].toFixed(0)]&&"undefined"!=typeof c.ba[k[1][2].toFixed(0)][k[1][1].toFixed(0)]&&(i=c.ba[k[1][2].toFixed(0)][k[1][1].toFixed(0)][k[1][0].toFixed(0)],c.I&&(m=c.e.ba[k[1][2].toFixed(0)][k[1][1].toFixed(0)][k[1][0].toFixed(0)],c.e.Oc&&(p=c.e.Oc.get(m),"undefined"!=typeof p&&(p=p[0])))),this.a.fillText("Background:  "+i+" ("+k[1][0].toFixed(0)+", "+k[1][1].toFixed(0)+", "+k[1][2].toFixed(0)+")",0,15),c.I&&this.a.fillText("Labelmap:  "+p+" ("+m+")",0,30))}},B("X.renderer2D",ch),B("X.renderer2D.prototype.init",ch.prototype.wa),B("X.renderer2D.prototype.add",ch.prototype.add),B("X.renderer2D.prototype.onShowtime",ch.prototype.Xg),B("X.renderer2D.prototype.onRender",ch.prototype.Vg),B("X.renderer2D.prototype.onScroll",ch.prototype.$i),B("X.renderer2D.prototype.onWindowLevel",ch.prototype.jj),B("X.renderer2D.prototype.get",ch.prototype.get),B("X.renderer2D.prototype.resetViewAndRender",ch.prototype.Ad),B("X.renderer2D.prototype.xy2ijk",ch.prototype.sh),B("X.renderer2D.prototype.render",ch.prototype.Zb),B("X.renderer2D.prototype.destroy",ch.prototype.$d),B("X.renderer2D.prototype.onSliceNavigation",ch.prototype.aj),C(kh,Y),B("X.mesh",kh);