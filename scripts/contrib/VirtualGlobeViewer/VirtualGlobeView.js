define(["backbone.marionette","app","communicator","./GlobeRenderer/Globe"],function(a,b,c,d){"use strict";var e=a.View.extend({tagName:"canvas",className:"globe",initialize:function(a){this.isClosed=!0,this.startPosition=a.startPosition,"undefined"==typeof this.startPosition&&(this.startPosition={geoCenter:[15,47],distance:0,duration:3e3,tilt:40}),this.initialLayers={},$(window).resize(function(){this.globe&&this.onResize()}.bind(this))},addInitialLayer:function(a,b){this.initialLayers[a.get("name")]={model:a,isBaseLayer:b}},addAreaOfInterest:function(a){this.globe.addAreaOfInterest(a)},addLayer:function(a,b){this.globe.addLayer(a,b)},removeLayer:function(a,b){this.globe.removeLayer(a,b)},removeAllOverlays:function(){this.globe.removeAllOverlays()},onLayerChange:function(a,b,c){c?(this.addLayer(a,b),console.log("[GlobeView::onLayerChange] selected "+a.get("name"))):(this.removeLayer(a,b),console.log("[GlobeView::onLayerChange] deselected "+a.get("name")))},onOpacityChange:function(a,b){this.globe.onOpacityChange(a,b)},onTimeChange:function(a){this.globe.setTimeSpanOnLayers(a)},sortOverlayLayers:function(){this.globe.sortOverlayLayers()},initLayers:function(){this.globe.clearCache(),_.each(this.initialLayers,function(a){this.globe.addLayer(a.model,a.isBaseLayer)}.bind(this)),this.sortOverlayLayers()},createGlobe:function(){this.globe=new d({canvas:this.el}),this.initialLayerSetupDone||(this.initLayers(),this.sortOverlayLayers(),this.initialLayerSetupDone=!0)},onResize:function(){this.globe.updateViewport()},onShow:function(){this.globe||this.createGlobe(),this.isClosed=!1,this.onResize(),this.zoomTo(this.startPosition)},zoomTo:function(a){this.globe&&this.globe.zoomTo(a)},onClose:function(){this.isClosed=!0},dumpLayerConfig:function(){this.globe.dumpLayerConfig()}});return e});